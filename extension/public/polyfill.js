// ==UserScript==
// @name         Gmail MCP-B Injector
// @namespace    https://github.com/miguelspizza/mcp-b-user-scripts
// @version      1.0.0
// @author       Alex Nahas
// @description  Injects MCP-B server into Gmail for AI assistant integration
// @license      MIT
// @homepage     https://github.com/MiguelsPizza/WebMCP#readme
// @homepageURL  https://github.com/miguelspizza/mcp-b-user-scripts
// @source       https://github.com/MiguelsPizza/WebMCP.git
// @supportURL   https://github.com/miguelspizza/mcp-b-user-scripts/issues
// @match        https://mail.google.com/*
// ==/UserScript==

(function () {
	'use strict';

	(function(){var pe;(function(s){s.assertEqual=r=>{};function e(r){}s.assertIs=e;function t(r){throw new Error}s.assertNever=t,s.arrayToEnum=r=>{const n={};for(const o of r)n[o]=o;return n},s.getValidEnumValues=r=>{const n=s.objectKeys(r).filter(i=>typeof r[r[i]]!="number"),o={};for(const i of n)o[i]=r[i];return s.objectValues(o)},s.objectValues=r=>s.objectKeys(r).map(function(n){return r[n]}),s.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const n=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&n.push(o);return n},s.find=(r,n)=>{for(const o of r)if(n(o))return o},s.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function a(r,n=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(n)}s.joinValues=a,s.jsonStringifyReplacer=(r,n)=>typeof n=="bigint"?n.toString():n;})(pe||(pe={}));var Qa;(function(s){s.mergeShapes=(e,t)=>({...e,...t});})(Qa||(Qa={}));const J=pe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),br=s=>{switch(typeof s){case "undefined":return J.undefined;case "string":return J.string;case "number":return Number.isNaN(s)?J.nan:J.number;case "boolean":return J.boolean;case "function":return J.function;case "bigint":return J.bigint;case "symbol":return J.symbol;case "object":return Array.isArray(s)?J.array:s===null?J.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?J.promise:typeof Map<"u"&&s instanceof Map?J.map:typeof Set<"u"&&s instanceof Set?J.set:typeof Date<"u"&&s instanceof Date?J.date:J.object;default:return J.unknown}},Z=pe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class vr extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a];},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a];};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e;}format(e){const t=e||function(n){return n.message},a={_errors:[]},r=n=>{for(const o of n.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)a._errors.push(t(o));else {let i=a,l=0;for(;l<o.path.length;){const d=o.path[l];l===o.path.length-1?(i[d]=i[d]||{_errors:[]},i[d]._errors.push(t(o))):i[d]=i[d]||{_errors:[]},i=i[d],l++;}}};return r(this),a}static assert(e){if(!(e instanceof vr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,pe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},a=[];for(const r of this.issues)if(r.path.length>0){const n=r.path[0];t[n]=t[n]||[],t[n].push(e(r));}else a.push(e(r));return {formErrors:a,fieldErrors:t}}get formErrors(){return this.flatten()}}vr.create=s=>new vr(s);const yt=(s,e)=>{let t;switch(s.code){case Z.invalid_type:s.received===J.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case Z.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,pe.jsonStringifyReplacer)}`;break;case Z.unrecognized_keys:t=`Unrecognized key(s) in object: ${pe.joinValues(s.keys,", ")}`;break;case Z.invalid_union:t="Invalid input";break;case Z.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${pe.joinValues(s.options)}`;break;case Z.invalid_enum_value:t=`Invalid enum value. Expected ${pe.joinValues(s.options)}, received '${s.received}'`;break;case Z.invalid_arguments:t="Invalid function arguments";break;case Z.invalid_return_type:t="Invalid function return type";break;case Z.invalid_date:t="Invalid date";break;case Z.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:pe.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case Z.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="bigint"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case Z.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case Z.custom:t="Invalid input";break;case Z.invalid_intersection_types:t="Intersection results could not be merged";break;case Z.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case Z.not_finite:t="Number must be finite";break;default:t=e.defaultError,pe.assertNever(s);}return {message:t}};let hi=yt;function fi(){return hi}const mi=s=>{const{data:e,path:t,errorMaps:a,issueData:r}=s,n=[...t,...r.path||[]],o={...r,path:n};if(r.message!==void 0)return {...r,path:n,message:r.message};let i="";const l=a.filter(d=>!!d).slice().reverse();for(const d of l)i=d(o,{data:e,defaultError:i}).message;return {...r,path:n,message:i}};function B(s,e){const t=fi(),a=mi({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===yt?void 0:yt].filter(r=>!!r)});s.common.issues.push(a);}class Ze{constructor(){this.value="valid";}dirty(){this.value==="valid"&&(this.value="dirty");}abort(){this.value!=="aborted"&&(this.value="aborted");}static mergeArray(e,t){const a=[];for(const r of t){if(r.status==="aborted")return ee;r.status==="dirty"&&e.dirty(),a.push(r.value);}return {status:e.value,value:a}}static async mergeObjectAsync(e,t){const a=[];for(const r of t){const n=await r.key,o=await r.value;a.push({key:n,value:o});}return Ze.mergeObjectSync(e,a)}static mergeObjectSync(e,t){const a={};for(const r of t){const{key:n,value:o}=r;if(n.status==="aborted"||o.status==="aborted")return ee;n.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),n.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(a[n.value]=o.value);}return {status:e.value,value:a}}}const ee=Object.freeze({status:"aborted"}),jr=s=>({status:"dirty",value:s}),Ke=s=>({status:"valid",value:s}),Ja=s=>s.status==="aborted",Ka=s=>s.status==="dirty",kr=s=>s.status==="valid",Jr=s=>typeof Promise<"u"&&s instanceof Promise;var K;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e?.message;})(K||(K={}));class nr{constructor(e,t,a,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=a,this._key=r;}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ga=(s,e)=>{if(kr(e))return {success:true,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return {success:false,get error(){if(this._error)return this._error;const t=new vr(s.common.issues);return this._error=t,this._error}}};function ie(s){if(!s)return {};const{errorMap:e,invalid_type_error:t,required_error:a,description:r}=s;if(e&&(t||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,i)=>{const{message:l}=s;return o.code==="invalid_enum_value"?{message:l??i.defaultError}:typeof i.data>"u"?{message:l??a??i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:l??t??i.defaultError}},description:r}}class ce{get description(){return this._def.description}_getType(e){return br(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:br(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return {status:new Ze,ctx:{common:e.parent.common,data:e.data,parsedType:br(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Jr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const a=this.safeParse(e,t);if(a.success)return a.data;throw a.error}safeParse(e,t){const a={common:{issues:[],async:t?.async??false,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:br(e)},r=this._parseSync({data:e,path:a.path,parent:a});return Ga(a,r)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:br(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:t});return kr(a)?{value:a.value}:{issues:t.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=true),t.common={issues:[],async:true};}return this._parseAsync({data:e,path:[],parent:t}).then(a=>kr(a)?{value:a.value}:{issues:t.common.issues})}async parseAsync(e,t){const a=await this.safeParseAsync(e,t);if(a.success)return a.data;throw a.error}async safeParseAsync(e,t){const a={common:{issues:[],contextualErrorMap:t?.errorMap,async:true},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:br(e)},r=this._parse({data:e,path:a.path,parent:a}),n=await(Jr(r)?r:Promise.resolve(r));return Ga(a,n)}refine(e,t){const a=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,n)=>{const o=e(r),i=()=>n.addIssue({code:Z.custom,...a(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?true:(i(),false)):o?true:(i(),false)})}refinement(e,t){return this._refinement((a,r)=>e(a)?true:(r.addIssue(typeof t=="function"?t(a,r):t),false))}_refinement(e){return new xr({schema:this,typeName:U.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)};}optional(){return or.create(this,this._def)}nullable(){return $r.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ir.create(this)}promise(){return et.create(this,this._def)}or(e){return Gr.create([this,e],this._def)}and(e){return Wr.create(this,e,this._def)}transform(e){return new xr({...ie(this._def),schema:this,typeName:U.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new rt({...ie(this._def),innerType:this,defaultValue:t,typeName:U.ZodDefault})}brand(){return new ns({typeName:U.ZodBranded,type:this,...ie(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new tt({...ie(this._def),innerType:this,catchValue:t,typeName:U.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Ot.create(this,e)}readonly(){return at.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const pi=/^c[^\s-]{8,}$/i,vi=/^[0-9a-z]+$/,gi=/^[0-9A-HJKMNP-TV-Z]{26}$/i,yi=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,_i=/^[a-z0-9_-]{21}$/i,Pi=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,bi=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Si=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ei="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let _t;const wi=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ri=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,xi=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,$i=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Oi=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ti=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Wa="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ki=new RegExp(`^${Wa}$`);function Ya(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);const t=s.precision?"+":"?";return `([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function Ci(s){return new RegExp(`^${Ya(s)}$`)}function Ii(s){let e=`${Wa}T${Ya(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Ai(s,e){return !!((e==="v4"||!e)&&wi.test(s)||(e==="v6"||!e)&&xi.test(s))}function Di(s,e){if(!Pi.test(s))return  false;try{const[t]=s.split(".");if(!t)return !1;const a=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(a));return !(typeof r!="object"||r===null||"typ"in r&&r?.typ!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return  false}}function Ni(s,e){return !!((e==="v4"||!e)&&Ri.test(s)||(e==="v6"||!e)&&$i.test(s))}class gr extends ce{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==J.string){const n=this._getOrReturnCtx(e);return B(n,{code:Z.invalid_type,expected:J.string,received:n.parsedType}),ee}const a=new Ze;let r;for(const n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_small,minimum:n.value,type:"string",inclusive:true,exact:false,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_big,maximum:n.value,type:"string",inclusive:true,exact:false,message:n.message}),a.dirty());else if(n.kind==="length"){const o=e.data.length>n.value,i=e.data.length<n.value;(o||i)&&(r=this._getOrReturnCtx(e,r),o?B(r,{code:Z.too_big,maximum:n.value,type:"string",inclusive:true,exact:true,message:n.message}):i&&B(r,{code:Z.too_small,minimum:n.value,type:"string",inclusive:true,exact:true,message:n.message}),a.dirty());}else if(n.kind==="email")Si.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"email",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")_t||(_t=new RegExp(Ei,"u")),_t.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"emoji",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")yi.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"uuid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")_i.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"nanoid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")pi.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"cuid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")vi.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"cuid2",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")gi.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"ulid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data);}catch{r=this._getOrReturnCtx(e,r),B(r,{validation:"url",code:Z.invalid_string,message:n.message}),a.dirty();}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"regex",code:Z.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?Ii(n).test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?ki.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?Ci(n).test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{code:Z.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?bi.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"duration",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?Ai(e.data,n.version)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"ip",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="jwt"?Di(e.data,n.alg)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"jwt",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="cidr"?Ni(e.data,n.version)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"cidr",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?Oi.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"base64",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="base64url"?Ti.test(e.data)||(r=this._getOrReturnCtx(e,r),B(r,{validation:"base64url",code:Z.invalid_string,message:n.message}),a.dirty()):pe.assertNever(n);return {status:a.value,value:e.data}}_regex(e,t,a){return this.refinement(r=>e.test(r),{validation:t,code:Z.invalid_string,...K.errToObj(a)})}_addCheck(e){return new gr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...K.errToObj(e)})}url(e){return this._addCheck({kind:"url",...K.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...K.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...K.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...K.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...K.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...K.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...K.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...K.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...K.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...K.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...K.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...K.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:false,local:false,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??false,local:e?.local??false,...K.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...K.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...K.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...K.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...K.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...K.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...K.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...K.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...K.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...K.errToObj(t)})}nonempty(e){return this.min(1,K.errToObj(e))}trim(){return new gr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new gr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new gr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return !!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return !!this._def.checks.find(e=>e.kind==="date")}get isTime(){return !!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return !!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return !!this._def.checks.find(e=>e.kind==="email")}get isURL(){return !!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return !!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return !!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return !!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return !!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return !!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return !!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return !!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return !!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return !!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return !!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}gr.create=s=>new gr({checks:[],typeName:U.ZodString,coerce:s?.coerce??false,...ie(s)});function ji(s,e){const t=(s.toString().split(".")[1]||"").length,a=(e.toString().split(".")[1]||"").length,r=t>a?t:a,n=Number.parseInt(s.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return n%o/10**r}class Cr extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf;}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==J.number){const n=this._getOrReturnCtx(e);return B(n,{code:Z.invalid_type,expected:J.number,received:n.parsedType}),ee}let a;const r=new Ze;for(const n of this._def.checks)n.kind==="int"?pe.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:false,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:false,message:n.message}),r.dirty()):n.kind==="multipleOf"?ji(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),B(a,{code:Z.not_finite,message:n.message}),r.dirty()):pe.assertNever(n);return {status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,true,K.toString(t))}gt(e,t){return this.setLimit("min",e,false,K.toString(t))}lte(e,t){return this.setLimit("max",e,true,K.toString(t))}lt(e,t){return this.setLimit("max",e,false,K.toString(t))}setLimit(e,t,a,r){return new Cr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:K.toString(r)}]})}_addCheck(e){return new Cr({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:K.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:false,message:K.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:false,message:K.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:true,message:K.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:true,message:K.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:K.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:K.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:true,value:Number.MIN_SAFE_INTEGER,message:K.toString(e)})._addCheck({kind:"max",inclusive:true,value:Number.MAX_SAFE_INTEGER,message:K.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return !!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&pe.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return  true;a.kind==="min"?(t===null||a.value>t)&&(t=a.value):a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);}return Number.isFinite(t)&&Number.isFinite(e)}}Cr.create=s=>new Cr({checks:[],typeName:U.ZodNumber,coerce:s?.coerce||false,...ie(s)});class Fr extends ce{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte;}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data);}catch{return this._getInvalidInput(e)}if(this._getType(e)!==J.bigint)return this._getInvalidInput(e);let a;const r=new Ze;for(const n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),B(a,{code:Z.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):pe.assertNever(n);return {status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return B(t,{code:Z.invalid_type,expected:J.bigint,received:t.parsedType}),ee}gte(e,t){return this.setLimit("min",e,true,K.toString(t))}gt(e,t){return this.setLimit("min",e,false,K.toString(t))}lte(e,t){return this.setLimit("max",e,true,K.toString(t))}lt(e,t){return this.setLimit("max",e,false,K.toString(t))}setLimit(e,t,a,r){return new Fr({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:a,message:K.toString(r)}]})}_addCheck(e){return new Fr({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:false,message:K.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:false,message:K.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:true,message:K.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:true,message:K.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:K.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Fr.create=s=>new Fr({checks:[],typeName:U.ZodBigInt,coerce:s?.coerce??false,...ie(s)});class Pt extends ce{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==J.boolean){const a=this._getOrReturnCtx(e);return B(a,{code:Z.invalid_type,expected:J.boolean,received:a.parsedType}),ee}return Ke(e.data)}}Pt.create=s=>new Pt({typeName:U.ZodBoolean,coerce:s?.coerce||false,...ie(s)});class Kr extends ce{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==J.date){const n=this._getOrReturnCtx(e);return B(n,{code:Z.invalid_type,expected:J.date,received:n.parsedType}),ee}if(Number.isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return B(n,{code:Z.invalid_date}),ee}const a=new Ze;let r;for(const n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_small,message:n.message,inclusive:true,exact:false,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),B(r,{code:Z.too_big,message:n.message,inclusive:true,exact:false,maximum:n.value,type:"date"}),a.dirty()):pe.assertNever(n);return {status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Kr({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:K.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:K.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Kr.create=s=>new Kr({checks:[],coerce:s?.coerce||false,typeName:U.ZodDate,...ie(s)});class Xa extends ce{_parse(e){if(this._getType(e)!==J.symbol){const a=this._getOrReturnCtx(e);return B(a,{code:Z.invalid_type,expected:J.symbol,received:a.parsedType}),ee}return Ke(e.data)}}Xa.create=s=>new Xa({typeName:U.ZodSymbol,...ie(s)});class bt extends ce{_parse(e){if(this._getType(e)!==J.undefined){const a=this._getOrReturnCtx(e);return B(a,{code:Z.invalid_type,expected:J.undefined,received:a.parsedType}),ee}return Ke(e.data)}}bt.create=s=>new bt({typeName:U.ZodUndefined,...ie(s)});class St extends ce{_parse(e){if(this._getType(e)!==J.null){const a=this._getOrReturnCtx(e);return B(a,{code:Z.invalid_type,expected:J.null,received:a.parsedType}),ee}return Ke(e.data)}}St.create=s=>new St({typeName:U.ZodNull,...ie(s)});class es extends ce{constructor(){super(...arguments),this._any=true;}_parse(e){return Ke(e.data)}}es.create=s=>new es({typeName:U.ZodAny,...ie(s)});class Et extends ce{constructor(){super(...arguments),this._unknown=true;}_parse(e){return Ke(e.data)}}Et.create=s=>new Et({typeName:U.ZodUnknown,...ie(s)});class Sr extends ce{_parse(e){const t=this._getOrReturnCtx(e);return B(t,{code:Z.invalid_type,expected:J.never,received:t.parsedType}),ee}}Sr.create=s=>new Sr({typeName:U.ZodNever,...ie(s)});class rs extends ce{_parse(e){if(this._getType(e)!==J.undefined){const a=this._getOrReturnCtx(e);return B(a,{code:Z.invalid_type,expected:J.void,received:a.parsedType}),ee}return Ke(e.data)}}rs.create=s=>new rs({typeName:U.ZodVoid,...ie(s)});class ir extends ce{_parse(e){const{ctx:t,status:a}=this._processInputParams(e),r=this._def;if(t.parsedType!==J.array)return B(t,{code:Z.invalid_type,expected:J.array,received:t.parsedType}),ee;if(r.exactLength!==null){const o=t.data.length>r.exactLength.value,i=t.data.length<r.exactLength.value;(o||i)&&(B(t,{code:o?Z.too_big:Z.too_small,minimum:i?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:true,exact:true,message:r.exactLength.message}),a.dirty());}if(r.minLength!==null&&t.data.length<r.minLength.value&&(B(t,{code:Z.too_small,minimum:r.minLength.value,type:"array",inclusive:true,exact:false,message:r.minLength.message}),a.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(B(t,{code:Z.too_big,maximum:r.maxLength.value,type:"array",inclusive:true,exact:false,message:r.maxLength.message}),a.dirty()),t.common.async)return Promise.all([...t.data].map((o,i)=>r.type._parseAsync(new nr(t,o,t.path,i)))).then(o=>Ze.mergeArray(a,o));const n=[...t.data].map((o,i)=>r.type._parseSync(new nr(t,o,t.path,i)));return Ze.mergeArray(a,n)}get element(){return this._def.type}min(e,t){return new ir({...this._def,minLength:{value:e,message:K.toString(t)}})}max(e,t){return new ir({...this._def,maxLength:{value:e,message:K.toString(t)}})}length(e,t){return new ir({...this._def,exactLength:{value:e,message:K.toString(t)}})}nonempty(e){return this.min(1,e)}}ir.create=(s,e)=>new ir({type:s,minLength:null,maxLength:null,exactLength:null,typeName:U.ZodArray,...ie(e)});function Ir(s){if(s instanceof je){const e={};for(const t in s.shape){const a=s.shape[t];e[t]=or.create(Ir(a));}return new je({...s._def,shape:()=>e})}else return s instanceof ir?new ir({...s._def,type:Ir(s.element)}):s instanceof or?or.create(Ir(s.unwrap())):s instanceof $r?$r.create(Ir(s.unwrap())):s instanceof wr?wr.create(s.items.map(e=>Ir(e))):s}class je extends ce{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend;}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=pe.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==J.object){const d=this._getOrReturnCtx(e);return B(d,{code:Z.invalid_type,expected:J.object,received:d.parsedType}),ee}const{status:a,ctx:r}=this._processInputParams(e),{shape:n,keys:o}=this._getCached(),i=[];if(!(this._def.catchall instanceof Sr&&this._def.unknownKeys==="strip"))for(const d in r.data)o.includes(d)||i.push(d);const l=[];for(const d of o){const f=n[d],p=r.data[d];l.push({key:{status:"valid",value:d},value:f._parse(new nr(r,p,r.path,d)),alwaysSet:d in r.data});}if(this._def.catchall instanceof Sr){const d=this._def.unknownKeys;if(d==="passthrough")for(const f of i)l.push({key:{status:"valid",value:f},value:{status:"valid",value:r.data[f]}});else if(d==="strict")i.length>0&&(B(r,{code:Z.unrecognized_keys,keys:i}),a.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else {const d=this._def.catchall;for(const f of i){const p=r.data[f];l.push({key:{status:"valid",value:f},value:d._parse(new nr(r,p,r.path,f)),alwaysSet:f in r.data});}}return r.common.async?Promise.resolve().then(async()=>{const d=[];for(const f of l){const p=await f.key,b=await f.value;d.push({key:p,value:b,alwaysSet:f.alwaysSet});}return d}).then(d=>Ze.mergeObjectSync(a,d)):Ze.mergeObjectSync(a,l)}get shape(){return this._def.shape()}strict(e){return K.errToObj,new je({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,a)=>{const r=this._def.errorMap?.(t,a).message??a.defaultError;return t.code==="unrecognized_keys"?{message:K.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new je({...this._def,unknownKeys:"strip"})}passthrough(){return new je({...this._def,unknownKeys:"passthrough"})}extend(e){return new je({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new je({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:U.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new je({...this._def,catchall:e})}pick(e){const t={};for(const a of pe.objectKeys(e))e[a]&&this.shape[a]&&(t[a]=this.shape[a]);return new je({...this._def,shape:()=>t})}omit(e){const t={};for(const a of pe.objectKeys(this.shape))e[a]||(t[a]=this.shape[a]);return new je({...this._def,shape:()=>t})}deepPartial(){return Ir(this)}partial(e){const t={};for(const a of pe.objectKeys(this.shape)){const r=this.shape[a];e&&!e[a]?t[a]=r:t[a]=r.optional();}return new je({...this._def,shape:()=>t})}required(e){const t={};for(const a of pe.objectKeys(this.shape))if(e&&!e[a])t[a]=this.shape[a];else {let n=this.shape[a];for(;n instanceof or;)n=n._def.innerType;t[a]=n;}return new je({...this._def,shape:()=>t})}keyof(){return as(pe.objectKeys(this.shape))}}je.create=(s,e)=>new je({shape:()=>s,unknownKeys:"strip",catchall:Sr.create(),typeName:U.ZodObject,...ie(e)}),je.strictCreate=(s,e)=>new je({shape:()=>s,unknownKeys:"strict",catchall:Sr.create(),typeName:U.ZodObject,...ie(e)}),je.lazycreate=(s,e)=>new je({shape:s,unknownKeys:"strip",catchall:Sr.create(),typeName:U.ZodObject,...ie(e)});class Gr extends ce{_parse(e){const{ctx:t}=this._processInputParams(e),a=this._def.options;function r(n){for(const i of n)if(i.result.status==="valid")return i.result;for(const i of n)if(i.result.status==="dirty")return t.common.issues.push(...i.ctx.common.issues),i.result;const o=n.map(i=>new vr(i.ctx.common.issues));return B(t,{code:Z.invalid_union,unionErrors:o}),ee}if(t.common.async)return Promise.all(a.map(async n=>{const o={...t,common:{...t.common,issues:[]},parent:null};return {result:await n._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(r);{let n;const o=[];for(const l of a){const d={...t,common:{...t.common,issues:[]},parent:null},f=l._parseSync({data:t.data,path:t.path,parent:d});if(f.status==="valid")return f;f.status==="dirty"&&!n&&(n={result:f,ctx:d}),d.common.issues.length&&o.push(d.common.issues);}if(n)return t.common.issues.push(...n.ctx.common.issues),n.result;const i=o.map(l=>new vr(l));return B(t,{code:Z.invalid_union,unionErrors:i}),ee}}get options(){return this._def.options}}Gr.create=(s,e)=>new Gr({options:s,typeName:U.ZodUnion,...ie(e)});const yr=s=>s instanceof xt?yr(s.schema):s instanceof xr?yr(s.innerType()):s instanceof Xr?[s.value]:s instanceof Rr?s.options:s instanceof $t?pe.objectValues(s.enum):s instanceof rt?yr(s._def.innerType):s instanceof bt?[void 0]:s instanceof St?[null]:s instanceof or?[void 0,...yr(s.unwrap())]:s instanceof $r?[null,...yr(s.unwrap())]:s instanceof ns||s instanceof at?yr(s.unwrap()):s instanceof tt?yr(s._def.innerType):[];class wt extends ce{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==J.object)return B(t,{code:Z.invalid_type,expected:J.object,received:t.parsedType}),ee;const a=this.discriminator,r=t.data[a],n=this.optionsMap.get(r);return n?t.common.async?n._parseAsync({data:t.data,path:t.path,parent:t}):n._parseSync({data:t.data,path:t.path,parent:t}):(B(t,{code:Z.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),ee)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,a){const r=new Map;for(const n of t){const o=yr(n.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const i of o){if(r.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);r.set(i,n);}}return new wt({typeName:U.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...ie(a)})}}function Rt(s,e){const t=br(s),a=br(e);if(s===e)return {valid:true,data:s};if(t===J.object&&a===J.object){const r=pe.objectKeys(e),n=pe.objectKeys(s).filter(i=>r.indexOf(i)!==-1),o={...s,...e};for(const i of n){const l=Rt(s[i],e[i]);if(!l.valid)return {valid:false};o[i]=l.data;}return {valid:true,data:o}}else if(t===J.array&&a===J.array){if(s.length!==e.length)return {valid:false};const r=[];for(let n=0;n<s.length;n++){const o=s[n],i=e[n],l=Rt(o,i);if(!l.valid)return {valid:false};r.push(l.data);}return {valid:true,data:r}}else return t===J.date&&a===J.date&&+s==+e?{valid:true,data:s}:{valid:false}}class Wr extends ce{_parse(e){const{status:t,ctx:a}=this._processInputParams(e),r=(n,o)=>{if(Ja(n)||Ja(o))return ee;const i=Rt(n.value,o.value);return i.valid?((Ka(n)||Ka(o))&&t.dirty(),{status:t.value,value:i.data}):(B(a,{code:Z.invalid_intersection_types}),ee)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,o])=>r(n,o)):r(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}Wr.create=(s,e,t)=>new Wr({left:s,right:e,typeName:U.ZodIntersection,...ie(t)});class wr extends ce{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.array)return B(a,{code:Z.invalid_type,expected:J.array,received:a.parsedType}),ee;if(a.data.length<this._def.items.length)return B(a,{code:Z.too_small,minimum:this._def.items.length,inclusive:true,exact:false,type:"array"}),ee;!this._def.rest&&a.data.length>this._def.items.length&&(B(a,{code:Z.too_big,maximum:this._def.items.length,inclusive:true,exact:false,type:"array"}),t.dirty());const n=[...a.data].map((o,i)=>{const l=this._def.items[i]||this._def.rest;return l?l._parse(new nr(a,o,a.path,i)):null}).filter(o=>!!o);return a.common.async?Promise.all(n).then(o=>Ze.mergeArray(t,o)):Ze.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new wr({...this._def,rest:e})}}wr.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wr({items:s,typeName:U.ZodTuple,rest:null,...ie(e)})};class Yr extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.object)return B(a,{code:Z.invalid_type,expected:J.object,received:a.parsedType}),ee;const r=[],n=this._def.keyType,o=this._def.valueType;for(const i in a.data)r.push({key:n._parse(new nr(a,i,a.path,i)),value:o._parse(new nr(a,a.data[i],a.path,i)),alwaysSet:i in a.data});return a.common.async?Ze.mergeObjectAsync(t,r):Ze.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,a){return t instanceof ce?new Yr({keyType:e,valueType:t,typeName:U.ZodRecord,...ie(a)}):new Yr({keyType:gr.create(),valueType:e,typeName:U.ZodRecord,...ie(t)})}}class ts extends ce{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.map)return B(a,{code:Z.invalid_type,expected:J.map,received:a.parsedType}),ee;const r=this._def.keyType,n=this._def.valueType,o=[...a.data.entries()].map(([i,l],d)=>({key:r._parse(new nr(a,i,a.path,[d,"key"])),value:n._parse(new nr(a,l,a.path,[d,"value"]))}));if(a.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const l of o){const d=await l.key,f=await l.value;if(d.status==="aborted"||f.status==="aborted")return ee;(d.status==="dirty"||f.status==="dirty")&&t.dirty(),i.set(d.value,f.value);}return {status:t.value,value:i}})}else {const i=new Map;for(const l of o){const d=l.key,f=l.value;if(d.status==="aborted"||f.status==="aborted")return ee;(d.status==="dirty"||f.status==="dirty")&&t.dirty(),i.set(d.value,f.value);}return {status:t.value,value:i}}}}ts.create=(s,e,t)=>new ts({valueType:e,keyType:s,typeName:U.ZodMap,...ie(t)});class qr extends ce{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.parsedType!==J.set)return B(a,{code:Z.invalid_type,expected:J.set,received:a.parsedType}),ee;const r=this._def;r.minSize!==null&&a.data.size<r.minSize.value&&(B(a,{code:Z.too_small,minimum:r.minSize.value,type:"set",inclusive:true,exact:false,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&a.data.size>r.maxSize.value&&(B(a,{code:Z.too_big,maximum:r.maxSize.value,type:"set",inclusive:true,exact:false,message:r.maxSize.message}),t.dirty());const n=this._def.valueType;function o(l){const d=new Set;for(const f of l){if(f.status==="aborted")return ee;f.status==="dirty"&&t.dirty(),d.add(f.value);}return {status:t.value,value:d}}const i=[...a.data.values()].map((l,d)=>n._parse(new nr(a,l,a.path,d)));return a.common.async?Promise.all(i).then(l=>o(l)):o(i)}min(e,t){return new qr({...this._def,minSize:{value:e,message:K.toString(t)}})}max(e,t){return new qr({...this._def,maxSize:{value:e,message:K.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}qr.create=(s,e)=>new qr({valueType:s,minSize:null,maxSize:null,typeName:U.ZodSet,...ie(e)});class xt extends ce{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}xt.create=(s,e)=>new xt({getter:s,typeName:U.ZodLazy,...ie(e)});class Xr extends ce{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return B(t,{received:t.data,code:Z.invalid_literal,expected:this._def.value}),ee}return {status:"valid",value:e.data}}get value(){return this._def.value}}Xr.create=(s,e)=>new Xr({value:s,typeName:U.ZodLiteral,...ie(e)});function as(s,e){return new Rr({values:s,typeName:U.ZodEnum,...ie(e)})}class Rr extends ce{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),a=this._def.values;return B(t,{expected:pe.joinValues(a),received:t.parsedType,code:Z.invalid_type}),ee}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),a=this._def.values;return B(t,{received:t.data,code:Z.invalid_enum_value,options:a}),ee}return Ke(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Rr.create(e,{...this._def,...t})}exclude(e,t=this._def){return Rr.create(this.options.filter(a=>!e.includes(a)),{...this._def,...t})}}Rr.create=as;class $t extends ce{_parse(e){const t=pe.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==J.string&&a.parsedType!==J.number){const r=pe.objectValues(t);return B(a,{expected:pe.joinValues(r),received:a.parsedType,code:Z.invalid_type}),ee}if(this._cache||(this._cache=new Set(pe.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=pe.objectValues(t);return B(a,{received:a.data,code:Z.invalid_enum_value,options:r}),ee}return Ke(e.data)}get enum(){return this._def.values}}$t.create=(s,e)=>new $t({values:s,typeName:U.ZodNativeEnum,...ie(e)});class et extends ce{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==J.promise&&t.common.async===false)return B(t,{code:Z.invalid_type,expected:J.promise,received:t.parsedType}),ee;const a=t.parsedType===J.promise?t.data:Promise.resolve(t.data);return Ke(a.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}et.create=(s,e)=>new et({type:s,typeName:U.ZodPromise,...ie(e)});class xr extends ce{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===U.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:a}=this._processInputParams(e),r=this._def.effect||null,n={addIssue:o=>{B(a,o),o.fatal?t.abort():t.dirty();},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),r.type==="preprocess"){const o=r.transform(a.data,n);if(a.common.async)return Promise.resolve(o).then(async i=>{if(t.value==="aborted")return ee;const l=await this._def.schema._parseAsync({data:i,path:a.path,parent:a});return l.status==="aborted"?ee:l.status==="dirty"||t.value==="dirty"?jr(l.value):l});{if(t.value==="aborted")return ee;const i=this._def.schema._parseSync({data:o,path:a.path,parent:a});return i.status==="aborted"?ee:i.status==="dirty"||t.value==="dirty"?jr(i.value):i}}if(r.type==="refinement"){const o=i=>{const l=r.refinement(i,n);if(a.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(a.common.async===false){const i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return i.status==="aborted"?ee:(i.status==="dirty"&&t.dirty(),o(i.value),{status:t.value,value:i.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>i.status==="aborted"?ee:(i.status==="dirty"&&t.dirty(),o(i.value).then(()=>({status:t.value,value:i.value}))))}if(r.type==="transform")if(a.common.async===false){const o=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!kr(o))return ee;const i=r.transform(o.value,n);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return {status:t.value,value:i}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(o=>kr(o)?Promise.resolve(r.transform(o.value,n)).then(i=>({status:t.value,value:i})):ee);pe.assertNever(r);}}xr.create=(s,e,t)=>new xr({schema:s,typeName:U.ZodEffects,effect:e,...ie(t)}),xr.createWithPreprocess=(s,e,t)=>new xr({schema:e,effect:{type:"preprocess",transform:s},typeName:U.ZodEffects,...ie(t)});class or extends ce{_parse(e){return this._getType(e)===J.undefined?Ke(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}or.create=(s,e)=>new or({innerType:s,typeName:U.ZodOptional,...ie(e)});class $r extends ce{_parse(e){return this._getType(e)===J.null?Ke(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}$r.create=(s,e)=>new $r({innerType:s,typeName:U.ZodNullable,...ie(e)});class rt extends ce{_parse(e){const{ctx:t}=this._processInputParams(e);let a=t.data;return t.parsedType===J.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}rt.create=(s,e)=>new rt({innerType:s,typeName:U.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ie(e)});class tt extends ce{_parse(e){const{ctx:t}=this._processInputParams(e),a={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return Jr(r)?r.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new vr(a.common.issues)},input:a.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new vr(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}tt.create=(s,e)=>new tt({innerType:s,typeName:U.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ie(e)});class ss extends ce{_parse(e){if(this._getType(e)!==J.nan){const a=this._getOrReturnCtx(e);return B(a,{code:Z.invalid_type,expected:J.nan,received:a.parsedType}),ee}return {status:"valid",value:e.data}}}ss.create=s=>new ss({typeName:U.ZodNaN,...ie(s)});class ns extends ce{_parse(e){const{ctx:t}=this._processInputParams(e),a=t.data;return this._def.type._parse({data:a,path:t.path,parent:t})}unwrap(){return this._def.type}}class Ot extends ce{_parse(e){const{status:t,ctx:a}=this._processInputParams(e);if(a.common.async)return (async()=>{const n=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return n.status==="aborted"?ee:n.status==="dirty"?(t.dirty(),jr(n.value)):this._def.out._parseAsync({data:n.value,path:a.path,parent:a})})();{const r=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return r.status==="aborted"?ee:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:a.path,parent:a})}}static create(e,t){return new Ot({in:e,out:t,typeName:U.ZodPipeline})}}class at extends ce{_parse(e){const t=this._def.innerType._parse(e),a=r=>(kr(r)&&(r.value=Object.freeze(r.value)),r);return Jr(t)?t.then(r=>a(r)):a(t)}unwrap(){return this._def.innerType}}at.create=(s,e)=>new at({innerType:s,typeName:U.ZodReadonly,...ie(e)});var U;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly";})(U||(U={}));const x=gr.create,_e=Cr.create,Se=Pt.create,lr=Et.create;Sr.create;const de=ir.create,k=je.create,Pe=Gr.create,is=wt.create;Wr.create,wr.create;const ur=Yr.create,H=Xr.create,qe=Rr.create;et.create;const y=or.create;$r.create;const st="2.0",os=Pe([x(),_e().int()]),ls=x(),Fi=k({progressToken:y(os)}).passthrough(),Ge=k({_meta:y(Fi)}).passthrough(),Be=k({method:x(),params:y(Ge)}),Lr=k({_meta:y(k({}).passthrough())}).passthrough(),cr=k({method:x(),params:y(Lr)}),We=k({_meta:y(k({}).passthrough())}).passthrough(),nt=Pe([x(),_e().int()]),qi=k({jsonrpc:H(st),id:nt}).merge(Be).strict(),Li=k({jsonrpc:H(st)}).merge(cr).strict(),Mi=k({jsonrpc:H(st),id:nt,result:We}).strict();var us;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError";})(us||(us={}));const zi=k({jsonrpc:H(st),id:nt,error:k({code:_e().int(),message:x(),data:y(lr())})}).strict(),Zi=Pe([qi,Li,Mi,zi]),cs=We.strict(),ds=cr.extend({method:H("notifications/cancelled"),params:Lr.extend({requestId:nt,reason:x().optional()})}),Mr=k({name:x(),title:y(x())}).passthrough(),hs=Mr.extend({version:x()}),Ui=k({experimental:y(k({}).passthrough()),sampling:y(k({}).passthrough()),elicitation:y(k({}).passthrough()),roots:y(k({listChanged:y(Se())}).passthrough())}).passthrough(),Hi=Be.extend({method:H("initialize"),params:Ge.extend({protocolVersion:x(),capabilities:Ui,clientInfo:hs})}),Vi=k({experimental:y(k({}).passthrough()),logging:y(k({}).passthrough()),completions:y(k({}).passthrough()),prompts:y(k({listChanged:y(Se())}).passthrough()),resources:y(k({subscribe:y(Se()),listChanged:y(Se())}).passthrough()),tools:y(k({listChanged:y(Se())}).passthrough())}).passthrough(),Bi=We.extend({protocolVersion:x(),capabilities:Vi,serverInfo:hs,instructions:y(x())}),Qi=cr.extend({method:H("notifications/initialized")}),fs=Be.extend({method:H("ping")}),Ji=k({progress:_e(),total:y(_e()),message:y(x())}).passthrough(),ms=cr.extend({method:H("notifications/progress"),params:Lr.merge(Ji).extend({progressToken:os})}),it=Be.extend({params:Ge.extend({cursor:y(ls)}).optional()}),ot=We.extend({nextCursor:y(ls)}),ps=k({uri:x(),mimeType:y(x()),_meta:y(k({}).passthrough())}).passthrough(),vs=ps.extend({text:x()}),gs=ps.extend({blob:x().base64()}),ys=Mr.extend({uri:x(),description:y(x()),mimeType:y(x()),_meta:y(k({}).passthrough())}),Ki=Mr.extend({uriTemplate:x(),description:y(x()),mimeType:y(x()),_meta:y(k({}).passthrough())}),Gi=it.extend({method:H("resources/list")}),Wi=ot.extend({resources:de(ys)}),Yi=it.extend({method:H("resources/templates/list")}),Xi=ot.extend({resourceTemplates:de(Ki)}),eo=Be.extend({method:H("resources/read"),params:Ge.extend({uri:x()})}),ro=We.extend({contents:de(Pe([vs,gs]))}),to=cr.extend({method:H("notifications/resources/list_changed")}),ao=Be.extend({method:H("resources/subscribe"),params:Ge.extend({uri:x()})}),so=Be.extend({method:H("resources/unsubscribe"),params:Ge.extend({uri:x()})}),no=cr.extend({method:H("notifications/resources/updated"),params:Lr.extend({uri:x()})}),io=k({name:x(),description:y(x()),required:y(Se())}).passthrough(),oo=Mr.extend({description:y(x()),arguments:y(de(io)),_meta:y(k({}).passthrough())}),lo=it.extend({method:H("prompts/list")}),uo=ot.extend({prompts:de(oo)}),co=Be.extend({method:H("prompts/get"),params:Ge.extend({name:x(),arguments:y(ur(x()))})}),Tt=k({type:H("text"),text:x(),_meta:y(k({}).passthrough())}).passthrough(),kt=k({type:H("image"),data:x().base64(),mimeType:x(),_meta:y(k({}).passthrough())}).passthrough(),Ct=k({type:H("audio"),data:x().base64(),mimeType:x(),_meta:y(k({}).passthrough())}).passthrough(),ho=k({type:H("resource"),resource:Pe([vs,gs]),_meta:y(k({}).passthrough())}).passthrough(),fo=ys.extend({type:H("resource_link")}),_s=Pe([Tt,kt,Ct,fo,ho]),mo=k({role:qe(["user","assistant"]),content:_s}).passthrough(),po=We.extend({description:y(x()),messages:de(mo)}),vo=cr.extend({method:H("notifications/prompts/list_changed")}),go=k({title:y(x()),readOnlyHint:y(Se()),destructiveHint:y(Se()),idempotentHint:y(Se()),openWorldHint:y(Se())}).passthrough(),yo=Mr.extend({description:y(x()),inputSchema:k({type:H("object"),properties:y(k({}).passthrough()),required:y(de(x()))}).passthrough(),outputSchema:y(k({type:H("object"),properties:y(k({}).passthrough()),required:y(de(x()))}).passthrough()),annotations:y(go),_meta:y(k({}).passthrough())}),_o=it.extend({method:H("tools/list")}),Po=ot.extend({tools:de(yo)}),Ps=We.extend({content:de(_s).default([]),structuredContent:k({}).passthrough().optional(),isError:y(Se())});Ps.or(We.extend({toolResult:lr()}));const bo=Be.extend({method:H("tools/call"),params:Ge.extend({name:x(),arguments:y(ur(lr()))})}),So=cr.extend({method:H("notifications/tools/list_changed")}),bs=qe(["debug","info","notice","warning","error","critical","alert","emergency"]),Eo=Be.extend({method:H("logging/setLevel"),params:Ge.extend({level:bs})}),wo=cr.extend({method:H("notifications/message"),params:Lr.extend({level:bs,logger:y(x()),data:lr()})}),Ro=k({name:x().optional()}).passthrough(),xo=k({hints:y(de(Ro)),costPriority:y(_e().min(0).max(1)),speedPriority:y(_e().min(0).max(1)),intelligencePriority:y(_e().min(0).max(1))}).passthrough(),$o=k({role:qe(["user","assistant"]),content:Pe([Tt,kt,Ct])}).passthrough(),Oo=Be.extend({method:H("sampling/createMessage"),params:Ge.extend({messages:de($o),systemPrompt:y(x()),includeContext:y(qe(["none","thisServer","allServers"])),temperature:y(_e()),maxTokens:_e().int(),stopSequences:y(de(x())),metadata:y(k({}).passthrough()),modelPreferences:y(xo)})}),To=We.extend({model:x(),stopReason:y(qe(["endTurn","stopSequence","maxTokens"]).or(x())),role:qe(["user","assistant"]),content:is("type",[Tt,kt,Ct])}),ko=k({type:H("boolean"),title:y(x()),description:y(x()),default:y(Se())}).passthrough(),Co=k({type:H("string"),title:y(x()),description:y(x()),minLength:y(_e()),maxLength:y(_e()),format:y(qe(["email","uri","date","date-time"]))}).passthrough(),Io=k({type:qe(["number","integer"]),title:y(x()),description:y(x()),minimum:y(_e()),maximum:y(_e())}).passthrough(),Ao=k({type:H("string"),title:y(x()),description:y(x()),enum:de(x()),enumNames:y(de(x()))}).passthrough(),Do=Pe([ko,Co,Io,Ao]),No=Be.extend({method:H("elicitation/create"),params:Ge.extend({message:x(),requestedSchema:k({type:H("object"),properties:ur(x(),Do),required:y(de(x()))}).passthrough()})}),jo=We.extend({action:qe(["accept","decline","cancel"]),content:y(ur(x(),lr()))}),Fo=k({type:H("ref/resource"),uri:x()}).passthrough(),qo=k({type:H("ref/prompt"),name:x()}).passthrough(),Lo=Be.extend({method:H("completion/complete"),params:Ge.extend({ref:Pe([qo,Fo]),argument:k({name:x(),value:x()}).passthrough(),context:y(k({arguments:y(ur(x(),x()))}))})}),Mo=We.extend({completion:k({values:de(x()).max(100),total:y(_e().int()),hasMore:y(Se())}).passthrough()}),zo=k({uri:x().startsWith("file://"),name:y(x()),_meta:y(k({}).passthrough())}).passthrough(),Zo=Be.extend({method:H("roots/list")}),Uo=We.extend({roots:de(zo)}),Ho=cr.extend({method:H("notifications/roots/list_changed")});Pe([fs,Hi,Lo,Eo,co,lo,Gi,Yi,eo,ao,so,bo,_o]),Pe([ds,ms,Qi,Ho]),Pe([cs,To,jo,Uo]),Pe([fs,Oo,No,Zo]),Pe([ds,ms,wo,no,to,So,vo]),Pe([cs,Bi,Mo,po,uo,Wi,Xi,ro,Ps,Po]);var Vo=(s=>(s.START="start",s.STARTED="started",s.STOP="stop",s.STOPPED="stopped",s.PING="ping",s.PONG="pong",s.ERROR="error",s.LIST_TOOLS="list_tools",s.CALL_TOOL="call_tool",s.TOOL_LIST_UPDATED="tool_list_updated",s.TOOL_LIST_UPDATED_ACK="tool_list_updated_ack",s.PROCESS_DATA="process_data",s.SERVER_STARTED="server_started",s.SERVER_STOPPED="server_stopped",s.ERROR_FROM_NATIVE_HOST="error_from_native_host",s.CONNECT_NATIVE="connectNative",s.PING_NATIVE="ping_native",s.DISCONNECT_NATIVE="disconnect_native",s))(Vo||{}),Bo=class{_started=false;_allowedOrigins;_channelId;_messageHandler;_clientOrigin;onclose;onerror;onmessage;constructor(s){if(!s.allowedOrigins||s.allowedOrigins.length===0)throw new Error("At least one allowed origin must be specified");this._allowedOrigins=s.allowedOrigins,this._channelId=s.channelId||"mcp-default";}async start(){if(this._started)throw new Error("Transport already started");this._messageHandler=s=>{if(!this._allowedOrigins.includes(s.origin)&&!this._allowedOrigins.includes("*")||s.data?.channel!==this._channelId||s.data?.type!=="mcp"||s.data?.direction!=="client-to-server")return;this._clientOrigin=s.origin;let e=s.data.payload;if(typeof e=="string"&&e==="mcp-check-ready"){window.postMessage({channel:this._channelId,type:"mcp",direction:"server-to-client",payload:"mcp-server-ready"},this._clientOrigin);return}try{let t=Zi.parse(e);this.onmessage?.(t);}catch(t){this.onerror?.(new Error(`Invalid message: ${t instanceof Error?t.message:String(t)}`));}},window.addEventListener("message",this._messageHandler),this._started=true,window.postMessage({channel:this._channelId,type:"mcp",direction:"server-to-client",payload:"mcp-server-ready"},"*");}async send(s){if(!this._started)throw new Error("Transport not started");if(!this._clientOrigin)throw new Error("No client connected");window.postMessage({channel:this._channelId,type:"mcp",direction:"server-to-client",payload:s},this._clientOrigin);}async close(){this._messageHandler&&window.removeEventListener("message",this._messageHandler),this._started=false,window.postMessage({channel:this._channelId,type:"mcp",direction:"server-to-client",payload:"mcp-server-stopped"},"*"),this.onclose?.();}};const Ss="2025-06-18",Qo=[Ss,"2025-03-26","2024-11-05","2024-10-07"],lt="2.0",Es=Pe([x(),_e().int()]),ws=x(),Jo=k({progressToken:y(Es)}).passthrough(),Ye=k({_meta:y(Jo)}).passthrough(),Qe=k({method:x(),params:y(Ye)}),zr=k({_meta:y(k({}).passthrough())}).passthrough(),dr=k({method:x(),params:y(zr)}),Xe=k({_meta:y(k({}).passthrough())}).passthrough(),ut=Pe([x(),_e().int()]),Rs=k({jsonrpc:H(lt),id:ut}).merge(Qe).strict(),Ko=s=>Rs.safeParse(s).success,xs=k({jsonrpc:H(lt)}).merge(dr).strict(),Go=s=>xs.safeParse(s).success,$s=k({jsonrpc:H(lt),id:ut,result:Xe}).strict(),Os=s=>$s.safeParse(s).success;var Oe;(function(s){s[s.ConnectionClosed=-32e3]="ConnectionClosed",s[s.RequestTimeout=-32001]="RequestTimeout",s[s.ParseError=-32700]="ParseError",s[s.InvalidRequest=-32600]="InvalidRequest",s[s.MethodNotFound=-32601]="MethodNotFound",s[s.InvalidParams=-32602]="InvalidParams",s[s.InternalError=-32603]="InternalError";})(Oe||(Oe={}));const Ts=k({jsonrpc:H(lt),id:ut,error:k({code:_e().int(),message:x(),data:y(lr())})}).strict(),Wo=s=>Ts.safeParse(s).success;Pe([Rs,xs,$s,Ts]);const It=Xe.strict(),At=dr.extend({method:H("notifications/cancelled"),params:zr.extend({requestId:ut,reason:x().optional()})}),Zr=k({name:x(),title:y(x())}).passthrough(),ks=Zr.extend({version:x()}),Yo=k({experimental:y(k({}).passthrough()),sampling:y(k({}).passthrough()),elicitation:y(k({}).passthrough()),roots:y(k({listChanged:y(Se())}).passthrough())}).passthrough(),Cs=Qe.extend({method:H("initialize"),params:Ye.extend({protocolVersion:x(),capabilities:Yo,clientInfo:ks})}),Xo=k({experimental:y(k({}).passthrough()),logging:y(k({}).passthrough()),completions:y(k({}).passthrough()),prompts:y(k({listChanged:y(Se())}).passthrough()),resources:y(k({subscribe:y(Se()),listChanged:y(Se())}).passthrough()),tools:y(k({listChanged:y(Se())}).passthrough())}).passthrough(),el=Xe.extend({protocolVersion:x(),capabilities:Xo,serverInfo:ks,instructions:y(x())}),Is=dr.extend({method:H("notifications/initialized")}),Dt=Qe.extend({method:H("ping")}),rl=k({progress:_e(),total:y(_e()),message:y(x())}).passthrough(),Nt=dr.extend({method:H("notifications/progress"),params:zr.merge(rl).extend({progressToken:Es})}),ct=Qe.extend({params:Ye.extend({cursor:y(ws)}).optional()}),dt=Xe.extend({nextCursor:y(ws)}),As=k({uri:x(),mimeType:y(x()),_meta:y(k({}).passthrough())}).passthrough(),Ds=As.extend({text:x()}),jt=x().refine(s=>{try{return atob(s),!0}catch{return  false}},{message:"Invalid Base64 string"}),Ns=As.extend({blob:jt}),js=Zr.extend({uri:x(),description:y(x()),mimeType:y(x()),_meta:y(k({}).passthrough())}),tl=Zr.extend({uriTemplate:x(),description:y(x()),mimeType:y(x()),_meta:y(k({}).passthrough())}),Ft=ct.extend({method:H("resources/list")}),al=dt.extend({resources:de(js)}),qt=ct.extend({method:H("resources/templates/list")}),sl=dt.extend({resourceTemplates:de(tl)}),Lt=Qe.extend({method:H("resources/read"),params:Ye.extend({uri:x()})}),nl=Xe.extend({contents:de(Pe([Ds,Ns]))}),il=dr.extend({method:H("notifications/resources/list_changed")}),ol=Qe.extend({method:H("resources/subscribe"),params:Ye.extend({uri:x()})}),ll=Qe.extend({method:H("resources/unsubscribe"),params:Ye.extend({uri:x()})}),ul=dr.extend({method:H("notifications/resources/updated"),params:zr.extend({uri:x()})}),cl=k({name:x(),description:y(x()),required:y(Se())}).passthrough(),dl=Zr.extend({description:y(x()),arguments:y(de(cl)),_meta:y(k({}).passthrough())}),Mt=ct.extend({method:H("prompts/list")}),hl=dt.extend({prompts:de(dl)}),zt=Qe.extend({method:H("prompts/get"),params:Ye.extend({name:x(),arguments:y(ur(x()))})}),Zt=k({type:H("text"),text:x(),_meta:y(k({}).passthrough())}).passthrough(),Ut=k({type:H("image"),data:jt,mimeType:x(),_meta:y(k({}).passthrough())}).passthrough(),Ht=k({type:H("audio"),data:jt,mimeType:x(),_meta:y(k({}).passthrough())}).passthrough(),fl=k({type:H("resource"),resource:Pe([Ds,Ns]),_meta:y(k({}).passthrough())}).passthrough(),ml=js.extend({type:H("resource_link")}),Fs=Pe([Zt,Ut,Ht,ml,fl]),pl=k({role:qe(["user","assistant"]),content:Fs}).passthrough(),vl=Xe.extend({description:y(x()),messages:de(pl)}),gl=dr.extend({method:H("notifications/prompts/list_changed")}),yl=k({title:y(x()),readOnlyHint:y(Se()),destructiveHint:y(Se()),idempotentHint:y(Se()),openWorldHint:y(Se())}).passthrough(),_l=Zr.extend({description:y(x()),inputSchema:k({type:H("object"),properties:y(k({}).passthrough()),required:y(de(x()))}).passthrough(),outputSchema:y(k({type:H("object"),properties:y(k({}).passthrough()),required:y(de(x()))}).passthrough()),annotations:y(yl),_meta:y(k({}).passthrough())}),Vt=ct.extend({method:H("tools/list")}),Pl=dt.extend({tools:de(_l)}),qs=Xe.extend({content:de(Fs).default([]),structuredContent:k({}).passthrough().optional(),isError:y(Se())});qs.or(Xe.extend({toolResult:lr()}));const Bt=Qe.extend({method:H("tools/call"),params:Ye.extend({name:x(),arguments:y(ur(lr()))})}),bl=dr.extend({method:H("notifications/tools/list_changed")}),Ls=qe(["debug","info","notice","warning","error","critical","alert","emergency"]),Sl=Qe.extend({method:H("logging/setLevel"),params:Ye.extend({level:Ls})}),El=dr.extend({method:H("notifications/message"),params:zr.extend({level:Ls,logger:y(x()),data:lr()})}),wl=k({name:x().optional()}).passthrough(),Rl=k({hints:y(de(wl)),costPriority:y(_e().min(0).max(1)),speedPriority:y(_e().min(0).max(1)),intelligencePriority:y(_e().min(0).max(1))}).passthrough(),xl=k({role:qe(["user","assistant"]),content:Pe([Zt,Ut,Ht])}).passthrough(),$l=Qe.extend({method:H("sampling/createMessage"),params:Ye.extend({messages:de(xl),systemPrompt:y(x()),includeContext:y(qe(["none","thisServer","allServers"])),temperature:y(_e()),maxTokens:_e().int(),stopSequences:y(de(x())),metadata:y(k({}).passthrough()),modelPreferences:y(Rl)})}),Ms=Xe.extend({model:x(),stopReason:y(qe(["endTurn","stopSequence","maxTokens"]).or(x())),role:qe(["user","assistant"]),content:is("type",[Zt,Ut,Ht])}),Ol=k({type:H("boolean"),title:y(x()),description:y(x()),default:y(Se())}).passthrough(),Tl=k({type:H("string"),title:y(x()),description:y(x()),minLength:y(_e()),maxLength:y(_e()),format:y(qe(["email","uri","date","date-time"]))}).passthrough(),kl=k({type:qe(["number","integer"]),title:y(x()),description:y(x()),minimum:y(_e()),maximum:y(_e())}).passthrough(),Cl=k({type:H("string"),title:y(x()),description:y(x()),enum:de(x()),enumNames:y(de(x()))}).passthrough(),Il=Pe([Ol,Tl,kl,Cl]),Al=Qe.extend({method:H("elicitation/create"),params:Ye.extend({message:x(),requestedSchema:k({type:H("object"),properties:ur(x(),Il),required:y(de(x()))}).passthrough()})}),zs=Xe.extend({action:qe(["accept","decline","cancel"]),content:y(ur(x(),lr()))}),Dl=k({type:H("ref/resource"),uri:x()}).passthrough(),Nl=k({type:H("ref/prompt"),name:x()}).passthrough(),Qt=Qe.extend({method:H("completion/complete"),params:Ye.extend({ref:Pe([Nl,Dl]),argument:k({name:x(),value:x()}).passthrough(),context:y(k({arguments:y(ur(x(),x()))}))})}),jl=Xe.extend({completion:k({values:de(x()).max(100),total:y(_e().int()),hasMore:y(Se())}).passthrough()}),Fl=k({uri:x().startsWith("file://"),name:y(x()),_meta:y(k({}).passthrough())}).passthrough(),ql=Qe.extend({method:H("roots/list")}),Zs=Xe.extend({roots:de(Fl)}),Ll=dr.extend({method:H("notifications/roots/list_changed")});Pe([Dt,Cs,Qt,Sl,zt,Mt,Ft,qt,Lt,ol,ll,Bt,Vt]),Pe([At,Nt,Is,Ll]),Pe([It,Ms,zs,Zs]),Pe([Dt,$l,Al,ql]),Pe([At,Nt,El,ul,il,bl,gl]),Pe([It,el,jl,vl,hl,al,sl,nl,qs,Pl]);class Ce extends Error{constructor(e,t,a){super(`MCP error ${e}: ${t}`),this.code=e,this.data=a,this.name="McpError";}}const Ml=6e4;class zl{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this._pendingDebouncedNotifications=new Set,this.setNotificationHandler(At,t=>{const a=this._requestHandlerAbortControllers.get(t.params.requestId);a?.abort(t.params.reason);}),this.setNotificationHandler(Nt,t=>{this._onprogress(t);}),this.setRequestHandler(Dt,t=>({}));}_setupTimeout(e,t,a,r,n=false){this._timeoutInfo.set(e,{timeoutId:setTimeout(r,t),startTime:Date.now(),timeout:t,maxTotalTimeout:a,resetTimeoutOnProgress:n,onTimeout:r});}_resetTimeout(e){const t=this._timeoutInfo.get(e);if(!t)return  false;const a=Date.now()-t.startTime;if(t.maxTotalTimeout&&a>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new Ce(Oe.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:a});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),true}_cleanupTimeout(e){const t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e));}async connect(e){var t,a,r;this._transport=e;const n=(t=this.transport)===null||t===void 0?void 0:t.onclose;this._transport.onclose=()=>{n?.(),this._onclose();};const o=(a=this.transport)===null||a===void 0?void 0:a.onerror;this._transport.onerror=l=>{o?.(l),this._onerror(l);};const i=(r=this._transport)===null||r===void 0?void 0:r.onmessage;this._transport.onmessage=(l,d)=>{i?.(l,d),Os(l)||Wo(l)?this._onresponse(l):Ko(l)?this._onrequest(l,d):Go(l)?this._onnotification(l):this._onerror(new Error(`Unknown message type: ${JSON.stringify(l)}`));},await this._transport.start();}_onclose(){var e;const t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._pendingDebouncedNotifications.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);const a=new Ce(Oe.ConnectionClosed,"Connection closed");for(const r of t.values())r(a);}_onerror(e){var t;(t=this.onerror)===null||t===void 0||t.call(this,e);}_onnotification(e){var t;const a=(t=this._notificationHandlers.get(e.method))!==null&&t!==void 0?t:this.fallbackNotificationHandler;a!==void 0&&Promise.resolve().then(()=>a(e)).catch(r=>this._onerror(new Error(`Uncaught error in notification handler: ${r}`)));}_onrequest(e,t){var a,r;const n=(a=this._requestHandlers.get(e.method))!==null&&a!==void 0?a:this.fallbackRequestHandler,o=this._transport;if(n===void 0){o?.send({jsonrpc:"2.0",id:e.id,error:{code:Oe.MethodNotFound,message:"Method not found"}}).catch(d=>this._onerror(new Error(`Failed to send an error response: ${d}`)));return}const i=new AbortController;this._requestHandlerAbortControllers.set(e.id,i);const l={signal:i.signal,sessionId:o?.sessionId,_meta:(r=e.params)===null||r===void 0?void 0:r._meta,sendNotification:d=>this.notification(d,{relatedRequestId:e.id}),sendRequest:(d,f,p)=>this.request(d,f,{...p,relatedRequestId:e.id}),authInfo:t?.authInfo,requestId:e.id,requestInfo:t?.requestInfo};Promise.resolve().then(()=>n(e,l)).then(d=>{if(!i.signal.aborted)return o?.send({result:d,jsonrpc:"2.0",id:e.id})},d=>{var f;if(!i.signal.aborted)return o?.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(d.code)?d.code:Oe.InternalError,message:(f=d.message)!==null&&f!==void 0?f:"Internal error"}})}).catch(d=>this._onerror(new Error(`Failed to send response: ${d}`))).finally(()=>{this._requestHandlerAbortControllers.delete(e.id);});}_onprogress(e){const{progressToken:t,...a}=e.params,r=Number(t),n=this._progressHandlers.get(r);if(!n){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}const o=this._responseHandlers.get(r),i=this._timeoutInfo.get(r);if(i&&o&&i.resetTimeoutOnProgress)try{this._resetTimeout(r);}catch(l){o(l);return}n(a);}_onresponse(e){const t=Number(e.id),a=this._responseHandlers.get(t);if(a===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),Os(e))a(e);else {const r=new Ce(e.error.code,e.error.message,e.error.data);a(r);}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close());}request(e,t,a){const{relatedRequestId:r,resumptionToken:n,onresumptiontoken:o}=a??{};return new Promise((i,l)=>{var d,f,p,b,c,h;if(!this._transport){l(new Error("Not connected"));return}((d=this._options)===null||d===void 0?void 0:d.enforceStrictCapabilities)===true&&this.assertCapabilityForMethod(e.method),(f=a?.signal)===null||f===void 0||f.throwIfAborted();const _=this._requestMessageId++,v={...e,jsonrpc:"2.0",id:_};a?.onprogress&&(this._progressHandlers.set(_,a.onprogress),v.params={...e.params,_meta:{...((p=e.params)===null||p===void 0?void 0:p._meta)||{},progressToken:_}});const S=P=>{var R;this._responseHandlers.delete(_),this._progressHandlers.delete(_),this._cleanupTimeout(_),(R=this._transport)===null||R===void 0||R.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:_,reason:String(P)}},{relatedRequestId:r,resumptionToken:n,onresumptiontoken:o}).catch(C=>this._onerror(new Error(`Failed to send cancellation: ${C}`))),l(P);};this._responseHandlers.set(_,P=>{var R;if(!(!((R=a?.signal)===null||R===void 0)&&R.aborted)){if(P instanceof Error)return l(P);try{const C=t.parse(P.result);i(C);}catch(C){l(C);}}}),(b=a?.signal)===null||b===void 0||b.addEventListener("abort",()=>{var P;S((P=a?.signal)===null||P===void 0?void 0:P.reason);});const j=(c=a?.timeout)!==null&&c!==void 0?c:Ml,I=()=>S(new Ce(Oe.RequestTimeout,"Request timed out",{timeout:j}));this._setupTimeout(_,j,a?.maxTotalTimeout,I,(h=a?.resetTimeoutOnProgress)!==null&&h!==void 0?h:false),this._transport.send(v,{relatedRequestId:r,resumptionToken:n,onresumptiontoken:o}).catch(P=>{this._cleanupTimeout(_),l(P);});})}async notification(e,t){var a,r;if(!this._transport)throw new Error("Not connected");if(this.assertNotificationCapability(e.method),((r=(a=this._options)===null||a===void 0?void 0:a.debouncedNotificationMethods)!==null&&r!==void 0?r:[]).includes(e.method)&&!e.params&&!t?.relatedRequestId){if(this._pendingDebouncedNotifications.has(e.method))return;this._pendingDebouncedNotifications.add(e.method),Promise.resolve().then(()=>{var l;if(this._pendingDebouncedNotifications.delete(e.method),!this._transport)return;const d={...e,jsonrpc:"2.0"};(l=this._transport)===null||l===void 0||l.send(d,t).catch(f=>this._onerror(f));});return}const i={...e,jsonrpc:"2.0"};await this._transport.send(i,t);}setRequestHandler(e,t){const a=e.shape.method.value;this.assertRequestHandlerCapability(a),this._requestHandlers.set(a,(r,n)=>Promise.resolve(t(e.parse(r),n)));}removeRequestHandler(e){this._requestHandlers.delete(e);}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,a=>Promise.resolve(t(e.parse(a))));}removeNotificationHandler(e){this._notificationHandlers.delete(e);}}function Zl(s,e){return Object.entries(e).reduce((t,[a,r])=>(r&&typeof r=="object"?t[a]=t[a]?{...t[a],...r}:r:t[a]=r,t),{...s})}function Ul(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ur={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */var Hl=Ur.exports,Us;function Vl(){return Us||(Us=1,function(s,e){(function(t,a){a(e);})(Hl,function(t){function a(){for(var m=arguments.length,u=Array(m),g=0;g<m;g++)u[g]=arguments[g];if(u.length>1){u[0]=u[0].slice(0,-1);for(var T=u.length-1,O=1;O<T;++O)u[O]=u[O].slice(1,-1);return u[T]=u[T].slice(1),u.join("")}else return u[0]}function r(m){return "(?:"+m+")"}function n(m){return m===void 0?"undefined":m===null?"null":Object.prototype.toString.call(m).split(" ").pop().split("]").shift().toLowerCase()}function o(m){return m.toUpperCase()}function i(m){return m!=null?m instanceof Array?m:typeof m.length!="number"||m.split||m.setInterval||m.call?[m]:Array.prototype.slice.call(m):[]}function l(m,u){var g=m;if(u)for(var T in u)g[T]=u[T];return g}function d(m){var u="[A-Za-z]",g="[0-9]",T=a(g,"[A-Fa-f]"),O=r(r("%[EFef]"+T+"%"+T+T+"%"+T+T)+"|"+r("%[89A-Fa-f]"+T+"%"+T+T)+"|"+r("%"+T+T)),W="[\\:\\/\\?\\#\\[\\]\\@]",Y="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",me=a(W,Y),we=m?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",De=m?"[\\uE000-\\uF8FF]":"[]",fe=a(u,g,"[\\-\\.\\_\\~]",we);r(u+a(u,g,"[\\+\\-\\.]")+"*"),r(r(O+"|"+a(fe,Y,"[\\:]"))+"*");var Ee=r(r("25[0-5]")+"|"+r("2[0-4]"+g)+"|"+r("1"+g+g)+"|"+r("0?[1-9]"+g)+"|0?0?"+g),Ne=r(Ee+"\\."+Ee+"\\."+Ee+"\\."+Ee),se=r(T+"{1,4}"),xe=r(r(se+"\\:"+se)+"|"+Ne),Fe=r(r(se+"\\:")+"{6}"+xe),$e=r("\\:\\:"+r(se+"\\:")+"{5}"+xe),Er=r(r(se)+"?\\:\\:"+r(se+"\\:")+"{4}"+xe),fr=r(r(r(se+"\\:")+"{0,1}"+se)+"?\\:\\:"+r(se+"\\:")+"{3}"+xe),mr=r(r(r(se+"\\:")+"{0,2}"+se)+"?\\:\\:"+r(se+"\\:")+"{2}"+xe),Nr=r(r(r(se+"\\:")+"{0,3}"+se)+"?\\:\\:"+se+"\\:"+xe),Or=r(r(r(se+"\\:")+"{0,4}"+se)+"?\\:\\:"+xe),rr=r(r(r(se+"\\:")+"{0,5}"+se)+"?\\:\\:"+se),pr=r(r(r(se+"\\:")+"{0,6}"+se)+"?\\:\\:"),Tr=r([Fe,$e,Er,fr,mr,Nr,Or,rr,pr].join("|")),Pr=r(r(fe+"|"+O)+"+");r("[vV]"+T+"+\\."+a(fe,Y,"[\\:]")+"+"),r(r(O+"|"+a(fe,Y))+"*");var Br=r(O+"|"+a(fe,Y,"[\\:\\@]"));return r(r(O+"|"+a(fe,Y,"[\\@]"))+"+"),r(r(Br+"|"+a("[\\/\\?]",De))+"*"),{NOT_SCHEME:new RegExp(a("[^]",u,g,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(a("[^\\%\\:]",fe,Y),"g"),NOT_HOST:new RegExp(a("[^\\%\\[\\]\\:]",fe,Y),"g"),NOT_PATH:new RegExp(a("[^\\%\\/\\:\\@]",fe,Y),"g"),NOT_PATH_NOSCHEME:new RegExp(a("[^\\%\\/\\@]",fe,Y),"g"),NOT_QUERY:new RegExp(a("[^\\%]",fe,Y,"[\\:\\@\\/\\?]",De),"g"),NOT_FRAGMENT:new RegExp(a("[^\\%]",fe,Y,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(a("[^]",fe,Y),"g"),UNRESERVED:new RegExp(fe,"g"),OTHER_CHARS:new RegExp(a("[^\\%]",fe,me),"g"),PCT_ENCODED:new RegExp(O,"g"),IPV4ADDRESS:new RegExp("^("+Ne+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Tr+")"+r(r("\\%25|\\%(?!"+T+"{2})")+"("+Pr+")")+"?\\]?$")}}var f=d(false),p=d(true),b=function(){function m(u,g){var T=[],O=true,W=false,Y=void 0;try{for(var me=u[Symbol.iterator](),we;!(O=(we=me.next()).done)&&(T.push(we.value),!(g&&T.length===g));O=!0);}catch(De){W=true,Y=De;}finally{try{!O&&me.return&&me.return();}finally{if(W)throw Y}}return T}return function(u,g){if(Array.isArray(u))return u;if(Symbol.iterator in Object(u))return m(u,g);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=function(m){if(Array.isArray(m)){for(var u=0,g=Array(m.length);u<m.length;u++)g[u]=m[u];return g}else return Array.from(m)},h=2147483647,_=36,v=1,S=26,j=38,I=700,P=72,R=128,C="-",A=/^xn--/,D=/[^\0-\x7E]/,N=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},$=_-v,F=Math.floor,M=String.fromCharCode;function z(m){throw new RangeError(E[m])}function G(m,u){for(var g=[],T=m.length;T--;)g[T]=u(m[T]);return g}function ne(m,u){var g=m.split("@"),T="";g.length>1&&(T=g[0]+"@",m=g[1]),m=m.replace(N,".");var O=m.split("."),W=G(O,u).join(".");return T+W}function X(m){for(var u=[],g=0,T=m.length;g<T;){var O=m.charCodeAt(g++);if(O>=55296&&O<=56319&&g<T){var W=m.charCodeAt(g++);(W&64512)==56320?u.push(((O&1023)<<10)+(W&1023)+65536):(u.push(O),g--);}else u.push(O);}return u}var le=function(u){return String.fromCodePoint.apply(String,c(u))},te=function(u){return u-48<10?u-22:u-65<26?u-65:u-97<26?u-97:_},ae=function(u,g){return u+22+75*(u<26)-((g!=0)<<5)},He=function(u,g,T){var O=0;for(u=T?F(u/I):u>>1,u+=F(u/g);u>$*S>>1;O+=_)u=F(u/$);return F(O+($+1)*u/(u+j))},Me=function(u){var g=[],T=u.length,O=0,W=R,Y=P,me=u.lastIndexOf(C);me<0&&(me=0);for(var we=0;we<me;++we)u.charCodeAt(we)>=128&&z("not-basic"),g.push(u.charCodeAt(we));for(var De=me>0?me+1:0;De<T;){for(var fe=O,Ee=1,Ne=_;;Ne+=_){De>=T&&z("invalid-input");var se=te(u.charCodeAt(De++));(se>=_||se>F((h-O)/Ee))&&z("overflow"),O+=se*Ee;var xe=Ne<=Y?v:Ne>=Y+S?S:Ne-Y;if(se<xe)break;var Fe=_-xe;Ee>F(h/Fe)&&z("overflow"),Ee*=Fe;}var $e=g.length+1;Y=He(O-fe,$e,fe==0),F(O/$e)>h-W&&z("overflow"),W+=F(O/$e),O%=$e,g.splice(O++,0,W);}return String.fromCodePoint.apply(String,g)},Le=function(u){var g=[];u=X(u);var T=u.length,O=R,W=0,Y=P,me=true,we=false,De=void 0;try{for(var fe=u[Symbol.iterator](),Ee;!(me=(Ee=fe.next()).done);me=!0){var Ne=Ee.value;Ne<128&&g.push(M(Ne));}}catch(Qr){we=true,De=Qr;}finally{try{!me&&fe.return&&fe.return();}finally{if(we)throw De}}var se=g.length,xe=se;for(se&&g.push(C);xe<T;){var Fe=h,$e=true,Er=false,fr=void 0;try{for(var mr=u[Symbol.iterator](),Nr;!($e=(Nr=mr.next()).done);$e=!0){var Or=Nr.value;Or>=O&&Or<Fe&&(Fe=Or);}}catch(Qr){Er=true,fr=Qr;}finally{try{!$e&&mr.return&&mr.return();}finally{if(Er)throw fr}}var rr=xe+1;Fe-O>F((h-W)/rr)&&z("overflow"),W+=(Fe-O)*rr,O=Fe;var pr=true,Tr=false,Pr=void 0;try{for(var Br=u[Symbol.iterator](),li;!(pr=(li=Br.next()).done);pr=!0){var ui=li.value;if(ui<O&&++W>h&&z("overflow"),ui==O){for(var pt=W,vt=_;;vt+=_){var gt=vt<=Y?v:vt>=Y+S?S:vt-Y;if(pt<gt)break;var ci=pt-gt,di=_-gt;g.push(M(ae(gt+ci%di,0))),pt=F(ci/di);}g.push(M(ae(pt,0))),Y=He(W,rr,xe==se),W=0,++xe;}}}catch(Qr){Tr=true,Pr=Qr;}finally{try{!pr&&Br.return&&Br.return();}finally{if(Tr)throw Pr}}++W,++O;}return g.join("")},Ie=function(u){return ne(u,function(g){return A.test(g)?Me(g.slice(4).toLowerCase()):g})},er=function(u){return ne(u,function(g){return D.test(g)?"xn--"+Le(g):g})},w={version:"2.1.0",ucs2:{decode:X,encode:le},decode:Me,encode:Le,toASCII:er,toUnicode:Ie},q={};function Q(m){var u=m.charCodeAt(0),g=void 0;return u<16?g="%0"+u.toString(16).toUpperCase():u<128?g="%"+u.toString(16).toUpperCase():u<2048?g="%"+(u>>6|192).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase():g="%"+(u>>12|224).toString(16).toUpperCase()+"%"+(u>>6&63|128).toString(16).toUpperCase()+"%"+(u&63|128).toString(16).toUpperCase(),g}function re(m){for(var u="",g=0,T=m.length;g<T;){var O=parseInt(m.substr(g+1,2),16);if(O<128)u+=String.fromCharCode(O),g+=3;else if(O>=194&&O<224){if(T-g>=6){var W=parseInt(m.substr(g+4,2),16);u+=String.fromCharCode((O&31)<<6|W&63);}else u+=m.substr(g,6);g+=6;}else if(O>=224){if(T-g>=9){var Y=parseInt(m.substr(g+4,2),16),me=parseInt(m.substr(g+7,2),16);u+=String.fromCharCode((O&15)<<12|(Y&63)<<6|me&63);}else u+=m.substr(g,9);g+=9;}else u+=m.substr(g,3),g+=3;}return u}function L(m,u){function g(T){var O=re(T);return O.match(u.UNRESERVED)?O:T}return m.scheme&&(m.scheme=String(m.scheme).replace(u.PCT_ENCODED,g).toLowerCase().replace(u.NOT_SCHEME,"")),m.userinfo!==void 0&&(m.userinfo=String(m.userinfo).replace(u.PCT_ENCODED,g).replace(u.NOT_USERINFO,Q).replace(u.PCT_ENCODED,o)),m.host!==void 0&&(m.host=String(m.host).replace(u.PCT_ENCODED,g).toLowerCase().replace(u.NOT_HOST,Q).replace(u.PCT_ENCODED,o)),m.path!==void 0&&(m.path=String(m.path).replace(u.PCT_ENCODED,g).replace(m.scheme?u.NOT_PATH:u.NOT_PATH_NOSCHEME,Q).replace(u.PCT_ENCODED,o)),m.query!==void 0&&(m.query=String(m.query).replace(u.PCT_ENCODED,g).replace(u.NOT_QUERY,Q).replace(u.PCT_ENCODED,o)),m.fragment!==void 0&&(m.fragment=String(m.fragment).replace(u.PCT_ENCODED,g).replace(u.NOT_FRAGMENT,Q).replace(u.PCT_ENCODED,o)),m}function V(m){return m.replace(/^0*(.*)/,"$1")||"0"}function oe(m,u){var g=m.match(u.IPV4ADDRESS)||[],T=b(g,2),O=T[1];return O?O.split(".").map(V).join("."):m}function he(m,u){var g=m.match(u.IPV6ADDRESS)||[],T=b(g,3),O=T[1],W=T[2];if(O){for(var Y=O.toLowerCase().split("::").reverse(),me=b(Y,2),we=me[0],De=me[1],fe=De?De.split(":").map(V):[],Ee=we.split(":").map(V),Ne=u.IPV4ADDRESS.test(Ee[Ee.length-1]),se=Ne?7:8,xe=Ee.length-se,Fe=Array(se),$e=0;$e<se;++$e)Fe[$e]=fe[$e]||Ee[xe+$e]||"";Ne&&(Fe[se-1]=oe(Fe[se-1],u));var Er=Fe.reduce(function(rr,pr,Tr){if(!pr||pr==="0"){var Pr=rr[rr.length-1];Pr&&Pr.index+Pr.length===Tr?Pr.length++:rr.push({index:Tr,length:1});}return rr},[]),fr=Er.sort(function(rr,pr){return pr.length-rr.length})[0],mr=void 0;if(fr&&fr.length>1){var Nr=Fe.slice(0,fr.index),Or=Fe.slice(fr.index+fr.length);mr=Nr.join(":")+"::"+Or.join(":");}else mr=Fe.join(":");return W&&(mr+="%"+W),mr}else return m}var ue=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Re="".match(/(){0}/)[1]===void 0;function ge(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g={},T=u.iri!==false?p:f;u.reference==="suffix"&&(m=(u.scheme?u.scheme+":":"")+"//"+m);var O=m.match(ue);if(O){Re?(g.scheme=O[1],g.userinfo=O[3],g.host=O[4],g.port=parseInt(O[5],10),g.path=O[6]||"",g.query=O[7],g.fragment=O[8],isNaN(g.port)&&(g.port=O[5])):(g.scheme=O[1]||void 0,g.userinfo=m.indexOf("@")!==-1?O[3]:void 0,g.host=m.indexOf("//")!==-1?O[4]:void 0,g.port=parseInt(O[5],10),g.path=O[6]||"",g.query=m.indexOf("?")!==-1?O[7]:void 0,g.fragment=m.indexOf("#")!==-1?O[8]:void 0,isNaN(g.port)&&(g.port=m.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?O[4]:void 0)),g.host&&(g.host=he(oe(g.host,T),T)),g.scheme===void 0&&g.userinfo===void 0&&g.host===void 0&&g.port===void 0&&!g.path&&g.query===void 0?g.reference="same-document":g.scheme===void 0?g.reference="relative":g.fragment===void 0?g.reference="absolute":g.reference="uri",u.reference&&u.reference!=="suffix"&&u.reference!==g.reference&&(g.error=g.error||"URI is not a "+u.reference+" reference.");var W=q[(u.scheme||g.scheme||"").toLowerCase()];if(!u.unicodeSupport&&(!W||!W.unicodeSupport)){if(g.host&&(u.domainHost||W&&W.domainHost))try{g.host=w.toASCII(g.host.replace(T.PCT_ENCODED,re).toLowerCase());}catch(Y){g.error=g.error||"Host's domain name can not be converted to ASCII via punycode: "+Y;}L(g,f);}else L(g,T);W&&W.parse&&W.parse(g,u);}else g.error=g.error||"URI can not be parsed.";return g}function ye(m,u){var g=u.iri!==false?p:f,T=[];return m.userinfo!==void 0&&(T.push(m.userinfo),T.push("@")),m.host!==void 0&&T.push(he(oe(String(m.host),g),g).replace(g.IPV6ADDRESS,function(O,W,Y){return "["+W+(Y?"%25"+Y:"")+"]"})),(typeof m.port=="number"||typeof m.port=="string")&&(T.push(":"),T.push(String(m.port))),T.length?T.join(""):void 0}var ze=/^\.\.?\//,Te=/^\/\.(\/|$)/,sr=/^\/\.\.(\/|$)/,Ve=/^\/?(?:.|\n)*?(?=\/|$)/;function ke(m){for(var u=[];m.length;)if(m.match(ze))m=m.replace(ze,"");else if(m.match(Te))m=m.replace(Te,"/");else if(m.match(sr))m=m.replace(sr,"/"),u.pop();else if(m==="."||m==="..")m="";else {var g=m.match(Ve);if(g){var T=g[0];m=m.slice(T.length),u.push(T);}else throw new Error("Unexpected dot segment condition")}return u.join("")}function Ae(m){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},g=u.iri?p:f,T=[],O=q[(u.scheme||m.scheme||"").toLowerCase()];if(O&&O.serialize&&O.serialize(m,u),m.host&&!g.IPV6ADDRESS.test(m.host)){if(u.domainHost||O&&O.domainHost)try{m.host=u.iri?w.toUnicode(m.host):w.toASCII(m.host.replace(g.PCT_ENCODED,re).toLowerCase());}catch(me){m.error=m.error||"Host's domain name can not be converted to "+(u.iri?"Unicode":"ASCII")+" via punycode: "+me;}}L(m,g),u.reference!=="suffix"&&m.scheme&&(T.push(m.scheme),T.push(":"));var W=ye(m,u);if(W!==void 0&&(u.reference!=="suffix"&&T.push("//"),T.push(W),m.path&&m.path.charAt(0)!=="/"&&T.push("/")),m.path!==void 0){var Y=m.path;!u.absolutePath&&(!O||!O.absolutePath)&&(Y=ke(Y)),W===void 0&&(Y=Y.replace(/^\/\//,"/%2F")),T.push(Y);}return m.query!==void 0&&(T.push("?"),T.push(m.query)),m.fragment!==void 0&&(T.push("#"),T.push(m.fragment)),T.join("")}function Je(m,u){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},T=arguments[3],O={};return T||(m=ge(Ae(m,g),g),u=ge(Ae(u,g),g)),g=g||{},!g.tolerant&&u.scheme?(O.scheme=u.scheme,O.userinfo=u.userinfo,O.host=u.host,O.port=u.port,O.path=ke(u.path||""),O.query=u.query):(u.userinfo!==void 0||u.host!==void 0||u.port!==void 0?(O.userinfo=u.userinfo,O.host=u.host,O.port=u.port,O.path=ke(u.path||""),O.query=u.query):(u.path?(u.path.charAt(0)==="/"?O.path=ke(u.path):((m.userinfo!==void 0||m.host!==void 0||m.port!==void 0)&&!m.path?O.path="/"+u.path:m.path?O.path=m.path.slice(0,m.path.lastIndexOf("/")+1)+u.path:O.path=u.path,O.path=ke(O.path)),O.query=u.query):(O.path=m.path,u.query!==void 0?O.query=u.query:O.query=m.query),O.userinfo=m.userinfo,O.host=m.host,O.port=m.port),O.scheme=m.scheme),O.fragment=u.fragment,O}function mt(m,u,g){var T=l({scheme:"null"},g);return Ae(Je(ge(m,T),ge(u,T),T,true),T)}function Ha(m,u){return typeof m=="string"?m=Ae(ge(m,u),u):n(m)==="object"&&(m=ge(Ae(m,u),u)),m}function Va(m,u,g){return typeof m=="string"?m=Ae(ge(m,g),g):n(m)==="object"&&(m=Ae(m,g)),typeof u=="string"?u=Ae(ge(u,g),g):n(u)==="object"&&(u=Ae(u,g)),m===u}function Pc(m,u){return m&&m.toString().replace(!u||!u.iri?f.ESCAPE:p.ESCAPE,Q)}function _r(m,u){return m&&m.toString().replace(!u||!u.iri?f.PCT_ENCODED:p.PCT_ENCODED,re)}var Hr={scheme:"http",domainHost:true,parse:function(u,g){return u.host||(u.error=u.error||"HTTP URIs must have a host."),u},serialize:function(u,g){var T=String(u.scheme).toLowerCase()==="https";return (u.port===(T?443:80)||u.port==="")&&(u.port=void 0),u.path||(u.path="/"),u}},ei={scheme:"https",domainHost:Hr.domainHost,parse:Hr.parse,serialize:Hr.serialize};function ri(m){return typeof m.secure=="boolean"?m.secure:String(m.scheme).toLowerCase()==="wss"}var Vr={scheme:"ws",domainHost:true,parse:function(u,g){var T=u;return T.secure=ri(T),T.resourceName=(T.path||"/")+(T.query?"?"+T.query:""),T.path=void 0,T.query=void 0,T},serialize:function(u,g){if((u.port===(ri(u)?443:80)||u.port==="")&&(u.port=void 0),typeof u.secure=="boolean"&&(u.scheme=u.secure?"wss":"ws",u.secure=void 0),u.resourceName){var T=u.resourceName.split("?"),O=b(T,2),W=O[0],Y=O[1];u.path=W&&W!=="/"?W:void 0,u.query=Y,u.resourceName=void 0;}return u.fragment=void 0,u}},ti={scheme:"wss",domainHost:Vr.domainHost,parse:Vr.parse,serialize:Vr.serialize},bc={},ai="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",hr="[0-9A-Fa-f]",Sc=r(r("%[EFef]"+hr+"%"+hr+hr+"%"+hr+hr)+"|"+r("%[89A-Fa-f]"+hr+"%"+hr+hr)+"|"+r("%"+hr+hr)),Ec="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",wc="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Rc=a(wc,'[\\"\\\\]'),xc="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",$c=new RegExp(ai,"g"),Dr=new RegExp(Sc,"g"),Oc=new RegExp(a("[^]",Ec,"[\\.]",'[\\"]',Rc),"g"),si=new RegExp(a("[^]",ai,xc),"g"),Tc=si;function Ba(m){var u=re(m);return u.match($c)?u:m}var ni={scheme:"mailto",parse:function(u,g){var T=u,O=T.to=T.path?T.path.split(","):[];if(T.path=void 0,T.query){for(var W=false,Y={},me=T.query.split("&"),we=0,De=me.length;we<De;++we){var fe=me[we].split("=");switch(fe[0]){case "to":for(var Ee=fe[1].split(","),Ne=0,se=Ee.length;Ne<se;++Ne)O.push(Ee[Ne]);break;case "subject":T.subject=_r(fe[1],g);break;case "body":T.body=_r(fe[1],g);break;default:W=true,Y[_r(fe[0],g)]=_r(fe[1],g);break}}W&&(T.headers=Y);}T.query=void 0;for(var xe=0,Fe=O.length;xe<Fe;++xe){var $e=O[xe].split("@");if($e[0]=_r($e[0]),g.unicodeSupport)$e[1]=_r($e[1],g).toLowerCase();else try{$e[1]=w.toASCII(_r($e[1],g).toLowerCase());}catch(Er){T.error=T.error||"Email address's domain name can not be converted to ASCII via punycode: "+Er;}O[xe]=$e.join("@");}return T},serialize:function(u,g){var T=u,O=i(u.to);if(O){for(var W=0,Y=O.length;W<Y;++W){var me=String(O[W]),we=me.lastIndexOf("@"),De=me.slice(0,we).replace(Dr,Ba).replace(Dr,o).replace(Oc,Q),fe=me.slice(we+1);try{fe=g.iri?w.toUnicode(fe):w.toASCII(_r(fe,g).toLowerCase());}catch(xe){T.error=T.error||"Email address's domain name can not be converted to "+(g.iri?"Unicode":"ASCII")+" via punycode: "+xe;}O[W]=De+"@"+fe;}T.path=O.join(",");}var Ee=u.headers=u.headers||{};u.subject&&(Ee.subject=u.subject),u.body&&(Ee.body=u.body);var Ne=[];for(var se in Ee)Ee[se]!==bc[se]&&Ne.push(se.replace(Dr,Ba).replace(Dr,o).replace(si,Q)+"="+Ee[se].replace(Dr,Ba).replace(Dr,o).replace(Tc,Q));return Ne.length&&(T.query=Ne.join("&")),T}},kc=/^([^\:]+)\:(.*)/,ii={scheme:"urn",parse:function(u,g){var T=u.path&&u.path.match(kc),O=u;if(T){var W=g.scheme||O.scheme||"urn",Y=T[1].toLowerCase(),me=T[2],we=W+":"+(g.nid||Y),De=q[we];O.nid=Y,O.nss=me,O.path=void 0,De&&(O=De.parse(O,g));}else O.error=O.error||"URN can not be parsed.";return O},serialize:function(u,g){var T=g.scheme||u.scheme||"urn",O=u.nid,W=T+":"+(g.nid||O),Y=q[W];Y&&(u=Y.serialize(u,g));var me=u,we=u.nss;return me.path=(O||g.nid)+":"+we,me}},Cc=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,oi={scheme:"urn:uuid",parse:function(u,g){var T=u;return T.uuid=T.nss,T.nss=void 0,!g.tolerant&&(!T.uuid||!T.uuid.match(Cc))&&(T.error=T.error||"UUID is not valid."),T},serialize:function(u,g){var T=u;return T.nss=(u.uuid||"").toLowerCase(),T}};q[Hr.scheme]=Hr,q[ei.scheme]=ei,q[Vr.scheme]=Vr,q[ti.scheme]=ti,q[ni.scheme]=ni,q[ii.scheme]=ii,q[oi.scheme]=oi,t.SCHEMES=q,t.pctEncChar=Q,t.pctDecChars=re,t.parse=ge,t.removeDotSegments=ke,t.serialize=Ae,t.resolveComponents=Je,t.resolve=mt,t.normalize=Ha,t.equal=Va,t.escapeComponent=Pc,t.unescapeComponent=_r,Object.defineProperty(t,"__esModule",{value:true});});}(Ur,Ur.exports)),Ur.exports}var Jt,Hs;function Kt(){return Hs||(Hs=1,Jt=function s(e,t){if(e===t)return  true;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return  false;var a,r,n;if(Array.isArray(e)){if(a=e.length,a!=t.length)return  false;for(r=a;r--!==0;)if(!s(e[r],t[r]))return  false;return  true}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(n=Object.keys(e),a=n.length,a!==Object.keys(t).length)return  false;for(r=a;r--!==0;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return  false;for(r=a;r--!==0;){var o=n[r];if(!s(e[o],t[o]))return  false}return  true}return e!==e&&t!==t}),Jt}var Gt,Vs;function Bl(){return Vs||(Vs=1,Gt=function(e){for(var t=0,a=e.length,r=0,n;r<a;)t++,n=e.charCodeAt(r++),n>=55296&&n<=56319&&r<a&&(n=e.charCodeAt(r),(n&64512)==56320&&r++);return t}),Gt}var Wt,Bs;function Ar(){if(Bs)return Wt;Bs=1,Wt={copy:s,checkDataType:e,checkDataTypes:t,coerceToTypes:r,toHash:n,getProperty:l,escapeQuotes:d,equal:Kt(),ucs2length:Bl(),varOccurences:f,varReplace:p,schemaHasRules:b,schemaHasRulesExcept:c,schemaUnknownRules:h,toQuotedString:_,getPathExpr:v,getPath:S,getData:P,unescapeFragment:C,unescapeJsonPointer:N,escapeFragment:A,escapeJsonPointer:D};function s(E,$){$=$||{};for(var F in E)$[F]=E[F];return $}function e(E,$,F,M){var z=M?" !== ":" === ",G=M?" || ":" && ",ne=M?"!":"",X=M?"":"!";switch(E){case "null":return $+z+"null";case "array":return ne+"Array.isArray("+$+")";case "object":return "("+ne+$+G+"typeof "+$+z+'"object"'+G+X+"Array.isArray("+$+"))";case "integer":return "(typeof "+$+z+'"number"'+G+X+"("+$+" % 1)"+G+$+z+$+(F?G+ne+"isFinite("+$+")":"")+")";case "number":return "(typeof "+$+z+'"'+E+'"'+(F?G+ne+"isFinite("+$+")":"")+")";default:return "typeof "+$+z+'"'+E+'"'}}function t(E,$,F){switch(E.length){case 1:return e(E[0],$,F,true);default:var M="",z=n(E);z.array&&z.object&&(M=z.null?"(":"(!"+$+" || ",M+="typeof "+$+' !== "object")',delete z.null,delete z.array,delete z.object),z.number&&delete z.integer;for(var G in z)M+=(M?" && ":"")+e(G,$,F,true);return M}}var a=n(["string","number","integer","boolean","null"]);function r(E,$){if(Array.isArray($)){for(var F=[],M=0;M<$.length;M++){var z=$[M];(a[z]||E==="array"&&z==="array")&&(F[F.length]=z);}if(F.length)return F}else {if(a[$])return [$];if(E==="array"&&$==="array")return ["array"]}}function n(E){for(var $={},F=0;F<E.length;F++)$[E[F]]=true;return $}var o=/^[a-z$_][a-z$_0-9]*$/i,i=/'|\\/g;function l(E){return typeof E=="number"?"["+E+"]":o.test(E)?"."+E:"['"+d(E)+"']"}function d(E){return E.replace(i,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function f(E,$){$+="[^0-9]";var F=E.match(new RegExp($,"g"));return F?F.length:0}function p(E,$,F){return $+="([^0-9])",F=F.replace(/\$/g,"$$$$"),E.replace(new RegExp($,"g"),F+"$1")}function b(E,$){if(typeof E=="boolean")return !E;for(var F in E)if($[F])return  true}function c(E,$,F){if(typeof E=="boolean")return !E&&F!="not";for(var M in E)if(M!=F&&$[M])return  true}function h(E,$){if(typeof E!="boolean"){for(var F in E)if(!$[F])return F}}function _(E){return "'"+d(E)+"'"}function v(E,$,F,M){var z=F?"'/' + "+$+(M?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):M?"'[' + "+$+" + ']'":"'[\\'' + "+$+" + '\\']'";return R(E,z)}function S(E,$,F){var M=_(F?"/"+D($):l($));return R(E,M)}var j=/^\/(?:[^~]|~0|~1)*$/,I=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function P(E,$,F){var M,z,G,ne;if(E==="")return "rootData";if(E[0]=="/"){if(!j.test(E))throw new Error("Invalid JSON-pointer: "+E);z=E,G="rootData";}else {if(ne=E.match(I),!ne)throw new Error("Invalid JSON-pointer: "+E);if(M=+ne[1],z=ne[2],z=="#"){if(M>=$)throw new Error("Cannot access property/index "+M+" levels up, current level is "+$);return F[$-M]}if(M>$)throw new Error("Cannot access data "+M+" levels up, current level is "+$);if(G="data"+($-M||""),!z)return G}for(var X=G,le=z.split("/"),te=0;te<le.length;te++){var ae=le[te];ae&&(G+=l(N(ae)),X+=" && "+G);}return X}function R(E,$){return E=='""'?$:(E+" + "+$).replace(/([^\\])' \+ '/g,"$1")}function C(E){return N(decodeURIComponent(E))}function A(E){return encodeURIComponent(D(E))}function D(E){return E.replace(/~/g,"~0").replace(/\//g,"~1")}function N(E){return E.replace(/~1/g,"/").replace(/~0/g,"~")}return Wt}var Yt,Qs;function Js(){if(Qs)return Yt;Qs=1;var s=Ar();Yt=e;function e(t){s.copy(t,this);}return Yt}var Xt={exports:{}},Ks;function Ql(){if(Ks)return Xt.exports;Ks=1;var s=Xt.exports=function(a,r,n){typeof r=="function"&&(n=r,r={}),n=r.cb||n;var o=typeof n=="function"?n:n.pre||function(){},i=n.post||function(){};e(r,o,i,a,"",a);};s.keywords={additionalItems:true,items:true,contains:true,additionalProperties:true,propertyNames:true,not:true},s.arrayKeywords={items:true,allOf:true,anyOf:true,oneOf:true},s.propsKeywords={definitions:true,properties:true,patternProperties:true,dependencies:true},s.skipKeywords={default:true,enum:true,const:true,required:true,maximum:true,minimum:true,exclusiveMaximum:true,exclusiveMinimum:true,multipleOf:true,maxLength:true,minLength:true,pattern:true,format:true,maxItems:true,minItems:true,uniqueItems:true,maxProperties:true,minProperties:true};function e(a,r,n,o,i,l,d,f,p,b){if(o&&typeof o=="object"&&!Array.isArray(o)){r(o,i,l,d,f,p,b);for(var c in o){var h=o[c];if(Array.isArray(h)){if(c in s.arrayKeywords)for(var _=0;_<h.length;_++)e(a,r,n,h[_],i+"/"+c+"/"+_,l,i,c,o,_);}else if(c in s.propsKeywords){if(h&&typeof h=="object")for(var v in h)e(a,r,n,h[v],i+"/"+c+"/"+t(v),l,i,c,o,v);}else (c in s.keywords||a.allKeys&&!(c in s.skipKeywords))&&e(a,r,n,h,i+"/"+c,l,i,c,o);}n(o,i,l,d,f,p,b);}}function t(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}return Xt.exports}var ea,Gs;function ra(){if(Gs)return ea;Gs=1;var s=Vl(),e=Kt(),t=Ar(),a=Js(),r=Ql();ea=n,n.normalizeId=S,n.fullPath=h,n.url=j,n.ids=I,n.inlineRef=p,n.schema=o;function n(P,R,C){var A=this._refs[C];if(typeof A=="string")if(this._refs[A])A=this._refs[A];else return n.call(this,P,R,A);if(A=A||this._schemas[C],A instanceof a)return p(A.schema,this._opts.inlineRefs)?A.schema:A.validate||this._compile(A);var D=o.call(this,R,C),N,E,$;return D&&(N=D.schema,R=D.root,$=D.baseId),N instanceof a?E=N.validate||P.call(this,N.schema,R,void 0,$):N!==void 0&&(E=p(N,this._opts.inlineRefs)?N:P.call(this,N,R,void 0,$)),E}function o(P,R){var C=s.parse(R),A=_(C),D=h(this._getId(P.schema));if(Object.keys(P.schema).length===0||A!==D){var N=S(A),E=this._refs[N];if(typeof E=="string")return i.call(this,P,E,C);if(E instanceof a)E.validate||this._compile(E),P=E;else if(E=this._schemas[N],E instanceof a){if(E.validate||this._compile(E),N==S(R))return {schema:E,root:P,baseId:D};P=E;}else return;if(!P.schema)return;D=h(this._getId(P.schema));}return d.call(this,C,D,P.schema,P)}function i(P,R,C){var A=o.call(this,P,R);if(A){var D=A.schema,N=A.baseId;P=A.root;var E=this._getId(D);return E&&(N=j(N,E)),d.call(this,C,N,D,P)}}var l=t.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function d(P,R,C,A){if(P.fragment=P.fragment||"",P.fragment.slice(0,1)=="/"){for(var D=P.fragment.split("/"),N=1;N<D.length;N++){var E=D[N];if(E){if(E=t.unescapeFragment(E),C=C[E],C===void 0)break;var $;if(!l[E]&&($=this._getId(C),$&&(R=j(R,$)),C.$ref)){var F=j(R,C.$ref),M=o.call(this,A,F);M&&(C=M.schema,A=M.root,R=M.baseId);}}}if(C!==void 0&&C!==A.schema)return {schema:C,root:A,baseId:R}}}var f=t.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function p(P,R){if(R===false)return  false;if(R===void 0||R===true)return b(P);if(R)return c(P)<=R}function b(P){var R;if(Array.isArray(P)){for(var C=0;C<P.length;C++)if(R=P[C],typeof R=="object"&&!b(R))return  false}else for(var A in P)if(A=="$ref"||(R=P[A],typeof R=="object"&&!b(R)))return  false;return  true}function c(P){var R=0,C;if(Array.isArray(P)){for(var A=0;A<P.length;A++)if(C=P[A],typeof C=="object"&&(R+=c(C)),R==1/0)return 1/0}else for(var D in P){if(D=="$ref")return 1/0;if(f[D])R++;else if(C=P[D],typeof C=="object"&&(R+=c(C)+1),R==1/0)return 1/0}return R}function h(P,R){R!==false&&(P=S(P));var C=s.parse(P);return _(C)}function _(P){return s.serialize(P).split("#")[0]+"#"}var v=/#\/?$/;function S(P){return P?P.replace(v,""):""}function j(P,R){return R=S(R),s.resolve(P,R)}function I(P){var R=S(this._getId(P)),C={"":R},A={"":h(R,false)},D={},N=this;return r(P,{allKeys:true},function(E,$,F,M,z,G,ne){if($!==""){var X=N._getId(E),le=C[M],te=A[M]+"/"+z;if(ne!==void 0&&(te+="/"+(typeof ne=="number"?ne:t.escapeFragment(ne))),typeof X=="string"){X=le=S(le?s.resolve(le,X):X);var ae=N._refs[X];if(typeof ae=="string"&&(ae=N._refs[ae]),ae&&ae.schema){if(!e(E,ae.schema))throw new Error('id "'+X+'" resolves to more than one schema')}else if(X!=S(te))if(X[0]=="#"){if(D[X]&&!e(E,D[X]))throw new Error('id "'+X+'" resolves to more than one schema');D[X]=E;}else N._refs[X]=te;}C[$]=le,A[$]=te;}}),D}return ea}var ta,Ws;function aa(){if(Ws)return ta;Ws=1;var s=ra();ta={Validation:a(e),MissingRef:a(t)};function e(r){this.message="validation failed",this.errors=r,this.ajv=this.validation=true;}t.message=function(r,n){return "can't resolve reference "+n+" from id "+r};function t(r,n,o){this.message=o||t.message(r,n),this.missingRef=s.url(r,n),this.missingSchema=s.normalizeId(s.fullPath(this.missingRef));}function a(r){return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}return ta}var sa,Ys;function Xs(){return Ys||(Ys=1,sa=function(s,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var t=typeof e.cycles=="boolean"?e.cycles:false,a=e.cmp&&function(n){return function(o){return function(i,l){var d={key:i,value:o[i]},f={key:l,value:o[l]};return n(d,f)}}}(e.cmp),r=[];return function n(o){if(o&&o.toJSON&&typeof o.toJSON=="function"&&(o=o.toJSON()),o!==void 0){if(typeof o=="number")return isFinite(o)?""+o:"null";if(typeof o!="object")return JSON.stringify(o);var i,l;if(Array.isArray(o)){for(l="[",i=0;i<o.length;i++)i&&(l+=","),l+=n(o[i])||"null";return l+"]"}if(o===null)return "null";if(r.indexOf(o)!==-1){if(t)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var d=r.push(o)-1,f=Object.keys(o).sort(a&&a(o));for(l="",i=0;i<f.length;i++){var p=f[i],b=n(o[p]);b&&(l&&(l+=","),l+=JSON.stringify(p)+":"+b);}return r.splice(d,1),"{"+l+"}"}}(s)}),sa}var na,en;function rn(){return en||(en=1,na=function(e,t,a){var r="",n=e.schema.$async===true,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),i=e.self._getId(e.schema);if(e.opts.strictKeywords){var l=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(l){var d="unknown keyword: "+l;if(e.opts.strictKeywords==="log")e.logger.warn(d);else throw new Error(d)}}if(e.isTop&&(r+=" var validate = ",n&&(e.async=true,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",i&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" "+("/*# sourceURL="+i+" */")+" ")),typeof e.schema=="boolean"||!(o||e.schema.$ref)){var t="false schema",f=e.level,p=e.dataLevel,b=e.schema[t],c=e.schemaPath+e.util.getProperty(t),h=e.errSchemaPath+"/"+t,R=!e.opts.allErrors,D,_="data"+(p||""),P="valid"+f;if(e.schema===false){e.isTop?R=true:r+=" var "+P+" = false; ";var v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(D||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: {} ",e.opts.messages!==false&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&R?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";}else e.isTop?n?r+=" return data; ":r+=" validate.errors = null; return true; ":r+=" var "+P+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var j=e.isTop,f=e.level=0,p=e.dataLevel=0,_="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],e.schema.default!==void 0&&e.opts.useDefaults&&e.opts.strictDefaults){var I="default is ignored in the schema root";if(e.opts.strictDefaults==="log")e.logger.warn(I);else throw new Error(I)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; ";}else {var f=e.level,p=e.dataLevel,_="data"+(p||"");if(i&&(e.baseId=e.resolve.url(e.baseId,i)),n&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+f+" = errors;";}var P="valid"+f,R=!e.opts.allErrors,C="",A="",D,N=e.schema.type,E=Array.isArray(N);if(N&&e.opts.nullable&&e.schema.nullable===true&&(E?N.indexOf("null")==-1&&(N=N.concat("null")):N!="null"&&(N=[N,"null"],E=true)),E&&N.length==1&&(N=N[0],E=false),e.schema.$ref&&o){if(e.opts.extendRefs=="fail")throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');e.opts.extendRefs!==true&&(o=false,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'));}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),N){if(e.opts.coerceTypes)var $=e.util.coerceToTypes(e.opts.coerceTypes,N);var F=e.RULES.types[N];if($||E||F===true||F&&!Te(F)){var c=e.schemaPath+".type",h=e.errSchemaPath+"/type",c=e.schemaPath+".type",h=e.errSchemaPath+"/type",M=E?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[M](N,_,e.opts.strictNumbers,true)+") { ",$){var z="dataType"+f,G="coerced"+f;r+=" var "+z+" = typeof "+_+"; var "+G+" = undefined; ",e.opts.coerceTypes=="array"&&(r+=" if ("+z+" == 'object' && Array.isArray("+_+") && "+_+".length == 1) { "+_+" = "+_+"[0]; "+z+" = typeof "+_+"; if ("+e.util.checkDataType(e.schema.type,_,e.opts.strictNumbers)+") "+G+" = "+_+"; } "),r+=" if ("+G+" !== undefined) ; ";var ne=$;if(ne)for(var X,le=-1,te=ne.length-1;le<te;)X=ne[le+=1],X=="string"?r+=" else if ("+z+" == 'number' || "+z+" == 'boolean') "+G+" = '' + "+_+"; else if ("+_+" === null) "+G+" = ''; ":X=="number"||X=="integer"?(r+=" else if ("+z+" == 'boolean' || "+_+" === null || ("+z+" == 'string' && "+_+" && "+_+" == +"+_+" ",X=="integer"&&(r+=" && !("+_+" % 1)"),r+=")) "+G+" = +"+_+"; "):X=="boolean"?r+=" else if ("+_+" === 'false' || "+_+" === 0 || "+_+" === null) "+G+" = false; else if ("+_+" === 'true' || "+_+" === 1) "+G+" = true; ":X=="null"?r+=" else if ("+_+" === '' || "+_+" === 0 || "+_+" === false) "+G+" = null; ":e.opts.coerceTypes=="array"&&X=="array"&&(r+=" else if ("+z+" == 'string' || "+z+" == 'number' || "+z+" == 'boolean' || "+_+" == null) "+G+" = ["+_+"]; ");r+=" else {   ";var v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(D||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",E?r+=""+N.join(","):r+=""+N,r+="' } ",e.opts.messages!==false&&(r+=" , message: 'should be ",E?r+=""+N.join(","):r+=""+N,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&R?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } if ("+G+" !== undefined) {  ";var ae=p?"data"+(p-1||""):"parentData",He=p?e.dataPathArr[p]:"parentDataProperty";r+=" "+_+" = "+G+"; ",p||(r+="if ("+ae+" !== undefined)"),r+=" "+ae+"["+He+"] = "+G+"; } ";}else {var v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(D||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",E?r+=""+N.join(","):r+=""+N,r+="' } ",e.opts.messages!==false&&(r+=" , message: 'should be ",E?r+=""+N.join(","):r+=""+N,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&R?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";}r+=" } ";}}if(e.schema.$ref&&!o)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",R&&(r+=" } if (errors === ",j?r+="0":r+="errs_"+f,r+=") { ",A+="}");else {var Me=e.RULES;if(Me){for(var F,Le=-1,Ie=Me.length-1;Le<Ie;)if(F=Me[Le+=1],Te(F)){if(F.type&&(r+=" if ("+e.util.checkDataType(F.type,_,e.opts.strictNumbers)+") { "),e.opts.useDefaults){if(F.type=="object"&&e.schema.properties){var b=e.schema.properties,er=Object.keys(b),w=er;if(w)for(var q,Q=-1,re=w.length-1;Q<re;){q=w[Q+=1];var L=b[q];if(L.default!==void 0){var V=_+e.util.getProperty(q);if(e.compositeRule){if(e.opts.strictDefaults){var I="default is ignored for: "+V;if(e.opts.strictDefaults==="log")e.logger.warn(I);else throw new Error(I)}}else r+=" if ("+V+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+V+" === null || "+V+" === '' "),r+=" ) "+V+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(L.default)+" ":r+=" "+JSON.stringify(L.default)+" ",r+="; ";}}}else if(F.type=="array"&&Array.isArray(e.schema.items)){var oe=e.schema.items;if(oe){for(var L,le=-1,he=oe.length-1;le<he;)if(L=oe[le+=1],L.default!==void 0){var V=_+"["+le+"]";if(e.compositeRule){if(e.opts.strictDefaults){var I="default is ignored for: "+V;if(e.opts.strictDefaults==="log")e.logger.warn(I);else throw new Error(I)}}else r+=" if ("+V+" === undefined ",e.opts.useDefaults=="empty"&&(r+=" || "+V+" === null || "+V+" === '' "),r+=" ) "+V+" = ",e.opts.useDefaults=="shared"?r+=" "+e.useDefault(L.default)+" ":r+=" "+JSON.stringify(L.default)+" ",r+="; ";}}}}var ue=F.rules;if(ue){for(var Re,ge=-1,ye=ue.length-1;ge<ye;)if(Re=ue[ge+=1],sr(Re)){var ze=Re.code(e,Re.keyword,F.type);ze&&(r+=" "+ze+" ",R&&(C+="}"));}}if(R&&(r+=" "+C+" ",C=""),F.type&&(r+=" } ",N&&N===F.type&&!$)){r+=" else { ";var c=e.schemaPath+".type",h=e.errSchemaPath+"/type",v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(D||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",E?r+=""+N.join(","):r+=""+N,r+="' } ",e.opts.messages!==false&&(r+=" , message: 'should be ",E?r+=""+N.join(","):r+=""+N,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+_+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&R?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ";}R&&(r+=" if (errors === ",j?r+="0":r+="errs_"+f,r+=") { ",A+="}");}}}R&&(r+=" "+A+" "),j?(n?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+P+" = errors === errs_"+f+";";function Te(ke){for(var Ae=ke.rules,Je=0;Je<Ae.length;Je++)if(sr(Ae[Je]))return  true}function sr(ke){return e.schema[ke.keyword]!==void 0||ke.implements&&Ve(ke)}function Ve(ke){for(var Ae=ke.implements,Je=0;Je<Ae.length;Je++)if(e.schema[Ae[Je]]!==void 0)return  true}return r}),na}var ia,tn;function Jl(){if(tn)return ia;tn=1;var s=ra(),e=Ar(),t=aa(),a=Xs(),r=rn(),n=e.ucs2length,o=Kt(),i=t.Validation;ia=l;function l(S,j,I,P){var R=this,C=this._opts,A=[void 0],D={},N=[],E={},$=[],F={},M=[];j=j||{schema:S,refVal:A,refs:D};var z=d.call(this,S,j,P),G=this._compilations[z.index];if(z.compiling)return G.callValidate=ae;var ne=this._formats,X=this.RULES;try{var le=He(S,j,I,P);G.validate=le;var te=G.callValidate;return te&&(te.schema=le.schema,te.errors=null,te.refs=le.refs,te.refVal=le.refVal,te.root=le.root,te.$async=le.$async,C.sourceCode&&(te.source=le.source)),le}finally{f.call(this,S,j,P);}function ae(){var L=G.validate,V=L.apply(this,arguments);return ae.errors=L.errors,V}function He(L,V,oe,he){var ue=!V||V&&V.schema==L;if(V.schema!=j.schema)return l.call(R,L,V,oe,he);var Re=L.$async===true,ge=r({isTop:true,schema:L,isRoot:ue,baseId:he,root:V,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:t.MissingRef,RULES:X,validate:r,util:e,resolve:s,resolveRef:Me,usePattern:q,useDefault:Q,useCustomRule:re,opts:C,formats:ne,logger:R.logger,self:R});ge=v(A,h)+v(N,b)+v($,c)+v(M,_)+ge,C.processCode&&(ge=C.processCode(ge,L));var ye;try{var ze=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",ge);ye=ze(R,X,ne,j,A,$,M,o,n,i),A[0]=ye;}catch(Te){throw R.logger.error("Error compiling schema, function code:",ge),Te}return ye.schema=L,ye.errors=null,ye.refs=D,ye.refVal=A,ye.root=ue?ye:V,Re&&(ye.$async=true),C.sourceCode===true&&(ye.source={code:ge,patterns:N,defaults:$}),ye}function Me(L,V,oe){V=s.url(L,V);var he=D[V],ue,Re;if(he!==void 0)return ue=A[he],Re="refVal["+he+"]",w(ue,Re);if(!oe&&j.refs){var ge=j.refs[V];if(ge!==void 0)return ue=j.refVal[ge],Re=Le(V,ue),w(ue,Re)}Re=Le(V);var ye=s.call(R,He,j,V);if(ye===void 0){var ze=I&&I[V];ze&&(ye=s.inlineRef(ze,C.inlineRefs)?ze:l.call(R,ze,j,I,L));}if(ye===void 0)Ie(V);else return er(V,ye),w(ye,Re)}function Le(L,V){var oe=A.length;return A[oe]=V,D[L]=oe,"refVal"+oe}function Ie(L){delete D[L];}function er(L,V){var oe=D[L];A[oe]=V;}function w(L,V){return typeof L=="object"||typeof L=="boolean"?{code:V,schema:L,inline:true}:{code:V,$async:L&&!!L.$async}}function q(L){var V=E[L];return V===void 0&&(V=E[L]=N.length,N[V]=L),"pattern"+V}function Q(L){switch(typeof L){case "boolean":case "number":return ""+L;case "string":return e.toQuotedString(L);case "object":if(L===null)return "null";var V=a(L),oe=F[V];return oe===void 0&&(oe=F[V]=$.length,$[oe]=L),"default"+oe}}function re(L,V,oe,he){if(R._opts.validateSchema!==false){var ue=L.definition.dependencies;if(ue&&!ue.every(function(Ae){return Object.prototype.hasOwnProperty.call(oe,Ae)}))throw new Error("parent schema must have all required keywords: "+ue.join(","));var Re=L.definition.validateSchema;if(Re){var ge=Re(V);if(!ge){var ye="keyword schema is invalid: "+R.errorsText(Re.errors);if(R._opts.validateSchema=="log")R.logger.error(ye);else throw new Error(ye)}}}var ze=L.definition.compile,Te=L.definition.inline,sr=L.definition.macro,Ve;if(ze)Ve=ze.call(R,V,oe,he);else if(sr)Ve=sr.call(R,V,oe,he),C.validateSchema!==false&&R.validateSchema(Ve,true);else if(Te)Ve=Te.call(R,he,L.keyword,V,oe);else if(Ve=L.definition.validate,!Ve)return;if(Ve===void 0)throw new Error('custom keyword "'+L.keyword+'"failed to compile');var ke=M.length;return M[ke]=Ve,{code:"customRule"+ke,validate:Ve}}}function d(S,j,I){var P=p.call(this,S,j,I);return P>=0?{index:P,compiling:true}:(P=this._compilations.length,this._compilations[P]={schema:S,root:j,baseId:I},{index:P,compiling:false})}function f(S,j,I){var P=p.call(this,S,j,I);P>=0&&this._compilations.splice(P,1);}function p(S,j,I){for(var P=0;P<this._compilations.length;P++){var R=this._compilations[P];if(R.schema==S&&R.root==j&&R.baseId==I)return P}return  -1}function b(S,j){return "var pattern"+S+" = new RegExp("+e.toQuotedString(j[S])+");"}function c(S){return "var default"+S+" = defaults["+S+"];"}function h(S,j){return j[S]===void 0?"":"var refVal"+S+" = refVal["+S+"];"}function _(S){return "var customRule"+S+" = customRules["+S+"];"}function v(S,j){if(!S.length)return "";for(var I="",P=0;P<S.length;P++)I+=j(P,S);return I}return ia}var oa={exports:{}},an;function Kl(){if(an)return oa.exports;an=1;var s=oa.exports=function(){this._cache={};};return s.prototype.put=function(t,a){this._cache[t]=a;},s.prototype.get=function(t){return this._cache[t]},s.prototype.del=function(t){delete this._cache[t];},s.prototype.clear=function(){this._cache={};},oa.exports}var la,sn;function Gl(){if(sn)return la;sn=1;var s=Ar(),e=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,t=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,r=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,n=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,o=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,i=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,l=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,d=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,f=/^(?:\/(?:[^~/]|~0|~1)*)*$/,p=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,b=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;la=c;function c(A){return A=A=="full"?"full":"fast",s.copy(c[A])}c.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":i,url:l,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:r,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:C,uuid:d,"json-pointer":f,"json-pointer-uri-fragment":p,"relative-json-pointer":b},c.full={date:_,time:v,"date-time":j,uri:P,"uri-reference":o,"uri-template":i,url:l,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:r,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:C,uuid:d,"json-pointer":f,"json-pointer-uri-fragment":p,"relative-json-pointer":b};function h(A){return A%4===0&&(A%100!==0||A%400===0)}function _(A){var D=A.match(e);if(!D)return  false;var N=+D[1],E=+D[2],$=+D[3];return E>=1&&E<=12&&$>=1&&$<=(E==2&&h(N)?29:t[E])}function v(A,D){var N=A.match(a);if(!N)return  false;var E=N[1],$=N[2],F=N[3],M=N[5];return (E<=23&&$<=59&&F<=59||E==23&&$==59&&F==60)&&(!D||M)}var S=/t|\s/i;function j(A){var D=A.split(S);return D.length==2&&_(D[0])&&v(D[1],true)}var I=/\/|:/;function P(A){return I.test(A)&&n.test(A)}var R=/[^\\]\\Z/;function C(A){if(R.test(A))return  false;try{return new RegExp(A),!0}catch{return  false}}return la}var ua,nn;function Wl(){return nn||(nn=1,ua=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(o||""),p="valid"+n,b,c;if(i=="#"||i=="#/")e.isRoot?(b=e.async,c="validate"):(b=e.root.schema.$async===true,c="root.refVal[0]");else {var h=e.resolveRef(e.baseId,i,e.isRoot);if(h===void 0){var _=e.MissingRefError.message(e.baseId,i);if(e.opts.missingRefs=="fail"){e.logger.error(_);var v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { ref: '"+e.util.escapeQuotes(i)+"' } ",e.opts.messages!==false&&(r+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(i)+"' "),e.opts.verbose&&(r+=" , schema: "+e.util.toQuotedString(i)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),r+=" } "):r+=" {} ";var S=r;r=v.pop(),!e.compositeRule&&d?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d&&(r+=" if (false) { ");}else if(e.opts.missingRefs=="ignore")e.logger.warn(_),d&&(r+=" if (true) { ");else throw new e.MissingRefError(e.baseId,i,_)}else if(h.inline){var j=e.util.copy(e);j.level++;var I="valid"+j.level;j.schema=h.schema,j.schemaPath="",j.errSchemaPath=i;var P=e.validate(j).replace(/validate\.schema/g,h.code);r+=" "+P+" ",d&&(r+=" if ("+I+") { ");}else b=h.$async===true||e.async&&h.$async!==false,c=h.code;}if(c){var v=v||[];v.push(r),r="",e.opts.passContext?r+=" "+c+".call(this, ":r+=" "+c+"( ",r+=" "+f+", (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var R=o?"data"+(o-1||""):"parentData",C=o?e.dataPathArr[o]:"parentDataProperty";r+=" , "+R+" , "+C+", rootData)  ";var A=r;if(r=v.pop(),b){if(!e.async)throw new Error("async schema referenced by sync schema");d&&(r+=" var "+p+"; "),r+=" try { await "+A+"; ",d&&(r+=" "+p+" = true; "),r+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",d&&(r+=" "+p+" = false; "),r+=" } ",d&&(r+=" if ("+p+") { ");}else r+=" if (!"+A+") { if (vErrors === null) vErrors = "+c+".errors; else vErrors = vErrors.concat("+c+".errors); errors = vErrors.length; } ",d&&(r+=" else { ");}return r}),ua}var ca,on;function Yl(){return on||(on=1,ca=function(e,t,a){var r=" ",n=e.schema[t],o=e.schemaPath+e.util.getProperty(t),i=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,d=e.util.copy(e),f="";d.level++;var p="valid"+d.level,b=d.baseId,c=true,h=n;if(h)for(var _,v=-1,S=h.length-1;v<S;)_=h[v+=1],(e.opts.strictKeywords?typeof _=="object"&&Object.keys(_).length>0||_===false:e.util.schemaHasRules(_,e.RULES.all))&&(c=false,d.schema=_,d.schemaPath=o+"["+v+"]",d.errSchemaPath=i+"/"+v,r+="  "+e.validate(d)+" ",d.baseId=b,l&&(r+=" if ("+p+") { ",f+="}"));return l&&(c?r+=" if (true) { ":r+=" "+f.slice(0,-1)+" "),r}),ca}var da,ln;function Xl(){return ln||(ln=1,da=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c="errs__"+n,h=e.util.copy(e),_="";h.level++;var v="valid"+h.level,S=i.every(function(D){return e.opts.strictKeywords?typeof D=="object"&&Object.keys(D).length>0||D===false:e.util.schemaHasRules(D,e.RULES.all)});if(S){var j=h.baseId;r+=" var "+c+" = errors; var "+b+" = false;  ";var I=e.compositeRule;e.compositeRule=h.compositeRule=true;var P=i;if(P)for(var R,C=-1,A=P.length-1;C<A;)R=P[C+=1],h.schema=R,h.schemaPath=l+"["+C+"]",h.errSchemaPath=d+"/"+C,r+="  "+e.validate(h)+" ",h.baseId=j,r+=" "+b+" = "+b+" || "+v+"; if (!"+b+") { ",_+="}";e.compositeRule=h.compositeRule=I,r+=" "+_+" if (!"+b+") {   var err =   ",e.createErrors!==false?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: {} ",e.opts.messages!==false&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ");}else f&&(r+=" if (true) { ");return r}),da}var ha,un;function eu(){return un||(un=1,ha=function(e,t,a){var r=" ",n=e.schema[t],o=e.errSchemaPath+"/"+t;e.opts.allErrors;var i=e.util.toQuotedString(n);return e.opts.$comment===true?r+=" console.log("+i+");":typeof e.opts.$comment=="function"&&(r+=" self._opts.$comment("+i+", "+e.util.toQuotedString(o)+", validate.root.schema);"),r}),ha}var fa,cn;function ru(){return cn||(cn=1,fa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c=e.opts.$data&&i&&i.$data;c&&(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; "),c||(r+=" var schema"+n+" = validate.schema"+l+";"),r+="var "+b+" = equal("+p+", schema"+n+"); if (!"+b+") {   ";var h=h||[];h.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { allowedValue: schema"+n+" } ",e.opts.messages!==false&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var _=r;return r=h.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",f&&(r+=" else { "),r}),fa}var ma,dn;function tu(){return dn||(dn=1,ma=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c="errs__"+n,h=e.util.copy(e),_="";h.level++;var v="valid"+h.level,S="i"+n,j=h.dataLevel=e.dataLevel+1,I="data"+j,P=e.baseId,R=e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===false:e.util.schemaHasRules(i,e.RULES.all);if(r+="var "+c+" = errors;var "+b+";",R){var C=e.compositeRule;e.compositeRule=h.compositeRule=true,h.schema=i,h.schemaPath=l,h.errSchemaPath=d,r+=" var "+v+" = false; for (var "+S+" = 0; "+S+" < "+p+".length; "+S+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,S,e.opts.jsonPointers,true);var A=p+"["+S+"]";h.dataPathArr[j]=S;var D=e.validate(h);h.baseId=P,e.util.varOccurences(D,I)<2?r+=" "+e.util.varReplace(D,I,A)+" ":r+=" var "+I+" = "+A+"; "+D+" ",r+=" if ("+v+") break; }  ",e.compositeRule=h.compositeRule=C,r+=" "+_+" if (!"+v+") {";}else r+=" if ("+p+".length == 0) {";var N=N||[];N.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: {} ",e.opts.messages!==false&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var E=r;return r=N.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",R&&(r+="  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r}),ma}var pa,hn;function au(){return hn||(hn=1,pa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="errs__"+n,c=e.util.copy(e),h="";c.level++;var _="valid"+c.level,v={},S={},j=e.opts.ownProperties;for(C in i)if(C!="__proto__"){var I=i[C],P=Array.isArray(I)?S:v;P[C]=I;}r+="var "+b+" = errors;";var R=e.errorPath;r+="var missing"+n+";";for(var C in S)if(P=S[C],P.length){if(r+=" if ( "+p+e.util.getProperty(C)+" !== undefined ",j&&(r+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(C)+"') "),f){r+=" && ( ";var A=P;if(A)for(var D,N=-1,E=A.length-1;N<E;){D=A[N+=1],N&&(r+=" || ");var $=e.util.getProperty(D),F=p+$;r+=" ( ( "+F+" === undefined ",j&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(D)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?D:$)+") ) ";}r+=")) {  ";var M="missing"+n,z="' + "+M+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(R,M,true):R+" + "+M);var G=G||[];G.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { property: '"+e.util.escapeQuotes(C)+"', missingProperty: '"+z+"', depsCount: "+P.length+", deps: '"+e.util.escapeQuotes(P.length==1?P[0]:P.join(", "))+"' } ",e.opts.messages!==false&&(r+=" , message: 'should have ",P.length==1?r+="property "+e.util.escapeQuotes(P[0]):r+="properties "+e.util.escapeQuotes(P.join(", ")),r+=" when property "+e.util.escapeQuotes(C)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var ne=r;r=G.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+ne+"]); ":r+=" validate.errors = ["+ne+"]; return false; ":r+=" var err = "+ne+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";}else {r+=" ) { ";var X=P;if(X)for(var D,le=-1,te=X.length-1;le<te;){D=X[le+=1];var $=e.util.getProperty(D),z=e.util.escapeQuotes(D),F=p+$;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(R,D,e.opts.jsonPointers)),r+=" if ( "+F+" === undefined ",j&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(D)+"') "),r+=") {  var err =   ",e.createErrors!==false?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { property: '"+e.util.escapeQuotes(C)+"', missingProperty: '"+z+"', depsCount: "+P.length+", deps: '"+e.util.escapeQuotes(P.length==1?P[0]:P.join(", "))+"' } ",e.opts.messages!==false&&(r+=" , message: 'should have ",P.length==1?r+="property "+e.util.escapeQuotes(P[0]):r+="properties "+e.util.escapeQuotes(P.join(", ")),r+=" when property "+e.util.escapeQuotes(C)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ";}}r+=" }   ",f&&(h+="}",r+=" else { ");}e.errorPath=R;var ae=c.baseId;for(var C in v){var I=v[C];(e.opts.strictKeywords?typeof I=="object"&&Object.keys(I).length>0||I===false:e.util.schemaHasRules(I,e.RULES.all))&&(r+=" "+_+" = true; if ( "+p+e.util.getProperty(C)+" !== undefined ",j&&(r+=" && Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(C)+"') "),r+=") { ",c.schema=I,c.schemaPath=l+e.util.getProperty(C),c.errSchemaPath=d+"/"+e.util.escapeFragment(C),r+="  "+e.validate(c)+" ",c.baseId=ae,r+=" }  ",f&&(r+=" if ("+_+") { ",h+="}"));}return f&&(r+="   "+h+" if ("+b+" == errors) {"),r}),pa}var va,fn;function su(){return fn||(fn=1,va=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c=e.opts.$data&&i&&i.$data;c&&(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ");var h="i"+n,_="schema"+n;c||(r+=" var "+_+" = validate.schema"+l+";"),r+="var "+b+";",c&&(r+=" if (schema"+n+" === undefined) "+b+" = true; else if (!Array.isArray(schema"+n+")) "+b+" = false; else {"),r+=""+b+" = false;for (var "+h+"=0; "+h+"<"+_+".length; "+h+"++) if (equal("+p+", "+_+"["+h+"])) { "+b+" = true; break; }",c&&(r+="  }  "),r+=" if (!"+b+") {   ";var v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { allowedValues: schema"+n+" } ",e.opts.messages!==false&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",f&&(r+=" else { "),r}),va}var ga,mn;function nu(){return mn||(mn=1,ga=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||"");if(e.opts.format===false)return f&&(r+=" if (true) { "),r;var b=e.opts.$data&&i&&i.$data,c;b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i;var h=e.opts.unknownFormats,_=Array.isArray(h);if(b){var v="format"+n,S="isObject"+n,j="formatType"+n;r+=" var "+v+" = formats["+c+"]; var "+S+" = typeof "+v+" == 'object' && !("+v+" instanceof RegExp) && "+v+".validate; var "+j+" = "+S+" && "+v+".type || 'string'; if ("+S+") { ",e.async&&(r+=" var async"+n+" = "+v+".async; "),r+=" "+v+" = "+v+".validate; } if (  ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'string') || "),r+=" (",h!="ignore"&&(r+=" ("+c+" && !"+v+" ",_&&(r+=" && self._opts.unknownFormats.indexOf("+c+") == -1 "),r+=") || "),r+=" ("+v+" && "+j+" == '"+a+"' && !(typeof "+v+" == 'function' ? ",e.async?r+=" (async"+n+" ? await "+v+"("+p+") : "+v+"("+p+")) ":r+=" "+v+"("+p+") ",r+=" : "+v+".test("+p+"))))) {";}else {var v=e.formats[i];if(!v){if(h=="ignore")return e.logger.warn('unknown format "'+i+'" ignored in schema at path "'+e.errSchemaPath+'"'),f&&(r+=" if (true) { "),r;if(_&&h.indexOf(i)>=0)return f&&(r+=" if (true) { "),r;throw new Error('unknown format "'+i+'" is used in schema at path "'+e.errSchemaPath+'"')}var S=typeof v=="object"&&!(v instanceof RegExp)&&v.validate,j=S&&v.type||"string";if(S){var I=v.async===true;v=v.validate;}if(j!=a)return f&&(r+=" if (true) { "),r;if(I){if(!e.async)throw new Error("async format in sync schema");var P="formats"+e.util.getProperty(i)+".validate";r+=" if (!(await "+P+"("+p+"))) { ";}else {r+=" if (! ";var P="formats"+e.util.getProperty(i);S&&(P+=".validate"),typeof v=="function"?r+=" "+P+"("+p+") ":r+=" "+P+".test("+p+") ",r+=") { ";}}var R=R||[];R.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { format:  ",b?r+=""+c:r+=""+e.util.toQuotedString(i),r+="  } ",e.opts.messages!==false&&(r+=` , message: 'should match format "`,b?r+="' + "+c+" + '":r+=""+e.util.escapeQuotes(i),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+e.util.toQuotedString(i),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var C=r;return r=R.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+C+"]); ":r+=" validate.errors = ["+C+"]; return false; ":r+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",f&&(r+=" else { "),r}),ga}var ya,pn;function iu(){return pn||(pn=1,ya=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c="errs__"+n,h=e.util.copy(e);h.level++;var _="valid"+h.level,v=e.schema.then,S=e.schema.else,j=v!==void 0&&(e.opts.strictKeywords?typeof v=="object"&&Object.keys(v).length>0||v===false:e.util.schemaHasRules(v,e.RULES.all)),I=S!==void 0&&(e.opts.strictKeywords?typeof S=="object"&&Object.keys(S).length>0||S===false:e.util.schemaHasRules(S,e.RULES.all)),P=h.baseId;if(j||I){var R;h.createErrors=false,h.schema=i,h.schemaPath=l,h.errSchemaPath=d,r+=" var "+c+" = errors; var "+b+" = true;  ";var C=e.compositeRule;e.compositeRule=h.compositeRule=true,r+="  "+e.validate(h)+" ",h.baseId=P,h.createErrors=true,r+="  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; }  ",e.compositeRule=h.compositeRule=C,j?(r+=" if ("+_+") {  ",h.schema=e.schema.then,h.schemaPath=e.schemaPath+".then",h.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(h)+" ",h.baseId=P,r+=" "+b+" = "+_+"; ",j&&I?(R="ifClause"+n,r+=" var "+R+" = 'then'; "):R="'then'",r+=" } ",I&&(r+=" else { ")):r+=" if (!"+_+") { ",I&&(h.schema=e.schema.else,h.schemaPath=e.schemaPath+".else",h.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(h)+" ",h.baseId=P,r+=" "+b+" = "+_+"; ",j&&I?(R="ifClause"+n,r+=" var "+R+" = 'else'; "):R="'else'",r+=" } "),r+=" if (!"+b+") {   var err =   ",e.createErrors!==false?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { failingKeyword: "+R+" } ",e.opts.messages!==false&&(r+=` , message: 'should match "' + `+R+` + '" schema' `),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",f&&(r+=" else { ");}else f&&(r+=" if (true) { ");return r}),ya}var _a,vn;function ou(){return vn||(vn=1,_a=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c="errs__"+n,h=e.util.copy(e),_="";h.level++;var v="valid"+h.level,S="i"+n,j=h.dataLevel=e.dataLevel+1,I="data"+j,P=e.baseId;if(r+="var "+c+" = errors;var "+b+";",Array.isArray(i)){var R=e.schema.additionalItems;if(R===false){r+=" "+b+" = "+p+".length <= "+i.length+"; ";var C=d;d=e.errSchemaPath+"/additionalItems",r+="  if (!"+b+") {   ";var A=A||[];A.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { limit: "+i.length+" } ",e.opts.messages!==false&&(r+=" , message: 'should NOT have more than "+i.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var D=r;r=A.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+D+"]); ":r+=" validate.errors = ["+D+"]; return false; ":r+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",d=C,f&&(_+="}",r+=" else { ");}var N=i;if(N){for(var E,$=-1,F=N.length-1;$<F;)if(E=N[$+=1],e.opts.strictKeywords?typeof E=="object"&&Object.keys(E).length>0||E===false:e.util.schemaHasRules(E,e.RULES.all)){r+=" "+v+" = true; if ("+p+".length > "+$+") { ";var M=p+"["+$+"]";h.schema=E,h.schemaPath=l+"["+$+"]",h.errSchemaPath=d+"/"+$,h.errorPath=e.util.getPathExpr(e.errorPath,$,e.opts.jsonPointers,true),h.dataPathArr[j]=$;var z=e.validate(h);h.baseId=P,e.util.varOccurences(z,I)<2?r+=" "+e.util.varReplace(z,I,M)+" ":r+=" var "+I+" = "+M+"; "+z+" ",r+=" }  ",f&&(r+=" if ("+v+") { ",_+="}");}}if(typeof R=="object"&&(e.opts.strictKeywords?typeof R=="object"&&Object.keys(R).length>0||R===false:e.util.schemaHasRules(R,e.RULES.all))){h.schema=R,h.schemaPath=e.schemaPath+".additionalItems",h.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+v+" = true; if ("+p+".length > "+i.length+") {  for (var "+S+" = "+i.length+"; "+S+" < "+p+".length; "+S+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,S,e.opts.jsonPointers,true);var M=p+"["+S+"]";h.dataPathArr[j]=S;var z=e.validate(h);h.baseId=P,e.util.varOccurences(z,I)<2?r+=" "+e.util.varReplace(z,I,M)+" ":r+=" var "+I+" = "+M+"; "+z+" ",f&&(r+=" if (!"+v+") break; "),r+=" } }  ",f&&(r+=" if ("+v+") { ",_+="}");}}else if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===false:e.util.schemaHasRules(i,e.RULES.all)){h.schema=i,h.schemaPath=l,h.errSchemaPath=d,r+="  for (var "+S+" = 0; "+S+" < "+p+".length; "+S+"++) { ",h.errorPath=e.util.getPathExpr(e.errorPath,S,e.opts.jsonPointers,true);var M=p+"["+S+"]";h.dataPathArr[j]=S;var z=e.validate(h);h.baseId=P,e.util.varOccurences(z,I)<2?r+=" "+e.util.varReplace(z,I,M)+" ":r+=" var "+I+" = "+M+"; "+z+" ",f&&(r+=" if (!"+v+") break; "),r+=" }";}return f&&(r+=" "+_+" if ("+c+" == errors) {"),r}),_a}var Pa,gn;function yn(){return gn||(gn=1,Pa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,P,p="data"+(o||""),b=e.opts.$data&&i&&i.$data,c;b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i;var h=t=="maximum",_=h?"exclusiveMaximum":"exclusiveMinimum",v=e.schema[_],S=e.opts.$data&&v&&v.$data,j=h?"<":">",I=h?">":"<",P=void 0;if(!(b||typeof i=="number"||i===void 0))throw new Error(t+" must be number");if(!(S||v===void 0||typeof v=="number"||typeof v=="boolean"))throw new Error(_+" must be number or boolean");if(S){var R=e.util.getData(v.$data,o,e.dataPathArr),C="exclusive"+n,A="exclType"+n,D="exclIsNumber"+n,N="op"+n,E="' + "+N+" + '";r+=" var schemaExcl"+n+" = "+R+"; ",R="schemaExcl"+n,r+=" var "+C+"; var "+A+" = typeof "+R+"; if ("+A+" != 'boolean' && "+A+" != 'undefined' && "+A+" != 'number') { ";var P=_,$=$||[];$.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(P||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: {} ",e.opts.messages!==false&&(r+=" , message: '"+_+" should be boolean' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var F=r;r=$.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+F+"]); ":r+=" validate.errors = ["+F+"]; return false; ":r+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'number') || "),r+=" "+A+" == 'number' ? ( ("+C+" = "+c+" === undefined || "+R+" "+j+"= "+c+") ? "+p+" "+I+"= "+R+" : "+p+" "+I+" "+c+" ) : ( ("+C+" = "+R+" === true) ? "+p+" "+I+"= "+c+" : "+p+" "+I+" "+c+" ) || "+p+" !== "+p+") { var op"+n+" = "+C+" ? '"+j+"' : '"+j+"='; ",i===void 0&&(P=_,d=e.errSchemaPath+"/"+_,c=R,b=S);}else {var D=typeof v=="number",E=j;if(D&&b){var N="'"+E+"'";r+=" if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'number') || "),r+=" ( "+c+" === undefined || "+v+" "+j+"= "+c+" ? "+p+" "+I+"= "+v+" : "+p+" "+I+" "+c+" ) || "+p+" !== "+p+") { ";}else {D&&i===void 0?(C=true,P=_,d=e.errSchemaPath+"/"+_,c=v,I+="="):(D&&(c=Math[h?"min":"max"](v,i)),v===(D?c:true)?(C=true,P=_,d=e.errSchemaPath+"/"+_,I+="="):(C=false,E+="="));var N="'"+E+"'";r+=" if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'number') || "),r+=" "+p+" "+I+" "+c+" || "+p+" !== "+p+") { ";}}P=P||t;var $=$||[];$.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(P||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { comparison: "+N+", limit: "+c+", exclusive: "+C+" } ",e.opts.messages!==false&&(r+=" , message: 'should be "+E+" ",b?r+="' + "+c:r+=""+c+"'"),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var F=r;return r=$.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+F+"]); ":r+=" validate.errors = ["+F+"]; return false; ":r+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",f&&(r+=" else { "),r}),Pa}var ba,_n;function Pn(){return _n||(_n=1,ba=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,_,p="data"+(o||""),b=e.opts.$data&&i&&i.$data,c;if(b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i,!(b||typeof i=="number"))throw new Error(t+" must be number");var h=t=="maxItems"?">":"<";r+="if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'number') || "),r+=" "+p+".length "+h+" "+c+") { ";var _=t,v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(_||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { limit: "+c+" } ",e.opts.messages!==false&&(r+=" , message: 'should NOT have ",t=="maxItems"?r+="more":r+="fewer",r+=" than ",b?r+="' + "+c+" + '":r+=""+i,r+=" items' "),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}),ba}var Sa,bn;function Sn(){return bn||(bn=1,Sa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,_,p="data"+(o||""),b=e.opts.$data&&i&&i.$data,c;if(b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i,!(b||typeof i=="number"))throw new Error(t+" must be number");var h=t=="maxLength"?">":"<";r+="if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'number') || "),e.opts.unicode===false?r+=" "+p+".length ":r+=" ucs2length("+p+") ",r+=" "+h+" "+c+") { ";var _=t,v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(_||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { limit: "+c+" } ",e.opts.messages!==false&&(r+=" , message: 'should NOT be ",t=="maxLength"?r+="longer":r+="shorter",r+=" than ",b?r+="' + "+c+" + '":r+=""+i,r+=" characters' "),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}),Sa}var Ea,En;function wn(){return En||(En=1,Ea=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,_,p="data"+(o||""),b=e.opts.$data&&i&&i.$data,c;if(b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i,!(b||typeof i=="number"))throw new Error(t+" must be number");var h=t=="maxProperties"?">":"<";r+="if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'number') || "),r+=" Object.keys("+p+").length "+h+" "+c+") { ";var _=t,v=v||[];v.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(_||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { limit: "+c+" } ",e.opts.messages!==false&&(r+=" , message: 'should NOT have ",t=="maxProperties"?r+="more":r+="fewer",r+=" than ",b?r+="' + "+c+" + '":r+=""+i,r+=" properties' "),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var S=r;return r=v.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+S+"]); ":r+=" validate.errors = ["+S+"]; return false; ":r+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}),Ea}var wa,Rn;function lu(){return Rn||(Rn=1,wa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b=e.opts.$data&&i&&i.$data,c;if(b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i,!(b||typeof i=="number"))throw new Error(t+" must be number");r+="var division"+n+";if (",b&&(r+=" "+c+" !== undefined && ( typeof "+c+" != 'number' || "),r+=" (division"+n+" = "+p+" / "+c+", ",e.opts.multipleOfPrecision?r+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":r+=" division"+n+" !== parseInt(division"+n+") ",r+=" ) ",b&&(r+="  )  "),r+=" ) {   ";var h=h||[];h.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { multipleOf: "+c+" } ",e.opts.messages!==false&&(r+=" , message: 'should be multiple of ",b?r+="' + "+c:r+=""+c+"'"),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var _=r;return r=h.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+_+"]); ":r+=" validate.errors = ["+_+"]; return false; ":r+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}),wa}var Ra,xn;function uu(){return xn||(xn=1,Ra=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="errs__"+n,c=e.util.copy(e);c.level++;var h="valid"+c.level;if(e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===false:e.util.schemaHasRules(i,e.RULES.all)){c.schema=i,c.schemaPath=l,c.errSchemaPath=d,r+=" var "+b+" = errors;  ";var _=e.compositeRule;e.compositeRule=c.compositeRule=true,c.createErrors=false;var v;c.opts.allErrors&&(v=c.opts.allErrors,c.opts.allErrors=false),r+=" "+e.validate(c)+" ",c.createErrors=true,v&&(c.opts.allErrors=v),e.compositeRule=c.compositeRule=_,r+=" if ("+h+") {   ";var S=S||[];S.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: {} ",e.opts.messages!==false&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var j=r;r=S.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+j+"]); ":r+=" validate.errors = ["+j+"]; return false; ":r+=" var err = "+j+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+b+"; if (vErrors !== null) { if ("+b+") vErrors.length = "+b+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ");}else r+="  var err =   ",e.createErrors!==false?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: {} ",e.opts.messages!==false&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",f&&(r+=" if (false) { ");return r}),Ra}var xa,$n;function cu(){return $n||($n=1,xa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c="errs__"+n,h=e.util.copy(e),_="";h.level++;var v="valid"+h.level,S=h.baseId,j="prevValid"+n,I="passingSchemas"+n;r+="var "+c+" = errors , "+j+" = false , "+b+" = false , "+I+" = null; ";var P=e.compositeRule;e.compositeRule=h.compositeRule=true;var R=i;if(R)for(var C,A=-1,D=R.length-1;A<D;)C=R[A+=1],(e.opts.strictKeywords?typeof C=="object"&&Object.keys(C).length>0||C===false:e.util.schemaHasRules(C,e.RULES.all))?(h.schema=C,h.schemaPath=l+"["+A+"]",h.errSchemaPath=d+"/"+A,r+="  "+e.validate(h)+" ",h.baseId=S):r+=" var "+v+" = true; ",A&&(r+=" if ("+v+" && "+j+") { "+b+" = false; "+I+" = ["+I+", "+A+"]; } else { ",_+="}"),r+=" if ("+v+") { "+b+" = "+j+" = true; "+I+" = "+A+"; }";return e.compositeRule=h.compositeRule=P,r+=""+_+"if (!"+b+") {   var err =   ",e.createErrors!==false?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { passingSchemas: "+I+" } ",e.opts.messages!==false&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}),xa}var $a,On;function du(){return On||(On=1,$a=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b=e.opts.$data&&i&&i.$data,c;b?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",c="schema"+n):c=i;var h=b?"(new RegExp("+c+"))":e.usePattern(i);r+="if ( ",b&&(r+=" ("+c+" !== undefined && typeof "+c+" != 'string') || "),r+=" !"+h+".test("+p+") ) {   ";var _=_||[];_.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { pattern:  ",b?r+=""+c:r+=""+e.util.toQuotedString(i),r+="  } ",e.opts.messages!==false&&(r+=` , message: 'should match pattern "`,b?r+="' + "+c+" + '":r+=""+e.util.escapeQuotes(i),r+=`"' `),e.opts.verbose&&(r+=" , schema:  ",b?r+="validate.schema"+l:r+=""+e.util.toQuotedString(i),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var v=r;return r=_.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+v+"]); ":r+=" validate.errors = ["+v+"]; return false; ":r+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+="} ",f&&(r+=" else { "),r}),$a}var Oa,Tn;function hu(){return Tn||(Tn=1,Oa=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="errs__"+n,c=e.util.copy(e),h="";c.level++;var _="valid"+c.level,v="key"+n,S="idx"+n,j=c.dataLevel=e.dataLevel+1,I="data"+j,P="dataProperties"+n,R=Object.keys(i||{}).filter(le),C=e.schema.patternProperties||{},A=Object.keys(C).filter(le),D=e.schema.additionalProperties,N=R.length||A.length,E=D===false,$=typeof D=="object"&&Object.keys(D).length,F=e.opts.removeAdditional,M=E||$||F,z=e.opts.ownProperties,G=e.baseId,ne=e.schema.required;if(ne&&!(e.opts.$data&&ne.$data)&&ne.length<e.opts.loopRequired)var X=e.util.toHash(ne);function le(Va){return Va!=="__proto__"}if(r+="var "+b+" = errors;var "+_+" = true;",z&&(r+=" var "+P+" = undefined;"),M){if(z?r+=" "+P+" = "+P+" || Object.keys("+p+"); for (var "+S+"=0; "+S+"<"+P+".length; "+S+"++) { var "+v+" = "+P+"["+S+"]; ":r+=" for (var "+v+" in "+p+") { ",N){if(r+=" var isAdditional"+n+" = !(false ",R.length)if(R.length>8)r+=" || validate.schema"+l+".hasOwnProperty("+v+") ";else {var te=R;if(te)for(var ae,He=-1,Me=te.length-1;He<Me;)ae=te[He+=1],r+=" || "+v+" == "+e.util.toQuotedString(ae)+" ";}if(A.length){var Le=A;if(Le)for(var Ie,er=-1,w=Le.length-1;er<w;)Ie=Le[er+=1],r+=" || "+e.usePattern(Ie)+".test("+v+") ";}r+=" ); if (isAdditional"+n+") { ";}if(F=="all")r+=" delete "+p+"["+v+"]; ";else {var q=e.errorPath,Q="' + "+v+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers)),E)if(F)r+=" delete "+p+"["+v+"]; ";else {r+=" "+_+" = false; ";var re=d;d=e.errSchemaPath+"/additionalProperties";var L=L||[];L.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { additionalProperty: '"+Q+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var V=r;r=L.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+V+"]); ":r+=" validate.errors = ["+V+"]; return false; ":r+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d=re,f&&(r+=" break; ");}else if($)if(F=="failing"){r+=" var "+b+" = errors;  ";var oe=e.compositeRule;e.compositeRule=c.compositeRule=true,c.schema=D,c.schemaPath=e.schemaPath+".additionalProperties",c.errSchemaPath=e.errSchemaPath+"/additionalProperties",c.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var he=p+"["+v+"]";c.dataPathArr[j]=v;var ue=e.validate(c);c.baseId=G,e.util.varOccurences(ue,I)<2?r+=" "+e.util.varReplace(ue,I,he)+" ":r+=" var "+I+" = "+he+"; "+ue+" ",r+=" if (!"+_+") { errors = "+b+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+p+"["+v+"]; }  ",e.compositeRule=c.compositeRule=oe;}else {c.schema=D,c.schemaPath=e.schemaPath+".additionalProperties",c.errSchemaPath=e.errSchemaPath+"/additionalProperties",c.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var he=p+"["+v+"]";c.dataPathArr[j]=v;var ue=e.validate(c);c.baseId=G,e.util.varOccurences(ue,I)<2?r+=" "+e.util.varReplace(ue,I,he)+" ":r+=" var "+I+" = "+he+"; "+ue+" ",f&&(r+=" if (!"+_+") break; ");}e.errorPath=q;}N&&(r+=" } "),r+=" }  ",f&&(r+=" if ("+_+") { ",h+="}");}var Re=e.opts.useDefaults&&!e.compositeRule;if(R.length){var ge=R;if(ge)for(var ae,ye=-1,ze=ge.length-1;ye<ze;){ae=ge[ye+=1];var Te=i[ae];if(e.opts.strictKeywords?typeof Te=="object"&&Object.keys(Te).length>0||Te===false:e.util.schemaHasRules(Te,e.RULES.all)){var sr=e.util.getProperty(ae),he=p+sr,Ve=Re&&Te.default!==void 0;c.schema=Te,c.schemaPath=l+sr,c.errSchemaPath=d+"/"+e.util.escapeFragment(ae),c.errorPath=e.util.getPath(e.errorPath,ae,e.opts.jsonPointers),c.dataPathArr[j]=e.util.toQuotedString(ae);var ue=e.validate(c);if(c.baseId=G,e.util.varOccurences(ue,I)<2){ue=e.util.varReplace(ue,I,he);var ke=he;}else {var ke=I;r+=" var "+I+" = "+he+"; ";}if(Ve)r+=" "+ue+" ";else {if(X&&X[ae]){r+=" if ( "+ke+" === undefined ",z&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(ae)+"') "),r+=") { "+_+" = false; ";var q=e.errorPath,re=d,Ae=e.util.escapeQuotes(ae);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(q,ae,e.opts.jsonPointers)),d=e.errSchemaPath+"/required";var L=L||[];L.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { missingProperty: '"+Ae+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+Ae+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var V=r;r=L.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+V+"]); ":r+=" validate.errors = ["+V+"]; return false; ":r+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",d=re,e.errorPath=q,r+=" } else { ";}else f?(r+=" if ( "+ke+" === undefined ",z&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(ae)+"') "),r+=") { "+_+" = true; } else { "):(r+=" if ("+ke+" !== undefined ",z&&(r+=" &&   Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(ae)+"') "),r+=" ) { ");r+=" "+ue+" } ";}}f&&(r+=" if ("+_+") { ",h+="}");}}if(A.length){var Je=A;if(Je)for(var Ie,mt=-1,Ha=Je.length-1;mt<Ha;){Ie=Je[mt+=1];var Te=C[Ie];if(e.opts.strictKeywords?typeof Te=="object"&&Object.keys(Te).length>0||Te===false:e.util.schemaHasRules(Te,e.RULES.all)){c.schema=Te,c.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(Ie),c.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(Ie),z?r+=" "+P+" = "+P+" || Object.keys("+p+"); for (var "+S+"=0; "+S+"<"+P+".length; "+S+"++) { var "+v+" = "+P+"["+S+"]; ":r+=" for (var "+v+" in "+p+") { ",r+=" if ("+e.usePattern(Ie)+".test("+v+")) { ",c.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers);var he=p+"["+v+"]";c.dataPathArr[j]=v;var ue=e.validate(c);c.baseId=G,e.util.varOccurences(ue,I)<2?r+=" "+e.util.varReplace(ue,I,he)+" ":r+=" var "+I+" = "+he+"; "+ue+" ",f&&(r+=" if (!"+_+") break; "),r+=" } ",f&&(r+=" else "+_+" = true; "),r+=" }  ",f&&(r+=" if ("+_+") { ",h+="}");}}}return f&&(r+=" "+h+" if ("+b+" == errors) {"),r}),Oa}var Ta,kn;function fu(){return kn||(kn=1,Ta=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="errs__"+n,c=e.util.copy(e),h="";c.level++;var _="valid"+c.level;if(r+="var "+b+" = errors;",e.opts.strictKeywords?typeof i=="object"&&Object.keys(i).length>0||i===false:e.util.schemaHasRules(i,e.RULES.all)){c.schema=i,c.schemaPath=l,c.errSchemaPath=d;var v="key"+n,S="idx"+n,j="i"+n,I="' + "+v+" + '",P=c.dataLevel=e.dataLevel+1,R="data"+P,C="dataProperties"+n,A=e.opts.ownProperties,D=e.baseId;A&&(r+=" var "+C+" = undefined; "),A?r+=" "+C+" = "+C+" || Object.keys("+p+"); for (var "+S+"=0; "+S+"<"+C+".length; "+S+"++) { var "+v+" = "+C+"["+S+"]; ":r+=" for (var "+v+" in "+p+") { ",r+=" var startErrs"+n+" = errors; ";var N=v,E=e.compositeRule;e.compositeRule=c.compositeRule=true;var $=e.validate(c);c.baseId=D,e.util.varOccurences($,R)<2?r+=" "+e.util.varReplace($,R,N)+" ":r+=" var "+R+" = "+N+"; "+$+" ",e.compositeRule=c.compositeRule=E,r+=" if (!"+_+") { for (var "+j+"=startErrs"+n+"; "+j+"<errors; "+j+"++) { vErrors["+j+"].propertyName = "+v+"; }   var err =   ",e.createErrors!==false?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { propertyName: '"+I+"' } ",e.opts.messages!==false&&(r+=" , message: 'property name \\'"+I+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),f&&(r+=" break; "),r+=" } }";}return f&&(r+=" "+h+" if ("+b+" == errors) {"),r}),Ta}var ka,Cn;function mu(){return Cn||(Cn=1,ka=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c=e.opts.$data&&i&&i.$data;c&&(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ");var h="schema"+n;if(!c)if(i.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var _=[],v=i;if(v)for(var S,j=-1,I=v.length-1;j<I;){S=v[j+=1];var P=e.schema.properties[S];P&&(e.opts.strictKeywords?typeof P=="object"&&Object.keys(P).length>0||P===false:e.util.schemaHasRules(P,e.RULES.all))||(_[_.length]=S);}}else var _=i;if(c||_.length){var R=e.errorPath,C=c||_.length>=e.opts.loopRequired,A=e.opts.ownProperties;if(f)if(r+=" var missing"+n+"; ",C){c||(r+=" var "+h+" = validate.schema"+l+"; ");var D="i"+n,N="schema"+n+"["+D+"]",E="' + "+N+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(R,N,e.opts.jsonPointers)),r+=" var "+b+" = true; ",c&&(r+=" if (schema"+n+" === undefined) "+b+" = true; else if (!Array.isArray(schema"+n+")) "+b+" = false; else {"),r+=" for (var "+D+" = 0; "+D+" < "+h+".length; "+D+"++) { "+b+" = "+p+"["+h+"["+D+"]] !== undefined ",A&&(r+=" &&   Object.prototype.hasOwnProperty.call("+p+", "+h+"["+D+"]) "),r+="; if (!"+b+") break; } ",c&&(r+="  }  "),r+="  if (!"+b+") {   ";var $=$||[];$.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { missingProperty: '"+E+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var F=r;r=$.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+F+"]); ":r+=" validate.errors = ["+F+"]; return false; ":r+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ";}else {r+=" if ( ";var M=_;if(M)for(var z,D=-1,G=M.length-1;D<G;){z=M[D+=1],D&&(r+=" || ");var ne=e.util.getProperty(z),X=p+ne;r+=" ( ( "+X+" === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(z)+"') "),r+=") && (missing"+n+" = "+e.util.toQuotedString(e.opts.jsonPointers?z:ne)+") ) ";}r+=") {  ";var N="missing"+n,E="' + "+N+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(R,N,true):R+" + "+N);var $=$||[];$.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { missingProperty: '"+E+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var F=r;r=$.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+F+"]); ":r+=" validate.errors = ["+F+"]; return false; ":r+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ";}else if(C){c||(r+=" var "+h+" = validate.schema"+l+"; ");var D="i"+n,N="schema"+n+"["+D+"]",E="' + "+N+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(R,N,e.opts.jsonPointers)),c&&(r+=" if ("+h+" && !Array.isArray("+h+")) {  var err =   ",e.createErrors!==false?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { missingProperty: '"+E+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+h+" !== undefined) { "),r+=" for (var "+D+" = 0; "+D+" < "+h+".length; "+D+"++) { if ("+p+"["+h+"["+D+"]] === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", "+h+"["+D+"]) "),r+=") {  var err =   ",e.createErrors!==false?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { missingProperty: '"+E+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",c&&(r+="  }  ");}else {var le=_;if(le)for(var z,te=-1,ae=le.length-1;te<ae;){z=le[te+=1];var ne=e.util.getProperty(z),E=e.util.escapeQuotes(z),X=p+ne;e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(R,z,e.opts.jsonPointers)),r+=" if ( "+X+" === undefined ",A&&(r+=" || ! Object.prototype.hasOwnProperty.call("+p+", '"+e.util.escapeQuotes(z)+"') "),r+=") {  var err =   ",e.createErrors!==false?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { missingProperty: '"+E+"' } ",e.opts.messages!==false&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } ";}}e.errorPath=R;}else f&&(r+=" if (true) {");return r}),ka}var Ca,In;function pu(){return In||(In=1,Ca=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p="data"+(o||""),b="valid"+n,c=e.opts.$data&&i&&i.$data,h;if(c?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",h="schema"+n):h=i,(i||c)&&e.opts.uniqueItems!==false){c&&(r+=" var "+b+"; if ("+h+" === false || "+h+" === undefined) "+b+" = true; else if (typeof "+h+" != 'boolean') "+b+" = false; else { "),r+=" var i = "+p+".length , "+b+" = true , j; if (i > 1) { ";var _=e.schema.items&&e.schema.items.type,v=Array.isArray(_);if(!_||_=="object"||_=="array"||v&&(_.indexOf("object")>=0||_.indexOf("array")>=0))r+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+p+"[i], "+p+"[j])) { "+b+" = false; break outer; } } } ";else {r+=" var itemIndices = {}, item; for (;i--;) { var item = "+p+"[i]; ";var S="checkDataType"+(v?"s":"");r+=" if ("+e.util[S](_,"item",e.opts.strictNumbers,true)+") continue; ",v&&(r+=` if (typeof item == 'string') item = '"' + item; `),r+=" if (typeof itemIndices[item] == 'number') { "+b+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } ";}r+=" } ",c&&(r+="  }  "),r+=" if (!"+b+") {   ";var j=j||[];j.push(r),r="",e.createErrors!==false?(r+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { i: i, j: j } ",e.opts.messages!==false&&(r+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(r+=" , schema:  ",c?r+="validate.schema"+l:r+=""+i,r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+p+" "),r+=" } "):r+=" {} ";var I=r;r=j.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+I+"]); ":r+=" validate.errors = ["+I+"]; return false; ":r+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",f&&(r+=" else { ");}else f&&(r+=" if (true) { ");return r}),Ca}var Ia,An;function vu(){return An||(An=1,Ia={$ref:Wl(),allOf:Yl(),anyOf:Xl(),$comment:eu(),const:ru(),contains:tu(),dependencies:au(),enum:su(),format:nu(),if:iu(),items:ou(),maximum:yn(),minimum:yn(),maxItems:Pn(),minItems:Pn(),maxLength:Sn(),minLength:Sn(),maxProperties:wn(),minProperties:wn(),multipleOf:lu(),not:uu(),oneOf:cu(),pattern:du(),properties:hu(),propertyNames:fu(),required:mu(),uniqueItems:pu(),validate:rn()}),Ia}var Aa,Dn;function gu(){if(Dn)return Aa;Dn=1;var s=vu(),e=Ar().toHash;return Aa=function(){var a=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"],n=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],o=["number","integer","string","array","object","boolean","null"];return a.all=e(r),a.types=e(o),a.forEach(function(i){i.rules=i.rules.map(function(l){var d;if(typeof l=="object"){var f=Object.keys(l)[0];d=l[f],l=f,d.forEach(function(b){r.push(b),a.all[b]=true;});}r.push(l);var p=a.all[l]={keyword:l,code:s[l],implements:d};return p}),a.all.$comment={keyword:"$comment",code:s.$comment},i.type&&(a.types[i.type]=i);}),a.keywords=e(r.concat(n)),a.custom={},a},Aa}var Da,Nn;function yu(){if(Nn)return Da;Nn=1;var s=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];return Da=function(e,t){for(var a=0;a<t.length;a++){e=JSON.parse(JSON.stringify(e));var r=t[a].split("/"),n=e,o;for(o=1;o<r.length;o++)n=n[r[o]];for(o=0;o<s.length;o++){var i=s[o],l=n[i];l&&(n[i]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]});}}return e},Da}var Na,jn;function _u(){if(jn)return Na;jn=1;var s=aa().MissingRef;Na=e;function e(t,a,r){var n=this;if(typeof this._opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");typeof a=="function"&&(r=a,a=void 0);var o=i(t).then(function(){var d=n._addSchema(t,void 0,a);return d.validate||l(d)});return r&&o.then(function(d){r(null,d);},r),o;function i(d){var f=d.$schema;return f&&!n.getSchema(f)?e.call(n,{$ref:f},true):Promise.resolve()}function l(d){try{return n._compile(d)}catch(p){if(p instanceof s)return f(p);throw p}function f(p){var b=p.missingSchema;if(_(b))throw new Error("Schema "+b+" is loaded but "+p.missingRef+" cannot be resolved");var c=n._loadingSchemas[b];return c||(c=n._loadingSchemas[b]=n._opts.loadSchema(b),c.then(h,h)),c.then(function(v){if(!_(b))return i(v).then(function(){_(b)||n.addSchema(v,b,void 0,a);})}).then(function(){return l(d)});function h(){delete n._loadingSchemas[b];}function _(v){return n._refs[v]||n._schemas[v]}}}}return Na}var ja,Fn;function Pu(){return Fn||(Fn=1,ja=function(e,t,a){var r=" ",n=e.level,o=e.dataLevel,i=e.schema[t],l=e.schemaPath+e.util.getProperty(t),d=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,p,b="data"+(o||""),c="valid"+n,h="errs__"+n,_=e.opts.$data&&i&&i.$data,v;_?(r+=" var schema"+n+" = "+e.util.getData(i.$data,o,e.dataPathArr)+"; ",v="schema"+n):v=i;var S=this,j="definition"+n,I=S.definition,P="",R,C,A,D,N;if(_&&I.$data){N="keywordValidate"+n;var E=I.validateSchema;r+=" var "+j+" = RULES.custom['"+t+"'].definition; var "+N+" = "+j+".validate;";}else {if(D=e.useCustomRule(S,i,e.schema,e),!D)return;v="validate.schema"+l,N=D.code,R=I.compile,C=I.inline,A=I.macro;}var $=N+".errors",F="i"+n,M="ruleErr"+n,z=I.async;if(z&&!e.async)throw new Error("async keyword in sync schema");if(C||A||(r+=""+$+" = null;"),r+="var "+h+" = errors;var "+c+";",_&&I.$data&&(P+="}",r+=" if ("+v+" === undefined) { "+c+" = true; } else { ",E&&(P+="}",r+=" "+c+" = "+j+".validateSchema("+v+"); if ("+c+") { ")),C)I.statements?r+=" "+D.validate+" ":r+=" "+c+" = "+D.validate+"; ";else if(A){var G=e.util.copy(e),P="";G.level++;var ne="valid"+G.level;G.schema=D.validate,G.schemaPath="";var X=e.compositeRule;e.compositeRule=G.compositeRule=true;var le=e.validate(G).replace(/validate\.schema/g,N);e.compositeRule=G.compositeRule=X,r+=" "+le;}else {var te=te||[];te.push(r),r="",r+="  "+N+".call( ",e.opts.passContext?r+="this":r+="self",R||I.schema===false?r+=" , "+b+" ":r+=" , "+v+" , "+b+" , validate.schema"+e.schemaPath+" ",r+=" , (dataPath || '')",e.errorPath!='""'&&(r+=" + "+e.errorPath);var ae=o?"data"+(o-1||""):"parentData",He=o?e.dataPathArr[o]:"parentDataProperty";r+=" , "+ae+" , "+He+" , rootData )  ";var Me=r;r=te.pop(),I.errors===false?(r+=" "+c+" = ",z&&(r+="await "),r+=""+Me+"; "):z?($="customErrors"+n,r+=" var "+$+" = null; try { "+c+" = await "+Me+"; } catch (e) { "+c+" = false; if (e instanceof ValidationError) "+$+" = e.errors; else throw e; } "):r+=" "+$+" = null; "+c+" = "+Me+"; ";}if(I.modifying&&(r+=" if ("+ae+") "+b+" = "+ae+"["+He+"];"),r+=""+P,I.valid)f&&(r+=" if (true) { ");else {r+=" if ( ",I.valid===void 0?(r+=" !",A?r+=""+ne:r+=""+c):r+=" "+!I.valid+" ",r+=") { ",p=S.keyword;var te=te||[];te.push(r),r="";var te=te||[];te.push(r),r="",e.createErrors!==false?(r+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { keyword: '"+S.keyword+"' } ",e.opts.messages!==false&&(r+=` , message: 'should pass "`+S.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+b+" "),r+=" } "):r+=" {} ";var Le=r;r=te.pop(),!e.compositeRule&&f?e.async?r+=" throw new ValidationError(["+Le+"]); ":r+=" validate.errors = ["+Le+"]; return false; ":r+=" var err = "+Le+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var Ie=r;r=te.pop(),C?I.errors?I.errors!="full"&&(r+="  for (var "+F+"="+h+"; "+F+"<errors; "+F+"++) { var "+M+" = vErrors["+F+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+M+".schemaPath === undefined) { "+M+'.schemaPath = "'+d+'"; } ',e.opts.verbose&&(r+=" "+M+".schema = "+v+"; "+M+".data = "+b+"; "),r+=" } "):I.errors===false?r+=" "+Ie+" ":(r+=" if ("+h+" == errors) { "+Ie+" } else {  for (var "+F+"="+h+"; "+F+"<errors; "+F+"++) { var "+M+" = vErrors["+F+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+M+".schemaPath === undefined) { "+M+'.schemaPath = "'+d+'"; } ',e.opts.verbose&&(r+=" "+M+".schema = "+v+"; "+M+".data = "+b+"; "),r+=" } } "):A?(r+="   var err =   ",e.createErrors!==false?(r+=" { keyword: '"+(p||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(d)+" , params: { keyword: '"+S.keyword+"' } ",e.opts.messages!==false&&(r+=` , message: 'should pass "`+S.keyword+`" keyword validation' `),e.opts.verbose&&(r+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+b+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; ")):I.errors===false?r+=" "+Ie+" ":(r+=" if (Array.isArray("+$+")) { if (vErrors === null) vErrors = "+$+"; else vErrors = vErrors.concat("+$+"); errors = vErrors.length;  for (var "+F+"="+h+"; "+F+"<errors; "+F+"++) { var "+M+" = vErrors["+F+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+";  "+M+'.schemaPath = "'+d+'";  ',e.opts.verbose&&(r+=" "+M+".schema = "+v+"; "+M+".data = "+b+"; "),r+=" } } else { "+Ie+" } "),r+=" } ",f&&(r+=" else { ");}return r}),ja}const qn={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:true,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:true,readOnly:{type:"boolean",default:false},examples:{type:"array",items:true},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:true},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:false},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:true,enum:{type:"array",items:true,minItems:1,uniqueItems:true},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:true}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:true};var Fa,Ln;function bu(){if(Ln)return Fa;Ln=1;var s=qn;return Fa={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:s.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:s.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},Fa}var qa,Mn;function Su(){if(Mn)return qa;Mn=1;var s=/^[a-z_$][a-z0-9_$-]*$/i,e=Pu(),t=bu();qa={add:a,get:r,remove:n,validate:o};function a(i,l){var d=this.RULES;if(d.keywords[i])throw new Error("Keyword "+i+" is already defined");if(!s.test(i))throw new Error("Keyword "+i+" is not a valid identifier");if(l){this.validateKeyword(l,true);var f=l.type;if(Array.isArray(f))for(var p=0;p<f.length;p++)c(i,f[p],l);else c(i,f,l);var b=l.metaSchema;b&&(l.$data&&this._opts.$data&&(b={anyOf:[b,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),l.validateSchema=this.compile(b,true));}d.keywords[i]=d.all[i]=true;function c(h,_,v){for(var S,j=0;j<d.length;j++){var I=d[j];if(I.type==_){S=I;break}}S||(S={type:_,rules:[]},d.push(S));var P={keyword:h,definition:v,custom:true,code:e,implements:v.implements};S.rules.push(P),d.custom[h]=P;}return this}function r(i){var l=this.RULES.custom[i];return l?l.definition:this.RULES.keywords[i]||false}function n(i){var l=this.RULES;delete l.keywords[i],delete l.all[i],delete l.custom[i];for(var d=0;d<l.length;d++)for(var f=l[d].rules,p=0;p<f.length;p++)if(f[p].keyword==i){f.splice(p,1);break}return this}function o(i,l){o.errors=null;var d=this._validateKeyword=this._validateKeyword||this.compile(t,true);if(d(i))return  true;if(o.errors=d.errors,l)throw new Error("custom keyword definition is invalid: "+this.errorsText(d.errors));return  false}return qa}const Eu={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:false};var La,zn;function wu(){if(zn)return La;zn=1;var s=Jl(),e=ra(),t=Kl(),a=Js(),r=Xs(),n=Gl(),o=gu(),i=yu(),l=Ar();La=h,h.prototype.validate=_,h.prototype.compile=v,h.prototype.addSchema=S,h.prototype.addMetaSchema=j,h.prototype.validateSchema=I,h.prototype.getSchema=R,h.prototype.removeSchema=D,h.prototype.addFormat=X,h.prototype.errorsText=ne,h.prototype._addSchema=E,h.prototype._compile=$,h.prototype.compileAsync=_u();var d=Su();h.prototype.addKeyword=d.add,h.prototype.getKeyword=d.get,h.prototype.removeKeyword=d.remove,h.prototype.validateKeyword=d.validate;var f=aa();h.ValidationError=f.Validation,h.MissingRefError=f.MissingRef,h.$dataMetaSchema=i;var p="http://json-schema.org/draft-07/schema",b=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],c=["/properties"];function h(w){if(!(this instanceof h))return new h(w);w=this._opts=l.copy(w)||{},Ie(this),this._schemas={},this._refs={},this._fragments={},this._formats=n(w.format),this._cache=w.cache||new t,this._loadingSchemas={},this._compilations=[],this.RULES=o(),this._getId=F(w),w.loopRequired=w.loopRequired||1/0,w.errorDataPath=="property"&&(w._errorDataPathProperty=true),w.serialize===void 0&&(w.serialize=r),this._metaOpts=Le(this),w.formats&&ae(this),w.keywords&&He(this),le(this),typeof w.meta=="object"&&this.addMetaSchema(w.meta),w.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),te(this);}function _(w,q){var Q;if(typeof w=="string"){if(Q=this.getSchema(w),!Q)throw new Error('no schema with key or ref "'+w+'"')}else {var re=this._addSchema(w);Q=re.validate||this._compile(re);}var L=Q(q);return Q.$async!==true&&(this.errors=Q.errors),L}function v(w,q){var Q=this._addSchema(w,void 0,q);return Q.validate||this._compile(Q)}function S(w,q,Q,re){if(Array.isArray(w)){for(var L=0;L<w.length;L++)this.addSchema(w[L],void 0,Q,re);return this}var V=this._getId(w);if(V!==void 0&&typeof V!="string")throw new Error("schema id must be string");return q=e.normalizeId(q||V),Me(this,q),this._schemas[q]=this._addSchema(w,Q,re,true),this}function j(w,q,Q){return this.addSchema(w,q,Q,true),this}function I(w,q){var Q=w.$schema;if(Q!==void 0&&typeof Q!="string")throw new Error("$schema must be a string");if(Q=Q||this._opts.defaultMeta||P(this),!Q)return this.logger.warn("meta-schema not available"),this.errors=null,true;var re=this.validate(Q,w);if(!re&&q){var L="schema is invalid: "+this.errorsText();if(this._opts.validateSchema=="log")this.logger.error(L);else throw new Error(L)}return re}function P(w){var q=w._opts.meta;return w._opts.defaultMeta=typeof q=="object"?w._getId(q)||q:w.getSchema(p)?p:void 0,w._opts.defaultMeta}function R(w){var q=A(this,w);switch(typeof q){case "object":return q.validate||this._compile(q);case "string":return this.getSchema(q);case "undefined":return C(this,w)}}function C(w,q){var Q=e.schema.call(w,{schema:{}},q);if(Q){var re=Q.schema,L=Q.root,V=Q.baseId,oe=s.call(w,re,L,void 0,V);return w._fragments[q]=new a({ref:q,fragment:true,schema:re,root:L,baseId:V,validate:oe}),oe}}function A(w,q){return q=e.normalizeId(q),w._schemas[q]||w._refs[q]||w._fragments[q]}function D(w){if(w instanceof RegExp)return N(this,this._schemas,w),N(this,this._refs,w),this;switch(typeof w){case "undefined":return N(this,this._schemas),N(this,this._refs),this._cache.clear(),this;case "string":var q=A(this,w);return q&&this._cache.del(q.cacheKey),delete this._schemas[w],delete this._refs[w],this;case "object":var Q=this._opts.serialize,re=Q?Q(w):w;this._cache.del(re);var L=this._getId(w);L&&(L=e.normalizeId(L),delete this._schemas[L],delete this._refs[L]);}return this}function N(w,q,Q){for(var re in q){var L=q[re];!L.meta&&(!Q||Q.test(re))&&(w._cache.del(L.cacheKey),delete q[re]);}}function E(w,q,Q,re){if(typeof w!="object"&&typeof w!="boolean")throw new Error("schema should be object or boolean");var L=this._opts.serialize,V=L?L(w):w,oe=this._cache.get(V);if(oe)return oe;re=re||this._opts.addUsedSchema!==false;var he=e.normalizeId(this._getId(w));he&&re&&Me(this,he);var ue=this._opts.validateSchema!==false&&!q,Re;ue&&!(Re=he&&he==e.normalizeId(w.$schema))&&this.validateSchema(w,true);var ge=e.ids.call(this,w),ye=new a({id:he,schema:w,localRefs:ge,cacheKey:V,meta:Q});return he[0]!="#"&&re&&(this._refs[he]=ye),this._cache.put(V,ye),ue&&Re&&this.validateSchema(w,true),ye}function $(w,q){if(w.compiling)return w.validate=L,L.schema=w.schema,L.errors=null,L.root=q||L,w.schema.$async===true&&(L.$async=true),L;w.compiling=true;var Q;w.meta&&(Q=this._opts,this._opts=this._metaOpts);var re;try{re=s.call(this,w.schema,q,w.localRefs);}catch(V){throw delete w.validate,V}finally{w.compiling=false,w.meta&&(this._opts=Q);}return w.validate=re,w.refs=re.refs,w.refVal=re.refVal,w.root=re.root,re;function L(){var V=w.validate,oe=V.apply(this,arguments);return L.errors=V.errors,oe}}function F(w){switch(w.schemaId){case "auto":return G;case "id":return M;default:return z}}function M(w){return w.$id&&this.logger.warn("schema $id ignored",w.$id),w.id}function z(w){return w.id&&this.logger.warn("schema id ignored",w.id),w.$id}function G(w){if(w.$id&&w.id&&w.$id!=w.id)throw new Error("schema $id is different from id");return w.$id||w.id}function ne(w,q){if(w=w||this.errors,!w)return "No errors";q=q||{};for(var Q=q.separator===void 0?", ":q.separator,re=q.dataVar===void 0?"data":q.dataVar,L="",V=0;V<w.length;V++){var oe=w[V];oe&&(L+=re+oe.dataPath+" "+oe.message+Q);}return L.slice(0,-Q.length)}function X(w,q){return typeof q=="string"&&(q=new RegExp(q)),this._formats[w]=q,this}function le(w){var q;if(w._opts.$data&&(q=Eu,w.addMetaSchema(q,q.$id,true)),w._opts.meta!==false){var Q=qn;w._opts.$data&&(Q=i(Q,c)),w.addMetaSchema(Q,p,true),w._refs["http://json-schema.org/schema"]=p;}}function te(w){var q=w._opts.schemas;if(q)if(Array.isArray(q))w.addSchema(q);else for(var Q in q)w.addSchema(q[Q],Q);}function ae(w){for(var q in w._opts.formats){var Q=w._opts.formats[q];w.addFormat(q,Q);}}function He(w){for(var q in w._opts.keywords){var Q=w._opts.keywords[q];w.addKeyword(q,Q);}}function Me(w,q){if(w._schemas[q]||w._refs[q])throw new Error('schema with key or id "'+q+'" already exists')}function Le(w){for(var q=l.copy(w._opts),Q=0;Q<b.length;Q++)delete q[b[Q]];return q}function Ie(w){var q=w._opts.logger;if(q===false)w.logger={log:er,warn:er,error:er};else {if(q===void 0&&(q=console),!(typeof q=="object"&&q.log&&q.warn&&q.error))throw new Error("logger must implement log, warn and error methods");w.logger=q;}}function er(){}return La}var Ru=wu();const xu=Ul(Ru);class $u extends zl{constructor(e,t){var a;super(t),this._serverInfo=e,this._capabilities=(a=t?.capabilities)!==null&&a!==void 0?a:{},this._instructions=t?.instructions,this.setRequestHandler(Cs,r=>this._oninitialize(r)),this.setNotificationHandler(Is,()=>{var r;return (r=this.oninitialized)===null||r===void 0?void 0:r.call(this)});}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");this._capabilities=Zl(this._capabilities,e);}assertCapabilityForMethod(e){var t,a,r;switch(e){case "sampling/createMessage":if(!(!((t=this._clientCapabilities)===null||t===void 0)&&t.sampling))throw new Error(`Client does not support sampling (required for ${e})`);break;case "elicitation/create":if(!(!((a=this._clientCapabilities)===null||a===void 0)&&a.elicitation))throw new Error(`Client does not support elicitation (required for ${e})`);break;case "roots/list":if(!(!((r=this._clientCapabilities)===null||r===void 0)&&r.roots))throw new Error(`Client does not support listing roots (required for ${e})`);break}}assertNotificationCapability(e){switch(e){case "notifications/message":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case "notifications/resources/updated":case "notifications/resources/list_changed":if(!this._capabilities.resources)throw new Error(`Server does not support notifying about resources (required for ${e})`);break;case "notifications/tools/list_changed":if(!this._capabilities.tools)throw new Error(`Server does not support notifying of tool list changes (required for ${e})`);break;case "notifications/prompts/list_changed":if(!this._capabilities.prompts)throw new Error(`Server does not support notifying of prompt list changes (required for ${e})`);break}}assertRequestHandlerCapability(e){switch(e){case "sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Server does not support sampling (required for ${e})`);break;case "logging/setLevel":if(!this._capabilities.logging)throw new Error(`Server does not support logging (required for ${e})`);break;case "prompts/get":case "prompts/list":if(!this._capabilities.prompts)throw new Error(`Server does not support prompts (required for ${e})`);break;case "resources/list":case "resources/templates/list":case "resources/read":if(!this._capabilities.resources)throw new Error(`Server does not support resources (required for ${e})`);break;case "tools/call":case "tools/list":if(!this._capabilities.tools)throw new Error(`Server does not support tools (required for ${e})`);break}}async _oninitialize(e){const t=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Qo.includes(t)?t:Ss,capabilities:this.getCapabilities(),serverInfo:this._serverInfo,...this._instructions&&{instructions:this._instructions}}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return this._capabilities}async ping(){return this.request({method:"ping"},It)}async createMessage(e,t){return this.request({method:"sampling/createMessage",params:e},Ms,t)}async elicitInput(e,t){const a=await this.request({method:"elicitation/create",params:e},zs,t);if(a.action==="accept"&&a.content)try{const r=new xu,n=r.compile(e.requestedSchema);if(!n(a.content))throw new Ce(Oe.InvalidParams,`Elicitation response content does not match requested schema: ${r.errorsText(n.errors)}`)}catch(r){throw r instanceof Ce?r:new Ce(Oe.InternalError,`Error validating elicitation response: ${r}`)}return a}async listRoots(e,t){return this.request({method:"roots/list",params:e},Zs,t)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}}const Ou=Symbol("Let zodToJsonSchema decide on which parser to use"),Zn={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:true,rejectedAdditionalProperties:false,definitionPath:"definitions",target:"jsonSchema7",strictUnions:false,definitions:{},errorMessages:false,markdownDescription:false,patternStrategy:"escape",applyRegexFlags:false,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Tu=s=>typeof s=="string"?{...Zn,name:s}:{...Zn,...s},ku=s=>{const e=Tu(s),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return {...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([a,r])=>[r._def,{def:r._def,path:[...e.basePath,e.definitionPath,a],jsonSchema:void 0}]))}};function Un(s,e,t,a){a?.errorMessages&&t&&(s.errorMessage={...s.errorMessage,[e]:t});}function be(s,e,t,a,r){s[e]=t,Un(s,e,a,r);}function Cu(){return {}}function Iu(s,e){const t={type:"array"};return s.type?._def&&s.type?._def?.typeName!==U.ZodAny&&(t.items=ve(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&be(t,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&be(t,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(be(t,"minItems",s.exactLength.value,s.exactLength.message,e),be(t,"maxItems",s.exactLength.value,s.exactLength.message,e)),t}function Au(s,e){const t={type:"integer",format:"int64"};if(!s.checks)return t;for(const a of s.checks)switch(a.kind){case "min":e.target==="jsonSchema7"?a.inclusive?be(t,"minimum",a.value,a.message,e):be(t,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(t.exclusiveMinimum=true),be(t,"minimum",a.value,a.message,e));break;case "max":e.target==="jsonSchema7"?a.inclusive?be(t,"maximum",a.value,a.message,e):be(t,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(t.exclusiveMaximum=true),be(t,"maximum",a.value,a.message,e));break;case "multipleOf":be(t,"multipleOf",a.value,a.message,e);break}return t}function Du(){return {type:"boolean"}}function Hn(s,e){return ve(s.type._def,e)}const Nu=(s,e)=>ve(s.innerType._def,e);function Vn(s,e,t){const a=t??e.dateStrategy;if(Array.isArray(a))return {anyOf:a.map((r,n)=>Vn(s,e,r))};switch(a){case "string":case "format:date-time":return {type:"string",format:"date-time"};case "format:date":return {type:"string",format:"date"};case "integer":return ju(s,e)}}const ju=(s,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const a of s.checks)switch(a.kind){case "min":be(t,"minimum",a.value,a.message,e);break;case "max":be(t,"maximum",a.value,a.message,e);break}return t};function Fu(s,e){return {...ve(s.innerType._def,e),default:s.defaultValue()}}function qu(s,e){return e.effectStrategy==="input"?ve(s.schema._def,e):{}}function Lu(s){return {type:"string",enum:Array.from(s.values)}}const Mu=s=>"type"in s&&s.type==="string"?false:"allOf"in s;function zu(s,e){const t=[ve(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),ve(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(n=>!!n);let a=e.target==="jsonSchema2019-09"?{unevaluatedProperties:false}:void 0;const r=[];return t.forEach(n=>{if(Mu(n))r.push(...n.allOf),n.unevaluatedProperties===void 0&&(a=void 0);else {let o=n;if("additionalProperties"in n&&n.additionalProperties===false){const{additionalProperties:i,...l}=n;o=l;}else a=void 0;r.push(o);}}),r.length?{allOf:r,...a}:void 0}function Zu(s,e){const t=typeof s.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[s.value]}:{type:t==="bigint"?"integer":t,const:s.value}}let Ma;const tr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ma===void 0&&(Ma=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ma),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Bn(s,e){const t={type:"string"};if(s.checks)for(const a of s.checks)switch(a.kind){case "min":be(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,a.value):a.value,a.message,e);break;case "max":be(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,a.value):a.value,a.message,e);break;case "email":switch(e.emailStrategy){case "format:email":ar(t,"email",a.message,e);break;case "format:idn-email":ar(t,"idn-email",a.message,e);break;case "pattern:zod":Ue(t,tr.email,a.message,e);break}break;case "url":ar(t,"uri",a.message,e);break;case "uuid":ar(t,"uuid",a.message,e);break;case "regex":Ue(t,a.regex,a.message,e);break;case "cuid":Ue(t,tr.cuid,a.message,e);break;case "cuid2":Ue(t,tr.cuid2,a.message,e);break;case "startsWith":Ue(t,RegExp(`^${za(a.value,e)}`),a.message,e);break;case "endsWith":Ue(t,RegExp(`${za(a.value,e)}$`),a.message,e);break;case "datetime":ar(t,"date-time",a.message,e);break;case "date":ar(t,"date",a.message,e);break;case "time":ar(t,"time",a.message,e);break;case "duration":ar(t,"duration",a.message,e);break;case "length":be(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,a.value):a.value,a.message,e),be(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,a.value):a.value,a.message,e);break;case "includes":{Ue(t,RegExp(za(a.value,e)),a.message,e);break}case "ip":{a.version!=="v6"&&ar(t,"ipv4",a.message,e),a.version!=="v4"&&ar(t,"ipv6",a.message,e);break}case "base64url":Ue(t,tr.base64url,a.message,e);break;case "jwt":Ue(t,tr.jwt,a.message,e);break;case "cidr":{a.version!=="v6"&&Ue(t,tr.ipv4Cidr,a.message,e),a.version!=="v4"&&Ue(t,tr.ipv6Cidr,a.message,e);break}case "emoji":Ue(t,tr.emoji(),a.message,e);break;case "ulid":{Ue(t,tr.ulid,a.message,e);break}case "base64":{switch(e.base64Strategy){case "format:binary":{ar(t,"binary",a.message,e);break}case "contentEncoding:base64":{be(t,"contentEncoding","base64",a.message,e);break}case "pattern:zod":{Ue(t,tr.base64,a.message,e);break}}break}case "nanoid":Ue(t,tr.nanoid,a.message,e);}return t}function za(s,e){return e.patternStrategy==="escape"?Hu(s):s}const Uu=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Hu(s){let e="";for(let t=0;t<s.length;t++)Uu.has(s[t])||(e+="\\"),e+=s[t];return e}function ar(s,e,t,a){s.format||s.anyOf?.some(r=>r.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&a.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...t&&a.errorMessages&&{errorMessage:{format:t}}})):be(s,"format",e,t,a);}function Ue(s,e,t,a){s.pattern||s.allOf?.some(r=>r.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&a.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:Qn(e,a),...t&&a.errorMessages&&{errorMessage:{pattern:t}}})):be(s,"pattern",Qn(e,a),t,a);}function Qn(s,e){if(!e.applyRegexFlags||!s.flags)return s.source;const t={i:s.flags.includes("i"),m:s.flags.includes("m"),s:s.flags.includes("s")},a=t.i?s.source.toLowerCase():s.source;let r="",n=false,o=false,i=false;for(let l=0;l<a.length;l++){if(n){r+=a[l],n=false;continue}if(t.i){if(o){if(a[l].match(/[a-z]/)){i?(r+=a[l],r+=`${a[l-2]}-${a[l]}`.toUpperCase(),i=false):a[l+1]==="-"&&a[l+2]?.match(/[a-z]/)?(r+=a[l],i=true):r+=`${a[l]}${a[l].toUpperCase()}`;continue}}else if(a[l].match(/[a-z]/)){r+=`[${a[l]}${a[l].toUpperCase()}]`;continue}}if(t.m){if(a[l]==="^"){r+=`(^|(?<=[\r
]))`;continue}else if(a[l]==="$"){r+=`($|(?=[\r
]))`;continue}}if(t.s&&a[l]==="."){r+=o?`${a[l]}\r
`:`[${a[l]}\r
]`;continue}r+=a[l],a[l]==="\\"?n=true:o&&a[l]==="]"?o=false:!o&&a[l]==="["&&(o=true);}try{new RegExp(r);}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),s.source}return r}function Jn(s,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&s.keyType?._def.typeName===U.ZodEnum)return {type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((a,r)=>({...a,[r]:ve(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",r]})??{}}),{}),additionalProperties:e.rejectedAdditionalProperties};const t={type:"object",additionalProperties:ve(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??e.allowedAdditionalProperties};if(e.target==="openApi3")return t;if(s.keyType?._def.typeName===U.ZodString&&s.keyType._def.checks?.length){const{type:a,...r}=Bn(s.keyType._def,e);return {...t,propertyNames:r}}else {if(s.keyType?._def.typeName===U.ZodEnum)return {...t,propertyNames:{enum:s.keyType._def.values}};if(s.keyType?._def.typeName===U.ZodBranded&&s.keyType._def.type._def.typeName===U.ZodString&&s.keyType._def.type._def.checks?.length){const{type:a,...r}=Hn(s.keyType._def,e);return {...t,propertyNames:r}}}return t}function Vu(s,e){if(e.mapStrategy==="record")return Jn(s,e);const t=ve(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},a=ve(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return {type:"array",maxItems:125,items:{type:"array",items:[t,a],minItems:2,maxItems:2}}}function Bu(s){const e=s.values,a=Object.keys(s.values).filter(n=>typeof e[e[n]]!="number").map(n=>e[n]),r=Array.from(new Set(a.map(n=>typeof n)));return {type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:a}}function Qu(){return {not:{}}}function Ju(s){return s.target==="openApi3"?{enum:["null"],nullable:true}:{type:"null"}}const ht={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function Ku(s,e){if(e.target==="openApi3")return Kn(s,e);const t=s.options instanceof Map?Array.from(s.options.values()):s.options;if(t.every(a=>a._def.typeName in ht&&(!a._def.checks||!a._def.checks.length))){const a=t.reduce((r,n)=>{const o=ht[n._def.typeName];return o&&!r.includes(o)?[...r,o]:r},[]);return {type:a.length>1?a:a[0]}}else if(t.every(a=>a._def.typeName==="ZodLiteral"&&!a.description)){const a=t.reduce((r,n)=>{const o=typeof n._def.value;switch(o){case "string":case "number":case "boolean":return [...r,o];case "bigint":return [...r,"integer"];case "object":if(n._def.value===null)return [...r,"null"];case "symbol":case "undefined":case "function":default:return r}},[]);if(a.length===t.length){const r=a.filter((n,o,i)=>i.indexOf(n)===o);return {type:r.length>1?r:r[0],enum:t.reduce((n,o)=>n.includes(o._def.value)?n:[...n,o._def.value],[])}}}else if(t.every(a=>a._def.typeName==="ZodEnum"))return {type:"string",enum:t.reduce((a,r)=>[...a,...r._def.values.filter(n=>!a.includes(n))],[])};return Kn(s,e)}const Kn=(s,e)=>{const t=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((a,r)=>ve(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(a=>!!a&&(!e.strictUnions||typeof a=="object"&&Object.keys(a).length>0));return t.length?{anyOf:t}:void 0};function Gu(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"?{type:ht[s.innerType._def.typeName],nullable:true}:{type:[ht[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const a=ve(s.innerType._def,{...e,currentPath:[...e.currentPath]});return a&&"$ref"in a?{allOf:[a],nullable:true}:a&&{...a,nullable:true}}const t=ve(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function Wu(s,e){const t={type:"number"};if(!s.checks)return t;for(const a of s.checks)switch(a.kind){case "int":t.type="integer",Un(t,"type",a.message,e);break;case "min":e.target==="jsonSchema7"?a.inclusive?be(t,"minimum",a.value,a.message,e):be(t,"exclusiveMinimum",a.value,a.message,e):(a.inclusive||(t.exclusiveMinimum=true),be(t,"minimum",a.value,a.message,e));break;case "max":e.target==="jsonSchema7"?a.inclusive?be(t,"maximum",a.value,a.message,e):be(t,"exclusiveMaximum",a.value,a.message,e):(a.inclusive||(t.exclusiveMaximum=true),be(t,"maximum",a.value,a.message,e));break;case "multipleOf":be(t,"multipleOf",a.value,a.message,e);break}return t}function Yu(s,e){const t=e.target==="openAi",a={type:"object",properties:{}},r=[],n=s.shape();for(const i in n){let l=n[i];if(l===void 0||l._def===void 0)continue;let d=ec(l);d&&t&&(l instanceof or&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),d=false);const f=ve(l._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});f!==void 0&&(a.properties[i]=f,d||r.push(i));}r.length&&(a.required=r);const o=Xu(s,e);return o!==void 0&&(a.additionalProperties=o),a}function Xu(s,e){if(s.catchall._def.typeName!=="ZodNever")return ve(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]});switch(s.unknownKeys){case "passthrough":return e.allowedAdditionalProperties;case "strict":return e.rejectedAdditionalProperties;case "strip":return e.removeAdditionalStrategy==="strict"?e.allowedAdditionalProperties:e.rejectedAdditionalProperties}}function ec(s){try{return s.isOptional()}catch{return  true}}const rc=(s,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return ve(s.innerType._def,e);const t=ve(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},tc=(s,e)=>{if(e.pipeStrategy==="input")return ve(s.in._def,e);if(e.pipeStrategy==="output")return ve(s.out._def,e);const t=ve(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),a=ve(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return {allOf:[t,a].filter(r=>r!==void 0)}};function ac(s,e){return ve(s.type._def,e)}function sc(s,e){const a={type:"array",uniqueItems:true,items:ve(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&be(a,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&be(a,"maxItems",s.maxSize.value,s.maxSize.message,e),a}function nc(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((t,a)=>ve(t._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((t,a)=>a===void 0?t:[...t,a],[]),additionalItems:ve(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((t,a)=>ve(t._def,{...e,currentPath:[...e.currentPath,"items",`${a}`]})).reduce((t,a)=>a===void 0?t:[...t,a],[])}}function ic(){return {not:{}}}function oc(){return {}}const lc=(s,e)=>ve(s.innerType._def,e),uc=(s,e,t)=>{switch(e){case U.ZodString:return Bn(s,t);case U.ZodNumber:return Wu(s,t);case U.ZodObject:return Yu(s,t);case U.ZodBigInt:return Au(s,t);case U.ZodBoolean:return Du();case U.ZodDate:return Vn(s,t);case U.ZodUndefined:return ic();case U.ZodNull:return Ju(t);case U.ZodArray:return Iu(s,t);case U.ZodUnion:case U.ZodDiscriminatedUnion:return Ku(s,t);case U.ZodIntersection:return zu(s,t);case U.ZodTuple:return nc(s,t);case U.ZodRecord:return Jn(s,t);case U.ZodLiteral:return Zu(s,t);case U.ZodEnum:return Lu(s);case U.ZodNativeEnum:return Bu(s);case U.ZodNullable:return Gu(s,t);case U.ZodOptional:return rc(s,t);case U.ZodMap:return Vu(s,t);case U.ZodSet:return sc(s,t);case U.ZodLazy:return ()=>s.getter()._def;case U.ZodPromise:return ac(s,t);case U.ZodNaN:case U.ZodNever:return Qu();case U.ZodEffects:return qu(s,t);case U.ZodAny:return Cu();case U.ZodUnknown:return oc();case U.ZodDefault:return Fu(s,t);case U.ZodBranded:return Hn(s,t);case U.ZodReadonly:return lc(s,t);case U.ZodCatch:return Nu(s,t);case U.ZodPipeline:return tc(s,t);case U.ZodFunction:case U.ZodVoid:case U.ZodSymbol:return;default:return (a=>{})()}};function ve(s,e,t=false){const a=e.seen.get(s);if(e.override){const i=e.override?.(s,e,a,t);if(i!==Ou)return i}if(a&&!t){const i=cc(a,e);if(i!==void 0)return i}const r={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,r);const n=uc(s,s.typeName,e),o=typeof n=="function"?ve(n(),e):n;if(o&&hc(s,e,o),e.postProcess){const i=e.postProcess(o,s,e);return r.jsonSchema=o,i}return r.jsonSchema=o,o}const cc=(s,e)=>{switch(e.$refStrategy){case "root":return {$ref:s.path.join("/")};case "relative":return {$ref:dc(e.currentPath,s.path)};case "none":case "seen":return s.path.length<e.currentPath.length&&s.path.every((t,a)=>e.currentPath[a]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},dc=(s,e)=>{let t=0;for(;t<s.length&&t<e.length&&s[t]===e[t];t++);return [(s.length-t).toString(),...e.slice(t)].join("/")},hc=(s,e,t)=>(s.description&&(t.description=s.description,e.markdownDescription&&(t.markdownDescription=s.description)),t),Gn=(s,e)=>{const t=ku(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((l,[d,f])=>({...l,[d]:ve(f._def,{...t,currentPath:[...t.basePath,t.definitionPath,d]},true)??{}}),{}):void 0,r=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,n=ve(s._def,r===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,r]},false)??{},o=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;o!==void 0&&(n.title=o);const i=r===void 0?a?{...n,[t.definitionPath]:a}:n:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...a,[r]:n}};return t.target==="jsonSchema7"?i.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(i.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i};var Za;(function(s){s.Completable="McpCompletable";})(Za||(Za={}));class Ua extends ce{_parse(e){const{ctx:t}=this._processInputParams(e),a=t.data;return this._def.type._parse({data:a,path:t.path,parent:t})}unwrap(){return this._def.type}}Ua.create=(s,e)=>new Ua({type:s,typeName:Za.Completable,complete:e.complete,...fc(e)});function fc(s){if(!s)return {};const{errorMap:e,invalid_type_error:t,required_error:a,description:r}=s;if(e&&(t||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,i)=>{var l,d;const{message:f}=s;return o.code==="invalid_enum_value"?{message:f??i.defaultError}:typeof i.data>"u"?{message:(l=f??a)!==null&&l!==void 0?l:i.defaultError}:o.code!=="invalid_type"?{message:i.defaultError}:{message:(d=f??t)!==null&&d!==void 0?d:i.defaultError}},description:r}}class mc{constructor(e,t){this._registeredResources={},this._registeredResourceTemplates={},this._registeredTools={},this._registeredPrompts={},this._toolHandlersInitialized=false,this._completionHandlerInitialized=false,this._resourceHandlersInitialized=false,this._promptHandlersInitialized=false,this.server=new $u(e,t);}async connect(e){return await this.server.connect(e)}async close(){await this.server.close();}setToolRequestHandlers(){this._toolHandlersInitialized||(this.server.assertCanSetRequestHandler(Vt.shape.method.value),this.server.assertCanSetRequestHandler(Bt.shape.method.value),this.server.registerCapabilities({tools:{listChanged:true}}),this.server.setRequestHandler(Vt,()=>({tools:Object.entries(this._registeredTools).filter(([,e])=>e.enabled).map(([e,t])=>{const a={name:e,title:t.title,description:t.description,inputSchema:t.inputSchema?Gn(t.inputSchema,{strictUnions:true}):pc,annotations:t.annotations};return t.outputSchema&&(a.outputSchema=Gn(t.outputSchema,{strictUnions:true})),a})})),this.server.setRequestHandler(Bt,async(e,t)=>{const a=this._registeredTools[e.params.name];if(!a)throw new Ce(Oe.InvalidParams,`Tool ${e.params.name} not found`);if(!a.enabled)throw new Ce(Oe.InvalidParams,`Tool ${e.params.name} disabled`);let r;if(a.inputSchema){const n=await a.inputSchema.safeParseAsync(e.params.arguments);if(!n.success)throw new Ce(Oe.InvalidParams,`Invalid arguments for tool ${e.params.name}: ${n.error.message}`);const o=n.data,i=a.callback;try{r=await Promise.resolve(i(o,t));}catch(l){r={content:[{type:"text",text:l instanceof Error?l.message:String(l)}],isError:true};}}else {const n=a.callback;try{r=await Promise.resolve(n(t));}catch(o){r={content:[{type:"text",text:o instanceof Error?o.message:String(o)}],isError:true};}}if(a.outputSchema&&!r.isError){if(!r.structuredContent)throw new Ce(Oe.InvalidParams,`Tool ${e.params.name} has an output schema but no structured content was provided`);const n=await a.outputSchema.safeParseAsync(r.structuredContent);if(!n.success)throw new Ce(Oe.InvalidParams,`Invalid structured content for tool ${e.params.name}: ${n.error.message}`)}return r}),this._toolHandlersInitialized=true);}setCompletionRequestHandler(){this._completionHandlerInitialized||(this.server.assertCanSetRequestHandler(Qt.shape.method.value),this.server.registerCapabilities({completions:{}}),this.server.setRequestHandler(Qt,async e=>{switch(e.params.ref.type){case "ref/prompt":return this.handlePromptCompletion(e,e.params.ref);case "ref/resource":return this.handleResourceCompletion(e,e.params.ref);default:throw new Ce(Oe.InvalidParams,`Invalid completion reference: ${e.params.ref}`)}}),this._completionHandlerInitialized=true);}async handlePromptCompletion(e,t){const a=this._registeredPrompts[t.name];if(!a)throw new Ce(Oe.InvalidParams,`Prompt ${t.name} not found`);if(!a.enabled)throw new Ce(Oe.InvalidParams,`Prompt ${t.name} disabled`);if(!a.argsSchema)return ft;const r=a.argsSchema.shape[e.params.argument.name];if(!(r instanceof Ua))return ft;const o=await r._def.complete(e.params.argument.value,e.params.context);return Yn(o)}async handleResourceCompletion(e,t){const a=Object.values(this._registeredResourceTemplates).find(o=>o.resourceTemplate.uriTemplate.toString()===t.uri);if(!a){if(this._registeredResources[t.uri])return ft;throw new Ce(Oe.InvalidParams,`Resource template ${e.params.ref.uri} not found`)}const r=a.resourceTemplate.completeCallback(e.params.argument.name);if(!r)return ft;const n=await r(e.params.argument.value,e.params.context);return Yn(n)}setResourceRequestHandlers(){this._resourceHandlersInitialized||(this.server.assertCanSetRequestHandler(Ft.shape.method.value),this.server.assertCanSetRequestHandler(qt.shape.method.value),this.server.assertCanSetRequestHandler(Lt.shape.method.value),this.server.registerCapabilities({resources:{listChanged:true}}),this.server.setRequestHandler(Ft,async(e,t)=>{const a=Object.entries(this._registeredResources).filter(([n,o])=>o.enabled).map(([n,o])=>({uri:n,name:o.name,...o.metadata})),r=[];for(const n of Object.values(this._registeredResourceTemplates)){if(!n.resourceTemplate.listCallback)continue;const o=await n.resourceTemplate.listCallback(t);for(const i of o.resources)r.push({...n.metadata,...i});}return {resources:[...a,...r]}}),this.server.setRequestHandler(qt,async()=>({resourceTemplates:Object.entries(this._registeredResourceTemplates).map(([t,a])=>({name:t,uriTemplate:a.resourceTemplate.uriTemplate.toString(),...a.metadata}))})),this.server.setRequestHandler(Lt,async(e,t)=>{const a=new URL(e.params.uri),r=this._registeredResources[a.toString()];if(r){if(!r.enabled)throw new Ce(Oe.InvalidParams,`Resource ${a} disabled`);return r.readCallback(a,t)}for(const n of Object.values(this._registeredResourceTemplates)){const o=n.resourceTemplate.uriTemplate.match(a.toString());if(o)return n.readCallback(a,o,t)}throw new Ce(Oe.InvalidParams,`Resource ${a} not found`)}),this.setCompletionRequestHandler(),this._resourceHandlersInitialized=true);}setPromptRequestHandlers(){this._promptHandlersInitialized||(this.server.assertCanSetRequestHandler(Mt.shape.method.value),this.server.assertCanSetRequestHandler(zt.shape.method.value),this.server.registerCapabilities({prompts:{listChanged:true}}),this.server.setRequestHandler(Mt,()=>({prompts:Object.entries(this._registeredPrompts).filter(([,e])=>e.enabled).map(([e,t])=>({name:e,title:t.title,description:t.description,arguments:t.argsSchema?gc(t.argsSchema):void 0}))})),this.server.setRequestHandler(zt,async(e,t)=>{const a=this._registeredPrompts[e.params.name];if(!a)throw new Ce(Oe.InvalidParams,`Prompt ${e.params.name} not found`);if(!a.enabled)throw new Ce(Oe.InvalidParams,`Prompt ${e.params.name} disabled`);if(a.argsSchema){const r=await a.argsSchema.safeParseAsync(e.params.arguments);if(!r.success)throw new Ce(Oe.InvalidParams,`Invalid arguments for prompt ${e.params.name}: ${r.error.message}`);const n=r.data,o=a.callback;return await Promise.resolve(o(n,t))}else {const r=a.callback;return await Promise.resolve(r(t))}}),this.setCompletionRequestHandler(),this._promptHandlersInitialized=true);}resource(e,t,...a){let r;typeof a[0]=="object"&&(r=a.shift());const n=a[0];if(typeof t=="string"){if(this._registeredResources[t])throw new Error(`Resource ${t} is already registered`);const o=this._createRegisteredResource(e,void 0,t,r,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}else {if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const o=this._createRegisteredResourceTemplate(e,void 0,t,r,n);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),o}}registerResource(e,t,a,r){if(typeof t=="string"){if(this._registeredResources[t])throw new Error(`Resource ${t} is already registered`);const n=this._createRegisteredResource(e,a.title,t,a,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}else {if(this._registeredResourceTemplates[e])throw new Error(`Resource template ${e} is already registered`);const n=this._createRegisteredResourceTemplate(e,a.title,t,a,r);return this.setResourceRequestHandlers(),this.sendResourceListChanged(),n}}_createRegisteredResource(e,t,a,r,n){const o={name:e,title:t,metadata:r,readCallback:n,enabled:true,disable:()=>o.update({enabled:false}),enable:()=>o.update({enabled:true}),remove:()=>o.update({uri:null}),update:i=>{typeof i.uri<"u"&&i.uri!==a&&(delete this._registeredResources[a],i.uri&&(this._registeredResources[i.uri]=o)),typeof i.name<"u"&&(o.name=i.name),typeof i.title<"u"&&(o.title=i.title),typeof i.metadata<"u"&&(o.metadata=i.metadata),typeof i.callback<"u"&&(o.readCallback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendResourceListChanged();}};return this._registeredResources[a]=o,o}_createRegisteredResourceTemplate(e,t,a,r,n){const o={resourceTemplate:a,title:t,metadata:r,readCallback:n,enabled:true,disable:()=>o.update({enabled:false}),enable:()=>o.update({enabled:true}),remove:()=>o.update({name:null}),update:i=>{typeof i.name<"u"&&i.name!==e&&(delete this._registeredResourceTemplates[e],i.name&&(this._registeredResourceTemplates[i.name]=o)),typeof i.title<"u"&&(o.title=i.title),typeof i.template<"u"&&(o.resourceTemplate=i.template),typeof i.metadata<"u"&&(o.metadata=i.metadata),typeof i.callback<"u"&&(o.readCallback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendResourceListChanged();}};return this._registeredResourceTemplates[e]=o,o}_createRegisteredPrompt(e,t,a,r,n){const o={title:t,description:a,argsSchema:r===void 0?void 0:k(r),callback:n,enabled:true,disable:()=>o.update({enabled:false}),enable:()=>o.update({enabled:true}),remove:()=>o.update({name:null}),update:i=>{typeof i.name<"u"&&i.name!==e&&(delete this._registeredPrompts[e],i.name&&(this._registeredPrompts[i.name]=o)),typeof i.title<"u"&&(o.title=i.title),typeof i.description<"u"&&(o.description=i.description),typeof i.argsSchema<"u"&&(o.argsSchema=k(i.argsSchema)),typeof i.callback<"u"&&(o.callback=i.callback),typeof i.enabled<"u"&&(o.enabled=i.enabled),this.sendPromptListChanged();}};return this._registeredPrompts[e]=o,o}_createRegisteredTool(e,t,a,r,n,o,i){const l={title:t,description:a,inputSchema:r===void 0?void 0:k(r),outputSchema:n===void 0?void 0:k(n),annotations:o,callback:i,enabled:true,disable:()=>l.update({enabled:false}),enable:()=>l.update({enabled:true}),remove:()=>l.update({name:null}),update:d=>{typeof d.name<"u"&&d.name!==e&&(delete this._registeredTools[e],d.name&&(this._registeredTools[d.name]=l)),typeof d.title<"u"&&(l.title=d.title),typeof d.description<"u"&&(l.description=d.description),typeof d.paramsSchema<"u"&&(l.inputSchema=k(d.paramsSchema)),typeof d.callback<"u"&&(l.callback=d.callback),typeof d.annotations<"u"&&(l.annotations=d.annotations),typeof d.enabled<"u"&&(l.enabled=d.enabled),this.sendToolListChanged();}};return this._registeredTools[e]=l,this.setToolRequestHandlers(),this.sendToolListChanged(),l}tool(e,...t){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);let a,r,n,o;if(typeof t[0]=="string"&&(a=t.shift()),t.length>1){const l=t[0];Wn(l)?(r=t.shift(),t.length>1&&typeof t[0]=="object"&&t[0]!==null&&!Wn(t[0])&&(o=t.shift())):typeof l=="object"&&l!==null&&(o=t.shift());}const i=t[0];return this._createRegisteredTool(e,void 0,a,r,n,o,i)}registerTool(e,t,a){if(this._registeredTools[e])throw new Error(`Tool ${e} is already registered`);const{title:r,description:n,inputSchema:o,outputSchema:i,annotations:l}=t;return this._createRegisteredTool(e,r,n,o,i,l,a)}prompt(e,...t){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);let a;typeof t[0]=="string"&&(a=t.shift());let r;t.length>1&&(r=t.shift());const n=t[0],o=this._createRegisteredPrompt(e,void 0,a,r,n);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),o}registerPrompt(e,t,a){if(this._registeredPrompts[e])throw new Error(`Prompt ${e} is already registered`);const{title:r,description:n,argsSchema:o}=t,i=this._createRegisteredPrompt(e,r,n,o,a);return this.setPromptRequestHandlers(),this.sendPromptListChanged(),i}isConnected(){return this.server.transport!==void 0}sendResourceListChanged(){this.isConnected()&&this.server.sendResourceListChanged();}sendToolListChanged(){this.isConnected()&&this.server.sendToolListChanged();}sendPromptListChanged(){this.isConnected()&&this.server.sendPromptListChanged();}}const pc={type:"object",properties:{}};function Wn(s){return typeof s!="object"||s===null?false:Object.keys(s).length===0||Object.values(s).some(vc)}function vc(s){return s!==null&&typeof s=="object"&&"parse"in s&&typeof s.parse=="function"&&"safeParse"in s&&typeof s.safeParse=="function"}function gc(s){return Object.entries(s.shape).map(([e,t])=>({name:e,description:t.description,required:!t.isOptional()}))}function Yn(s){return {completion:{values:s.slice(0,100),total:s.length,hasMore:s.length>100}}}const ft={completion:{values:[],hasMore:false}};function yc(s){if(!s)try{const e=window.location.hostname||"localhost";window.mcp=new mc({name:e,version:"1.0.0"},{capabilities:{tools:{listChanged:!0}}}),window.mcp.registerTool("get_current_website_title",{description:"Get the title of the current website"},async()=>{try{return {content:[{type:"text",text:document.title||"Untitled"}]}}catch(a){return console.error("Error in get_current_website_title tool:",a),{content:[{type:"text",text:`Error getting website title ${a instanceof Error?a.message:String(a)}`}],isError:!0}}});const t=new Bo({allowedOrigins:["*"]});window.mcp.connect(t);}catch(e){const t=e instanceof Error?e.message:"Unknown error";throw new Error(`Failed to initialize MCP server: ${t}`)}}function _c(s){if(typeof window>"u"){console.warn("initializeGlobalMCP called in non-browser environment; skipping.");return}if(s&&window.mcp){console.warn("MCP server already initialized; skipping.");return}try{yc(s),s=!0;}catch(e){throw console.error("Failed to initialize global MCP:",e),e}}let Xn=false;if(typeof window<"u"&&typeof document<"u")try{_c(Xn),typeof window.mcp<"u"?(Xn=!0,console.log("window.mcp",window.mcp),console.log(" MCP Ready!")):console.error(" MCP Not Ready!");}catch(s){console.error("Auto-initialization of global MCP failed:",s);}})();

})();